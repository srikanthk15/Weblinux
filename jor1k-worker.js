var requirejs,require,define;!function(global){var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.22",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){var i;if(e)for(i=0;i<e.length&&(!e[i]||!t(e[i],i,e));i+=1);}function eachReverse(e,t){var i;if(e)for(i=e.length-1;i>-1&&(!e[i]||!t(e[i],i,e));i-=1);}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var i;for(i in e)if(hasProp(e,i)&&t(e[i],i))break}function mixin(e,t,i,s){return t&&eachProp(t,function(t,r){!i&&hasProp(e,r)||(!s||"object"!=typeof t||!t||isArray(t)||isFunction(t)||t instanceof RegExp?e[r]=t:(e[r]||(e[r]={}),mixin(e[r],t,i,s)))}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,i,s){var r=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return r.requireType=e,r.requireModules=s,i&&(r.originalError=i),r}if(void 0===define){if(void 0!==requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}void 0===require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,i,s){var r,a,n=defContextName;return isArray(e)||"string"==typeof e||(a=e,isArray(t)?(e=t,t=i,i=s):e=[]),a&&a.context&&(n=a.context),(r=getOwn(contexts,n))||(r=contexts[n]=req.s.newContext(n)),a&&r.configure(a),r.require(e,t,i)},req.config=function(e){return req(e)},req.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e,t,i){var s=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return s.type=e.scriptType||"text/javascript",s.charset="utf-8",s.async=!0,s},req.load=function(e,t,i){var s,r=e&&e.config||{};if(isBrowser)return s=req.createNode(r,t,i),r.onNodeCreated&&r.onNodeCreated(s,r,t,i),s.setAttribute("data-requirecontext",e.contextName),s.setAttribute("data-requiremodule",t),!s.attachEvent||s.attachEvent.toString&&s.attachEvent.toString().indexOf("[native code")<0||isOpera?(s.addEventListener("load",e.onScriptLoad,!1),s.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,s.attachEvent("onreadystatechange",e.onScriptLoad)),s.src=i,currentlyAddingScript=s,baseElement?head.insertBefore(s,baseElement):head.appendChild(s),currentlyAddingScript=null,s;if(isWebWorker)try{importScripts(i),e.completeLoad(t)}catch(s){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+i,s,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(e){if(head||(head=e.parentNode),dataMain=e.getAttribute("data-main"))return mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0}),define=function(e,t,i){var s,r;"string"!=typeof e&&(i=t,t=e,e=null),isArray(t)||(i=t,t=null),!t&&isFunction(i)&&(t=[],i.length&&(i.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,i){t.push(i)}),t=(1===i.length?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(s=currentlyAddingScript||getInteractiveScript())&&(e||(e=s.getAttribute("data-requiremodule")),r=contexts[s.getAttribute("data-requirecontext")]),r?(r.defQueue.push([e,t,i]),r.defQueueMap[e]=!0):globalDefQueue.push([e,t,i])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}function newContext(e){var t,i,s,r,a,n={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},o={},c={},h={},u=[],d={},f={},p={},l=1,b=1;function x(e,t,i){var s,r,a,o,c,h,u,d,f,p,l=t&&t.split("/"),b=n.map,x=b&&b["*"];if(e&&(h=(e=e.split("/")).length-1,n.nodeIdCompat&&jsSuffixRegExp.test(e[h])&&(e[h]=e[h].replace(jsSuffixRegExp,"")),"."===e[0].charAt(0)&&l&&(e=l.slice(0,l.length-1).concat(e)),function(e){var t,i;for(t=0;t<e.length;t++)if("."===(i=e[t]))e.splice(t,1),t-=1;else if(".."===i){if(0===t||1===t&&".."===e[2]||".."===e[t-1])continue;t>0&&(e.splice(t-1,2),t-=2)}}(e),e=e.join("/")),i&&b&&(l||x)){e:for(a=(r=e.split("/")).length;a>0;a-=1){if(c=r.slice(0,a).join("/"),l)for(o=l.length;o>0;o-=1)if((s=getOwn(b,l.slice(0,o).join("/")))&&(s=getOwn(s,c))){u=s,d=a;break e}!f&&x&&getOwn(x,c)&&(f=getOwn(x,c),p=a)}!u&&f&&(u=f,d=p),u&&(r.splice(0,d,u),e=r.join("/"))}return getOwn(n.pkgs,e)||e}function m(e){isBrowser&&each(scripts(),function(t){if(t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===s.contextName)return t.parentNode.removeChild(t),!0})}function v(e){var t=getOwn(n.paths,e);if(t&&isArray(t)&&t.length>1)return t.shift(),s.require.undef(e),s.makeRequire(null,{skipMap:!0})([e]),!0}function g(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function k(e,t,i,r){var a,n,o,c,h=null,u=t?t.name:null,f=e,p=!0,m="";return e||(p=!1,e="_@r"+(l+=1)),h=(c=g(e))[0],e=c[1],h&&(h=x(h,u,r),n=getOwn(d,h)),e&&(h?m=n&&n.normalize?n.normalize(e,function(e){return x(e,u,r)}):-1===e.indexOf("!")?x(e,u,r):e:(h=(c=g(m=x(e,u,r)))[0],m=c[1],i=!0,a=s.nameToUrl(m))),{prefix:h,name:m,parentMap:t,unnormalized:!!(o=!h||n||i?"":"_unnormalized"+(b+=1)),url:a,originalName:f,isDefine:p,id:(h?h+"!"+m:m)+o}}function R(e){var t=e.id,i=getOwn(o,t);return i||(i=o[t]=new s.Module(e)),i}function y(e,t,i){var s=e.id,r=getOwn(o,s);!hasProp(d,s)||r&&!r.defineEmitComplete?(r=R(e)).error&&"error"===t?i(r.error):r.on(t,i):"defined"===t&&i(d[s])}function F(e,t){var i=e.requireModules,s=!1;t?t(e):(each(i,function(t){var i=getOwn(o,t);i&&(i.error=e,i.events.error&&(s=!0,i.emit("error",e)))}),s||req.onError(e))}function C(){globalDefQueue.length&&(each(globalDefQueue,function(e){var t=e[0];"string"==typeof t&&(s.defQueueMap[t]=!0),u.push(e)}),globalDefQueue=[])}function S(e){delete o[e],delete c[e]}function w(){var e,i,r=1e3*n.waitSeconds,h=r&&s.startTime+r<(new Date).getTime(),u=[],f=[],p=!1,l=!0;if(!t){if(t=!0,eachProp(c,function(e){var t=e.map,s=t.id;if(e.enabled&&(t.isDefine||f.push(e),!e.error))if(!e.inited&&h)v(s)?(i=!0,p=!0):(u.push(s),m(s));else if(!e.inited&&e.fetched&&t.isDefine&&(p=!0,!t.prefix))return l=!1}),h&&u.length)return(e=makeError("timeout","Load timeout for modules: "+u,null,u)).contextName=s.contextName,F(e);l&&each(f,function(e){!function e(t,i,s){var r=t.map.id;t.error?t.emit("error",t.error):(i[r]=!0,each(t.depMaps,function(r,a){var n=r.id,c=getOwn(o,n);!c||t.depMatched[a]||s[n]||(getOwn(i,n)?(t.defineDep(a,d[n]),t.check()):e(c,i,s))}),s[r]=!0)}(e,{},{})}),h&&!i||!p||!isBrowser&&!isWebWorker||a||(a=setTimeout(function(){a=0,w()},50)),t=!1}}function D(e){hasProp(d,e[0])||R(k(e[0],null,!0)).init(e[1],e[2])}function T(e,t,i,s){e.detachEvent&&!isOpera?s&&e.detachEvent(s,t):e.removeEventListener(i,t,!1)}function E(e){var t=e.currentTarget||e.srcElement;return T(t,s.onScriptLoad,"load","onreadystatechange"),T(t,s.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function I(){var e;for(C();u.length;){if(null===(e=u.shift())[0])return F(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));D(e)}s.defQueueMap={}}return r={require:function(e){return e.require?e.require:e.require=s.makeRequire(e.map)},exports:function(e){if(e.usingExports=!0,e.map.isDefine)return e.exports?d[e.map.id]=e.exports:e.exports=d[e.map.id]={}},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return getOwn(n.config,e.map.id)||{}},exports:e.exports||(e.exports={})}}},(i=function(e){this.events=getOwn(h,e.id)||{},this.map=e,this.shim=getOwn(n.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0}).prototype={init:function(e,t,i,s){s=s||{},this.inited||(this.factory=t,i?this.on("error",i):this.events.error&&(i=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=i,this.inited=!0,this.ignore=s.ignore,s.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,s.startTime=(new Date).getTime();var e=this.map;if(!this.shim)return e.prefix?this.callPlugin():this.load();s.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()}))}},load:function(){var e=this.map.url;f[e]||(f[e]=!0,s.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,i=this.map.id,r=this.depExports,a=this.exports,n=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(n)){try{a=s.execCb(i,n,r,a)}catch(t){e=t}if(this.map.isDefine&&void 0===a&&((t=this.module)?a=t.exports:this.usingExports&&(a=this.exports)),e){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",F(this.error=e);"undefined"!=typeof console&&console.error?console.error(e):req.onError(e)}}else a=n;if(this.exports=a,this.map.isDefine&&!this.ignore&&(d[i]=a,req.onResourceLoad)){var o=[];each(this.depMaps,function(e){o.push(e.normalizedMap||e)}),req.onResourceLoad(s,this.map,o)}S(i),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else hasProp(s.defQueueMap,i)||this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,i=k(e.prefix);this.depMaps.push(i),y(i,"defined",bind(this,function(i){var r,a,c,h=getOwn(p,this.map.id),u=this.map.name,d=this.map.parentMap?this.map.parentMap.name:null,f=s.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(i.normalize&&(u=i.normalize(u,function(e){return x(e,d,!0)})||""),y(a=k(e.prefix+"!"+u,this.map.parentMap),"defined",bind(this,function(e){this.map.normalizedMap=a,this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),void((c=getOwn(o,a.id))&&(this.depMaps.push(a),this.events.error&&c.on("error",bind(this,function(e){this.emit("error",e)})),c.enable()))):h?(this.map.url=s.nameToUrl(h),void this.load()):((r=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})})).error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(o,function(e){0===e.map.id.indexOf(t+"_unnormalized")&&S(e.map.id)}),F(e)}),r.fromText=bind(this,function(i,a){var o=e.name,c=k(o),h=useInteractive;a&&(i=a),h&&(useInteractive=!1),R(c),hasProp(n.config,t)&&(n.config[o]=n.config[t]);try{req.exec(i)}catch(e){return F(makeError("fromtexteval","fromText eval for "+t+" failed: "+e,e,[t]))}h&&(useInteractive=!0),this.depMaps.push(c),s.completeLoad(o),f([o],r)}),void i.load(e.name,f,r,n))})),s.enable(i,this),this.pluginMaps[i.id]=i},enable:function(){c[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var i,a,n;if("string"==typeof e){if(e=k(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,n=getOwn(r,e.id))return void(this.depExports[t]=n(this));this.depCount+=1,y(e,"defined",bind(this,function(e){this.undefed||(this.defineDep(t,e),this.check())})),this.errback?y(e,"error",bind(this,this.errback)):this.events.error&&y(e,"error",bind(this,function(e){this.emit("error",e)}))}i=e.id,a=o[i],hasProp(r,i)||!a||a.enabled||s.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(o,e.id);t&&!t.enabled&&s.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var i=this.events[e];i||(i=this.events[e]=[]),i.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},(s={config:n,contextName:e,registry:o,defined:d,urlFetched:f,defQueue:u,defQueueMap:{},Module:i,makeModuleMap:k,nextTick:req.nextTick,onError:F,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=n.shim,i={paths:!0,bundles:!0,config:!0,map:!0};eachProp(e,function(e,t){i[t]?(n[t]||(n[t]={}),mixin(n[t],e,!0,!0)):n[t]=e}),e.bundles&&eachProp(e.bundles,function(e,t){each(e,function(e){e!==t&&(p[e]=t)})}),e.shim&&(eachProp(e.shim,function(e,i){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=s.makeShimExports(e)),t[i]=e}),n.shim=t),e.packages&&each(e.packages,function(e){var t;t=(e="string"==typeof e?{name:e}:e).name,e.location&&(n.paths[t]=e.location),n.pkgs[t]=e.name+"/"+(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(o,function(e,t){e.inited||e.map.unnormalized||(e.map=k(t,null,!0))}),(e.deps||e.callback)&&s.require(e.deps||[],e.callback)},makeShimExports:function(e){return function(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}},makeRequire:function(t,i){function a(n,c,h){var u,f;return i.enableBuildCallback&&c&&isFunction(c)&&(c.__requireJsBuild=!0),"string"==typeof n?isFunction(c)?F(makeError("requireargs","Invalid require call"),h):t&&hasProp(r,n)?r[n](o[t.id]):req.get?req.get(s,n,t,a):(u=k(n,t,!1,!0).id,hasProp(d,u)?d[u]:F(makeError("notloaded",'Module name "'+u+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(I(),s.nextTick(function(){I(),(f=R(k(null,t))).skipMap=i.skipMap,f.init(n,c,h,{enabled:!0}),w()}),a)}return i=i||{},mixin(a,{isBrowser:isBrowser,toUrl:function(e){var i,r=e.lastIndexOf("."),a=e.split("/")[0];return-1!==r&&(!("."===a||".."===a)||r>1)&&(i=e.substring(r,e.length),e=e.substring(0,r)),s.nameToUrl(x(e,t&&t.id,!0),i,!0)},defined:function(e){return hasProp(d,k(e,t,!1,!0).id)},specified:function(e){return e=k(e,t,!1,!0).id,hasProp(d,e)||hasProp(o,e)}}),t||(a.undef=function(e){C();var i=k(e,t,!0),r=getOwn(o,e);r.undefed=!0,m(e),delete d[e],delete f[i.url],delete h[e],eachReverse(u,function(t,i){t[0]===e&&u.splice(i,1)}),delete s.defQueueMap[e],r&&(r.events.defined&&(h[e]=r.events),S(e))}),a},enable:function(e){getOwn(o,e.id)&&R(e).enable()},completeLoad:function(e){var t,i,r,a=getOwn(n.shim,e)||{},c=a.exports;for(C();u.length;){if(null===(i=u.shift())[0]){if(i[0]=e,t)break;t=!0}else i[0]===e&&(t=!0);D(i)}if(s.defQueueMap={},r=getOwn(o,e),!t&&!hasProp(d,e)&&r&&!r.inited){if(!(!n.enforceDefine||c&&getGlobal(c)))return v(e)?void 0:F(makeError("nodefine","No define call for "+e,null,[e]));D([e,a.deps||[],a.exportsFn])}w()},nameToUrl:function(e,t,i){var r,a,o,c,h,u,d=getOwn(n.pkgs,e);if(d&&(e=d),u=getOwn(p,e))return s.nameToUrl(u,t,i);if(req.jsExtRegExp.test(e))c=e+(t||"");else{for(r=n.paths,o=(a=e.split("/")).length;o>0;o-=1)if(h=getOwn(r,a.slice(0,o).join("/"))){isArray(h)&&(h=h[0]),a.splice(0,o,h);break}c=a.join("/"),c=("/"===(c+=t||(/^data\:|\?/.test(c)||i?"":".js")).charAt(0)||c.match(/^[\w\+\.\-]+:/)?"":n.baseUrl)+c}return n.urlArgs?c+(-1===c.indexOf("?")?"?":"&")+n.urlArgs:c},load:function(e,t){req.load(s,e,t)},execCb:function(e,t,i,s){return t.apply(s,i)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=E(e);s.completeLoad(t.id)}},onScriptError:function(e){var t=E(e);if(!v(t.id)){var i=[];return eachProp(o,function(e,s){0!==s.indexOf("_@r")&&each(e.depMaps,function(e){return e.id===t.id&&i.push(s),!0})}),F(makeError("scripterror",'Script error for "'+t.id+(i.length?'", needed by: '+i.join(", "):'"'),e,[t.id]))}}}).require=s.makeRequire(),s}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){if("interactive"===e.readyState)return interactiveScript=e}),interactiveScript)}}(this),define("requireLib",function(){}),define("amd-loader",[],function(){var e=function(t,i,s,r){return 3==arguments.length?(r=s,s=void 0):2==arguments.length&&(r=i,i=s=void 0),{buildCache:{},load:function(a,n,o,c){var h=n.toUrl(a);if(c.precompiled instanceof Array){for(var u=0;u<c.precompiled.length;u++)if(h.substr(0,c.precompiled[u].length)==c.precompiled[u])return require([h+"."+t+".js"],o,o.error)}else if(!0===c.precompiled)return require([h+"."+t+".js"],o,o.error);if(i&&"/"!=a.substr(0,1)&&!a.match(/:\/\//)){var d=!1;if(s)for(u=0;u<s.length;u++)a.substr(a.length-s[u].length-1)=="."+s[u]&&(d=!0);d||(h+="."+i)}var f=this;e.fetch(h,function(e){r(a,e,n,function(e){"string"==typeof e?(c.isBuild&&(f.buildCache[a]=e),o.fromText(e)):o(e)},o.error,c)},o.error)},write:function(e,t,i){var s=this.buildCache[t];s&&i.asModule(e+"!"+t,s)},writeFile:function(e,i,s,r){r.asModule(e+"!"+i,s.toUrl(i+"."+t+".js"),this.buildCache[i])}}};if("undefined"!=typeof window){var t=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"];e.fetch=function(e,i,s){var r=function(e){var i,s=!0,r=/^(\w+:)?\/\/([^\/]+)/.exec(e);if("undefined"!=typeof window&&r&&(s=r[2]===window.location.host,r[1]&&(s&=r[1]===window.location.protocol)),"undefined"!=typeof XMLHttpRequest)i=new XMLHttpRequest;else for(var a,n=0;n<3;n+=1){a=t[n];try{i=new ActiveXObject(a)}catch(e){}if(i){t=[a];break}}if(!s)if("undefined"!=typeof XDomainRequest)i=new XDomainRequest;else if(!("withCredentials"in i))throw new Error("getXhr(): Cross Origin XHR not supported.");if(!i)throw new Error("getXhr(): XMLHttpRequest not available");return i}(e);r.open("GET",e,!requirejs.inlineRequire),r.onreadystatechange=function(t){var a,n;if(4===r.readyState)if((a=r.status)>399&&a<600)(n=new Error(e+" HTTP status: "+a)).xhr=r,s&&s(n);else{if(""==r.responseText)return s(new Error(e+" empty response"));i(r.responseText)}},r.send(null)}}else if("undefined"!=typeof process&&process.versions&&process.versions.node){var i=requirejs.nodeRequire("fs");e.fetch=function(e,t){t(i.readFileSync(e,"utf8"))}}else"undefined"!=typeof Packages?e.fetch=function(e,t,i){var s,r,a=new java.io.File(e),n=java.lang.System.getProperty("line.separator"),o=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(a),"utf-8")),c="";try{for(s=new java.lang.StringBuffer,(r=o.readLine())&&r.length()&&65279===r.charAt(0)&&(r=r.substring(1)),s.append(r);null!==(r=o.readLine());)s.append(n),s.append(r);c=String(s.toString())}catch(e){i&&i(e)}finally{o.close()}t(c)}:e.fetch=function(){throw new Error("Environment unsupported.")};return e}),define("cjs",["amd-loader"],function(e){var t=/\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g;return e("cjs","js",function(e,i,s,r,a,n){r("define(function(require, exports, module) { (function(){var define=undefined;"+(i=i.replace(t,function(e,t){return"."==t.substr(0,1)?" require('cjs!"+t+"')":" require('"+t+"')"}))+" \n//# sourceURL="+s.toUrl(e)+"\n})() });")})}),define("cjs!jor1k/worker/messagehandler",["require","exports","module"],function(e,t,i){!function(){var e=!0,t="";function s(e,t){postMessage({command:e,data:t})}function r(e){s("Debug",e)}function a(){throw r("Worker: Abort execution."),"function"==typeof n.PrintOnAbort&&n.PrintOnAbort(),s("Abort",{}),e=!1,new Error("Kill worker")}var n=new Object;function o(e,t){n[e]=t}onmessage=function(t){if(e){var i=t.data.command;if("function"!=typeof n[i]);else try{n[i](t.data.data)}catch(t){r('Worker: Unhandled exception in command "'+i+'": '+t.message),e=!1}}},o("Abort",function(){e=!1}),o("WorkingPath",function(e){t=e}),i.exports.Register=o,i.exports.Debug=r,i.exports.Error=function(e){s("Debug","Error: "+e),a()},i.exports.Warning=function(e){s("Debug","Warning: "+e)},i.exports.Abort=a,i.exports.Send=s,i.exports.GetWorkingPath=function(){return t}}()}),define("cjs!jor1k/worker/utils",["require","exports","module"],function(e,t,i){!function(){function e(e){return e>>>0}function t(e,t,i){var s=new XMLHttpRequest;try{s.open("GET",e,!0)}catch(e){return void i(e)}s.responseType="arraybuffer",s.onreadystatechange=function(){if(4==s.readyState)if(200==s.status||0==s.status){var r=s.response;r?t(r):i("Error: No data received from: "+e)}else i("Error: Could not load file "+e)},s.send(null)}i.exports.GetMilliseconds=function(){return(new Date).getTime()},i.exports.Swap32=function(e){return(255&e)<<24|(65280&e)<<8|e>>>8&65280|e>>>24&255},i.exports.Swap16=function(e){return(255&e)<<8|e>>8&255},i.exports.int32=function(e){return e>>0},i.exports.uint32=e,i.exports.ToHex=function(t){return"0x"+("00000000"+e(t).toString(16)).substr(-8).toUpperCase()},i.exports.ToBin=function(t){return(("00000000000000000000000000000000"+e(t).toString(2)).substr(-32)+"b").replace(/./g,function(e,t){return 3==(3&t)?e+" ":e})},i.exports.LoadBinaryResource=t,i.exports.LoadBinaryResourceII=function(e,t,i,s){var r=new XMLHttpRequest;try{r.open("GET",e,i)}catch(e){return void s(e)}r.responseType="arraybuffer",r.onreadystatechange=function(){if(4==r.readyState)if(200==r.status||0==r.status){var i=r.response;i?t(i):s("Error: No data received from: "+e)}else s("Error: Could not load file "+e)},r.send(null)},i.exports.LoadTextResource=function(e,t,i){var s=new XMLHttpRequest;console.log("url "+e),s.open("GET",e,!0),s.onreadystatechange=function(){4==s.readyState&&(200==s.status||0==s.status?t(s.responseText):i("Error: Could not load text file "+e))},s.send(null)}}()}),define("cjs!jor1k/worker/ram",["require","exports","module","cjs!./messagehandler","cjs!./utils"],function(e,t,i){!function(){var t=e("cjs!./messagehandler"),s=e("cjs!./utils");function r(e,t){this.heap=e,this.int32mem=new Int32Array(this.heap,t),this.uint8mem=new Uint8Array(this.heap,t),this.sint8mem=new Int8Array(this.heap,t),this.devices=new Array(256),this.nativeendian="little",this.Read32Little=this.Read32LittleTemplate,this.Write32Little=this.Write32LittleTemplate,this.Read16Little=this.Read16LittleTemplate,this.Write16Little=this.Write16LittleTemplate,this.Read8Little=this.Read8LittleTemplate,this.Write8Little=this.Write8LittleTemplate,this.Read32=this.Read32LittleTemplate,this.Write32=this.Write32LittleTemplate,this.Read16=this.Read16LittleTemplate,this.Write16=this.Write16LittleTemplate,this.Read8=this.Read8LittleTemplate,this.Write8=this.Write8LittleTemplate,this.Read32Big=this.Read32BigTemplate,this.Write32Big=this.Write32BigTemplate,this.Read16Big=this.Read16BigTemplate,this.Write16Big=this.Write16BigTemplate,this.Read8Big=this.Read8BigTemplate,this.Write8Big=this.Write8BigTemplate}r.prototype.AddDevice=function(e,i,s){16777215&i&&(t.Debug("Error: The device address not in the allowed memory region"),t.Abort()),this.devices[i>>24&255]=e},r.prototype.Little2Big=function(e){for(var t=0;t<e>>2;t++)this.int32mem[t]=s.Swap32(this.int32mem[t]);this.Read32=this.Read32BigTemplate,this.Write32=this.Write32BigTemplate,this.Read16=this.Read16BigTemplate,this.Write16=this.Write16BigTemplate,this.Read8=this.Read8BigTemplate,this.Write8=this.Write8BigTemplate,this.Read32Little=function(e){return s.Swap32(this.Read32BigTemplate(e))}.bind(this),this.Write32Little=function(e,t){this.Write32BigTemplate(e,s.Swap32(t))}.bind(this),this.Read16Little=function(e){return s.Swap16(this.Read16BigTemplate(e))}.bind(this),this.Write16Little=function(e,t){this.Write16BigTemplate(e,s.Swap16(t))}.bind(this),this.Read8Little=this.Read8BigTemplate.bind(this),this.Write8Little=this.Write8BigTemplate.bind(this),this.nativeendian="big"},r.prototype.Read32BigTemplate=function(e){return(e|=0)>=0?(this.int32mem.byteLength<=e&&(t.Debug("Error in Read32Big: read above upper boundary"),t.Abort()),this.int32mem[e>>2]):this.devices[e>>24&255].ReadReg32(16777215&e)},r.prototype.Read32LittleTemplate=function(e){return(e|=0)<0?(e^=2147483648,this.int32mem.byteLength<=e&&(t.Debug("Error in Read32Little: read above upper boundary"),t.Abort()),this.int32mem[e>>2]):this.devices[e>>24&255].ReadReg32(16777215&e)},r.prototype.Write32BigTemplate=function(e,i){if((e|=0)>=0)return this.int32mem.byteLength<=e&&(t.Debug("Error in Write32Big: write above upper boundary"),t.Abort()),void(this.int32mem[e>>2]=0|i);this.devices[e>>24&255].WriteReg32(16777215&e,0|i)},r.prototype.Write32LittleTemplate=function(e,i){if((e|=0)<0)return e^=2147483648,this.int32mem.byteLength<=e&&(t.Debug("Error in Write32Little: write above upper boundary"),t.Abort()),void(this.int32mem[e>>2]=0|i);this.devices[e>>24&255].WriteReg32(16777215&e,0|i)},r.prototype.Read8BigTemplate=function(e){return(e|=0)>=0?(this.uint8mem.byteLength<=e&&(t.Debug("Error in Read8Big: read above upper boundary"),t.Abort()),this.uint8mem[3^e]):this.devices[e>>24&255].ReadReg8(16777215&e)},r.prototype.Read8LittleTemplate=function(e){return(e|=0)<0?(e^=2147483648,this.uint8mem.byteLength<=e&&(t.Debug("Error in Read8Little: read above upper boundary"),t.Abort()),this.uint8mem[e]):this.devices[e>>24&255].ReadReg8(16777215&e)},r.prototype.Write8BigTemplate=function(e,i){if((e|=0)>=0)return this.uint8mem.byteLength<=e&&(t.Debug("Error in Write8Big: write above upper boundary"),t.Abort()),void(this.uint8mem[3^e]=0|i);this.devices[e>>24&255].WriteReg8(16777215&e,0|i)},r.prototype.Write8LittleTemplate=function(e,i){if((e|=0)<0)return e^=2147483648,this.uint8mem.byteLength<=e&&(t.Debug("Error in Write8Little: write above upper boundary"),t.Abort()),void(this.uint8mem[e]=0|i);this.devices[e>>24&255].WriteReg8(16777215&e,0|i)},r.prototype.Read16BigTemplate=function(e){return(e|=0)>=0?(this.uint8mem.byteLength<=e&&(t.Debug("Error in Read16Big: read above upper boundary"),t.Abort()),this.uint8mem[1+(2^e)]<<8|this.uint8mem[2^e]):this.devices[e>>24&255].ReadReg16(16777215&e)},r.prototype.Read16LittleTemplate=function(e){return(e|=0)<0?(e^=2147483648,this.uint8mem.byteLength<=e&&(t.Debug("Error in Read16Little: read above upper boundary"),t.Abort()),this.uint8mem[e+1]<<8|this.uint8mem[e]):this.devices[e>>24&255].ReadReg16(16777215&e)},r.prototype.Write16BigTemplate=function(e,i){if((e|=0)>=0)return this.uint8mem.byteLength<=e&&(t.Debug("Error in Write16Big: write above upper boundary"),t.Abort()),this.uint8mem[1+(2^e)]=i>>8&255,void(this.uint8mem[2^e]=255&i);this.devices[e>>24&255].WriteReg16(16777215&e,0|i)},r.prototype.Write16LittleTemplate=function(e,i){if((e|=0)<0)return e^=2147483648,this.uint8mem.byteLength<=e&&(t.Debug("Error in Write16Little: write above upper boundary"),t.Abort()),this.uint8mem[e+1]=i>>8&255,void(this.uint8mem[e]=255&i);this.devices[e>>24&255].WriteReg16(16777215&e,0|i)},i.exports=r}()}),define("cjs!jor1k/worker/bzip2",["require","exports","module","cjs!./messagehandler"],function(e,t,i){var s,r;s=e("cjs!./messagehandler"),r={crcTable:[0,79764919,159529838,222504665,319059676,398814059,445009330,507990021,638119352,583659535,797628118,726387553,890018660,835552979,1015980042,944750013,1276238704,1221641927,1167319070,1095957929,1595256236,1540665371,1452775106,1381403509,1780037320,1859660671,1671105958,1733955601,2031960084,2111593891,1889500026,1952343757,2552477408,2632100695,2443283854,2506133561,2334638140,2414271883,2191915858,2254759653,3190512472,3135915759,3081330742,3009969537,2905550212,2850959411,2762807018,2691435357,3560074640,3505614887,3719321342,3648080713,3342211916,3287746299,3467911202,3396681109,4063920168,4143685023,4223187782,4286162673,3779000052,3858754371,3904687514,3967668269,881225847,809987520,1023691545,969234094,662832811,591600412,771767749,717299826,311336399,374308984,453813921,533576470,25881363,88864420,134795389,214552010,2023205639,2086057648,1897238633,1976864222,1804852699,1867694188,1645340341,1724971778,1587496639,1516133128,1461550545,1406951526,1302016099,1230646740,1142491917,1087903418,2896545431,2825181984,2770861561,2716262478,3215044683,3143675388,3055782693,3001194130,2326604591,2389456536,2200899649,2280525302,2578013683,2640855108,2418763421,2498394922,3769900519,3832873040,3912640137,3992402750,4088425275,4151408268,4197601365,4277358050,3334271071,3263032808,3476998961,3422541446,3585640067,3514407732,3694837229,3640369242,1762451694,1842216281,1619975040,1682949687,2047383090,2127137669,1938468188,2001449195,1325665622,1271206113,1183200824,1111960463,1543535498,1489069629,1434599652,1363369299,622672798,568075817,748617968,677256519,907627842,853037301,1067152940,995781531,51762726,131386257,177728840,240578815,269590778,349224269,429104020,491947555,4046411278,4126034873,4172115296,4234965207,3794477266,3874110821,3953728444,4016571915,3609705398,3555108353,3735388376,3664026991,3290680682,3236090077,3449943556,3378572211,3174993278,3120533705,3032266256,2961025959,2923101090,2868635157,2813903052,2742672763,2604032198,2683796849,2461293480,2524268063,2284983834,2364738477,2175806836,2238787779,1569362073,1498123566,1409854455,1355396672,1317987909,1246755826,1192025387,1137557660,2072149281,2135122070,1912620623,1992383480,1753615357,1816598090,1627664531,1707420964,295390185,358241886,404320391,483945776,43990325,106832002,186451547,266083308,932423249,861060070,1041341759,986742920,613929101,542559546,756411363,701822548,3316196985,3244833742,3425377559,3370778784,3601682597,3530312978,3744426955,3689838204,3819031489,3881883254,3928223919,4007849240,4037393693,4100235434,4180117107,4259748804,2310601993,2373574846,2151335527,2231098320,2596047829,2659030626,2470359227,2550115596,2947551409,2876312838,2788305887,2733848168,3165939309,3094707162,3040238851,2985771188],array:function(e){var t=0,i=0,s=[0,1,3,7,15,31,63,127,255];return function(r){for(var a=0;r>0;){var n=8-t;r>=n?(a<<=n,a|=s[n]&e[i++],t=0,r-=n):(a<<=r,a|=(e[i]&s[r]<<8-r-t)>>8-r-t,t+=r,r=0)}return a}},IsBZIP2:function(e){return 66==e[0]&&90==e[1]&&104==e[2]},simple:function(e,t){var i=r.array(e),s=!1,a=1e5*r.header(i),n=new Int32Array(a);this.byteCount=new Int32Array(256),this.symToByte=new Uint8Array(256),this.mtfSymbol=new Int32Array(256),this.selectors=new Uint8Array(32768);do{s=r.decompress(i,t,n,a)}while(!s)},header:function(e){4348520!=e(24)&&s.Error("No magic number found");var t=e(8)-48;return(t<1||t>9)&&s.Error("Not a BZIP archive"),t},decompress:function(e,t,i,r){for(var a=-1,n="",o=0;o<6;o++)n+=e(8).toString(16);if("177245385090"==n)return!0;"314159265359"!=n&&s.Error("eek not valid bzip data");var c=0|e(32);e(1)&&s.Error("unsupported obsolete version");var h=e(24);h>r&&s.Error("Initial position larger than buffer size");var u=e(16),d=0;for(o=0;o<16;o++)if(u&1<<15-o){var f=e(16);for(b=0;b<16;b++)f&1<<15-b&&(this.symToByte[d++]=16*o+b)}var p=e(3);(p<2||p>6)&&s.Error("another error");var l=e(15);0==l&&s.Error("meh");for(o=0;o<p;o++)this.mtfSymbol[o]=o;for(o=0;o<l;o++){for(var b=0;e(1);b++)b>=p&&s.Error("whoops another error");var x=this.mtfSymbol[b];for(f=b-1;f>=0;f--)this.mtfSymbol[f+1]=this.mtfSymbol[f];this.mtfSymbol[0]=x,this.selectors[o]=x}var m,v,g,k,R=d+2,y=[],F=new Uint8Array(258),C=new Uint8Array(21);for(b=0;b<p;b++){u=e(5);for(o=0;o<R;o++){for(;(u<1||u>20)&&s.Error("I gave up a while ago on writing error messages"),e(1);)e(1)?u--:u++;F[o]=u}var S,w;S=w=F[0];for(o=1;o<R;o++)F[o]>w?w=F[o]:F[o]<S&&(S=F[o]);(m=y[b]={}).permute=new Int32Array(258),m.limit=new Int32Array(21),m.base=new Int32Array(21),m.minLen=S,m.maxLen=w;var D=m.base.subarray(1),T=m.limit.subarray(1),E=0;for(o=S;o<=w;o++)for(u=0;u<R;u++)F[u]==o&&(m.permute[E++]=u);for(o=S;o<=w;o++)C[o]=T[o]=0;for(o=0;o<R;o++)C[F[o]]++;for(E=u=0,o=S;o<w;o++)E+=C[o],T[o]=E-1,E<<=1,D[o+1]=E-(u+=C[o]);T[w]=E+C[w]-1,D[S]=0}for(o=0;o<256;o++)this.mtfSymbol[o]=o,this.byteCount[o]=0;for(v=g=R=k=0;;){for(R--||(R=49,k>=l&&s.Error("meow i'm a kitty, that's an error"),D=(m=y[this.selectors[k++]]).base.subarray(1),T=m.limit.subarray(1)),b=e(o=m.minLen);o>m.maxLen&&s.Error("rawr i'm a dinosaur"),!(b<=T[o]);)o++,b=b<<1|e(1);((b-=D[o])<0||b>=258)&&s.Error("moo i'm a cow");var I=m.permute[b];if(0!=I&&1!=I){if(v)for(v=0,g+u>=r&&s.Error("Boom."),x=this.symToByte[this.mtfSymbol[0]],this.byteCount[x]+=u;u--;)i[g++]=x;if(I>d)break;g>=r&&s.Error("I can't think of anything. Error"),o=I-1,x=this.mtfSymbol[o];for(f=o-1;f>=0;f--)this.mtfSymbol[f+1]=this.mtfSymbol[f];this.mtfSymbol[0]=x,x=this.symToByte[x],this.byteCount[x]++,i[g++]=x}else v||(v=1,u=0),u+=0==I?v:2*v,v<<=1}(h<0||h>=g)&&s.Error("I'm a monkey and I'm throwing something at someone, namely you");for(b=0,o=0;o<256;o++)f=b+this.byteCount[o],this.byteCount[o]=b,b=f;for(o=0;o<g;o++)x=255&i[o],i[this.byteCount[x]]|=o<<8,this.byteCount[x]++;var A,j,_,M=0,L=0,q=0;for(g&&(L=255&(M=i[h]),M>>=8,q=-1),g=g;g;){for(g--,j=L,L=255&(M=i[M]),M>>=8,3==q++?(A=L,_=j,L=-1):(A=1,_=L);A--;)a=4294967295&(a<<8^this.crcTable[255&(a>>24^_)]),t(_);L!=j&&(q=0)}return(0|(a=(-1^a)>>>0))!=(0|c)&&s.Error("Error in bzip2: crc32 do not match"),!1}},i.exports=r}),define("cjs!jor1k/lib/utf8",["require","exports","module"],function(e,t,i){!function(){i.exports.UTF8StreamToUnicode=function(){this.stream=new Uint8Array(5),this.ofs=0,this.Put=function(e){switch(this.stream[this.ofs]=e,this.ofs++,this.ofs){case 1:if(this.stream[0]<128)return this.ofs=0,this.stream[0];break;case 2:if(192==(224&this.stream[0])&&128==(192&this.stream[1]))return this.ofs=0,(31&this.stream[0])<<6|(63&this.stream[1])<<0;break;case 3:if(224==(240&this.stream[0])&&128==(192&this.stream[1])&&128==(192&this.stream[2]))return this.ofs=0,(15&this.stream[0])<<12|(63&this.stream[1])<<6|(63&this.stream[2])<<0;break;case 4:return 240==(248&this.stream[0])&&128==(192&this.stream[1])&&128==(192&this.stream[2])&&128==(192&this.stream[3])?(this.ofs=0,(7&this.stream[0])<<18|(63&this.stream[1])<<12|(63&this.stream[2])<<6|(63&this.stream[3])<<0):(this.ofs=0,-1);default:return this.ofs=0,-1}return-1}},i.exports.UTF8Length=function(e){for(var t=0,i=0;i<e.length;i++){var s=e.charCodeAt(i);s<128?t+=1:s<=2047?t+=2:s<=65535?t+=3:s<=1114111&&(t+=4)}return t},i.exports.UnicodeToUTF8Stream=function(e){return(e|=0)<128?[e]:e<=2047?[e>>6|192,63&e|128]:e<=65535?[e>>12|224,e>>6&63|128,63&e|128]:e<=1114111?[e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128]:[]}}()}),define("cjs!jor1k/worker/dev/virtio/marshall",["require","exports","module","cjs!../../../lib/utf8","cjs!../../messagehandler"],function(e,t,i){!function(){var t=e("cjs!../../../lib/utf8"),s=e("cjs!../../messagehandler");i.exports.Marshall=function e(i,r,a,n){for(var o,c=0,h=0;h<i.length;h++)switch(o=r[h],i[h]){case"w":a[n++]=255&o,a[n++]=o>>8&255,a[n++]=o>>16&255,a[n++]=o>>24&255,c+=4;break;case"d":a[n++]=255&o,a[n++]=o>>8&255,a[n++]=o>>16&255,a[n++]=o>>24&255,a[n++]=0,a[n++]=0,a[n++]=0,a[n++]=0,c+=8;break;case"h":a[n++]=255&o,a[n++]=o>>8,c+=2;break;case"b":a[n++]=o,c+=1;break;case"s":var u=n,d=0;for(var f in a[n++]=0,a[n++]=0,c+=2,o)t.UnicodeToUTF8Stream(o.charCodeAt(f)).forEach(function(e){a[n++]=e,c+=1,d++});a[u+0]=255&d,a[u+1]=d>>8&255;break;case"Q":e(["b","w","d"],[o.type,o.version,o.path],a,n),n+=13,c+=13;break;default:s.Debug("Marshall: Unknown type="+type[h])}return c},i.exports.Unmarshall=function(e,i,r){for(var a=[],n=0;n<e.length;n++)switch(e[n]){case"w":var o=i[r++];o+=i[r++]<<8,o+=i[r++]<<16,o+=i[r++]<<24>>>0,a.push(o);break;case"d":o=i[r++],o+=i[r++]<<8,o+=i[r++]<<16,o+=i[r++]<<24>>>0,r+=4,a.push(o);break;case"h":o=i[r++],a.push(o+(i[r++]<<8));break;case"b":a.push(i[r++]);break;case"s":var c=i[r++];c+=i[r++]<<8;for(var h="",u=new t.UTF8StreamToUnicode,d=0;d<c;d++){var f=u.Put(i[r++]);-1!=f&&(h+=String.fromCharCode(f))}a.push(h);break;default:s.Debug("Error in Unmarshall: Unknown type="+e[n])}return a},i.exports.Unmarshall2=function(e,i){for(var r=[],a=0;a<e.length;a++)switch(e[a]){case"w":var n=i();n+=i()<<8,n+=i()<<16,n+=i()<<24>>>0,r.push(n);break;case"d":n=i(),n+=i()<<8,n+=i()<<16,n+=i()<<24>>>0,i(),i(),i(),i(),r.push(n);break;case"h":n=i(),r.push(n+(i()<<8));break;case"b":r.push(i());break;case"s":var o=i();o+=i()<<8;for(var c="",h=new t.UTF8StreamToUnicode,u=0;u<o;u++){var d=h.Put(i());-1!=d&&(c+=String.fromCharCode(d))}r.push(c);break;default:s.Debug("Error in Unmarshall2: Unknown type="+e[a])}return r}}()}),define("cjs!jor1k/worker/elf",["require","exports","module","cjs!./messagehandler","cjs!./utils","cjs!./dev/virtio/marshall"],function(e,t,i){var s,r,a;s=e("cjs!./messagehandler"),e("cjs!./utils"),r=e("cjs!./dev/virtio/marshall"),a={IsELF:function(e){return 127==e[0]&&69==e[1]&&76==e[2]&&70==e[3]},Extract:function(e,t){var i=0,a=[];1!=(a=r.Unmarshall(["w","b","b","b","b"],e,i))[1]&&(s.Debug("Error reading elf binary: 64-Bit not supported"),s.Abort()),i=16;(a=r.Unmarshall(["h","h","w","w","w","w"],e,i))[3];var n=a[4],o=a[5];i=40;(a=r.Unmarshall(["h","h","h"],e,i))[0];var c=a[1],h=a[2];i=46;for(var u=(a=r.Unmarshall(["h","h","h"],e,i))[0],d=a[1],f=(a[2],[]),p=0;p<h;p++){i=n+p*c,a=r.Unmarshall(["w","w","w","w","w","w","w","w"],e,i),(b={}).type=a[0],b.offset=a[1],b.vaddr=a[2],b.paddr=a[3],b.filesz=a[4],b.memsz=a[5],b.flags=a[6],b.align=a[7],f.push(b)}var l=[];for(p=0;p<d;p++){var b;i=o+p*u,a=r.Unmarshall(["w","w","w","w","w","w"],e,i),(b={}).name=a[0],b.type=a[1],b.flags=a[2],b.addr=a[3],b.offset=a[4],b.size=a[5],l.push(b)}for(p=0;p<f.length;p++)if(1==f[p].type&&0!=f[p].memsz){if(f[p].filesz>0)for(var x=0;x<f[p].filesz;x++)t.Write8(f[p].paddr+x,e[f[p].offset+x]);for(x=0;x<f[p].memsz-f[p].filesz;x++)t.Write8(f[p].paddr+f[p].filesz+x,0)}}},i.exports=a}),define("cjs!jor1k/worker/timer",["require","exports","module","cjs!./messagehandler","cjs!./utils"],function(e,t,i){!function(){e("cjs!./messagehandler");var t=e("cjs!./utils");function s(e,t){this.ticksperms=e,this.loopspersecond=t,this.baserealtime=0,this.realtime=0,this.lastsystemticks=0,this.systemtime=0,this.correction=1,this.oldcorrection=1,this.steps=0,this.nins=0,this.lastlooptime=-1,this.ipms=1e4,this.instructionsperloop=0,this.timercyclesperinstruction=10,this.UpdateTimings()}s.prototype.Update=function(e,t,i){this.GlobalUpdate(t),this.LocalUpdate(e,i)},s.prototype.UpdateTimings=function(e,t){this.instructionsperloop=Math.floor(1e3*this.ipms/this.loopspersecond),this.instructionsperloop=this.instructionsperloop<2e3?2e3:this.instructionsperloop,this.instructionsperloop=this.instructionsperloop>1e8?1e8:this.instructionsperloop,this.timercyclesperinstruction=Math.floor(64*this.ticksperms/this.ipms*this.correction),this.timercyclesperinstruction=this.timercyclesperinstruction<=1?1:this.timercyclesperinstruction,this.timercyclesperinstruction=this.timercyclesperinstruction>=1e3?1e3:this.timercyclesperinstruction},s.prototype.LocalUpdate=function(e,i){if(this.nins+=e,i)return this.lastlooptime=-1,void(this.nins=0);if(this.lastlooptime<0)return this.lastlooptime=t.GetMilliseconds(),void(this.nins=0);var s=t.GetMilliseconds()-this.lastlooptime;s>50&&this.nins>2e3&&(this.ipms=this.nins/s,this.UpdateTimings(),this.lastlooptime=t.GetMilliseconds(),this.nins=0)},s.prototype.GlobalUpdate=function(e){if(!(e<0)){e/=this.ticksperms,this.baserealtime<=0&&(this.baserealtime=t.GetMilliseconds()),this.realtime=t.GetMilliseconds()-this.baserealtime,this.lastsystemticks>e?this.systemtime+=e-this.lastsystemticks+268435456/this.ticksperms:this.systemtime+=e-this.lastsystemticks,this.lastsystemticks=e;var i=Math.abs(this.systemtime-this.realtime);i>500&&(this.baserealtime=t.GetMilliseconds(),this.systemtime=0,this.lastsystemticks=0),this.correction=1,this.systemtime>this.realtime+50&&(this.correction=.9),this.realtime>this.systemtime+50&&(this.correction=1.1),i>200&&(this.correction=this.correction*this.correction),i>400&&(this.correction=this.correction*this.correction),this.oldcorrection!=this.correction&&(this.UpdateTimings(),this.oldcorrection=this.correction)}},i.exports=s}()}),define("cjs!jor1k/worker/imul",["require","exports","module"],function(e,t,i){i.exports=Math.imul||function(e,t){var i=65535&e,s=65535&t;return i*s+((e>>>16&65535)*s+i*(t>>>16&65535)<<16>>>0)|0}}),define(function(e,t,i){!function(){e("cjs!../messagehandler");i.exports=((e,t,i)=>{"use asm";var s=e.Math.floor,r=t.imul,a=t.DebugMessage,n=t.abort,o=t.Read32,c=t.Write32,h=t.Read16,u=t.Write16,d=t.Read8,f=t.Write8,p=0,l=1,b=2,x=3,m=4,v=5,g=6,k=7,R=8,y=1,F=17,C=48,S=32,w=64,D=4,T=3,E=6,I=5,A=0,j=0xA00,_=0x400,M=0x100,L=0x900,q=0x300,U=0x200,P=0x500,B=0x800,W=0xC00,H=0xE00,z=new e.Int32Array(i),O=new e.Float32Array(i),G=new e.Int32Array(i),N=new e.Uint8Array(i),V=new e.Uint16Array(i),X=0x0,Q=0x100000,K=0x2000,Y=0x4000,J=0x6000,Z=0x0,$=0,ee=0,te=-4,ie=0,se=0,re=0x0,ae=0x0,ne=0,oe=-1,ce=-1,he=-1,ue=-1,de=-1,fe=-1,pe=-1,le=-1,be=-1,xe=-1,me=-1,ve=-1,ge=-1,ke=-1,Re=-1,ye=-1,Fe=-1,Ce=-1,Se=-1,we=0x0,De=0x0,Te=0x3,Ee=0x0,Ie=1,Ae=0,je=0,_e=0,Me=0,Le=0,qe=0,Ue=0,Pe=0,Be=0,We=0,He=0,ze=0,Oe=0,Ge=0,Ne=1,Ve=0,Xe=0x0,Qe=0x0,Ke=0x0,Ye=0x0,Je=0,Ze=0x0;function $e(){nt();et()}function et(){we=0x0;De=0x0;Te=0x3;Ee=0x0;G[K+(D<<2)>>2]=0x18;G[K+(T<<2)>>2]=0x18;G[K+(E<<2)>>2]=0x48;G[K+(I<<2)>>2]=0x48;G[K+(A<<2)>>2]=0x12000001;G[K+(y<<2)>>2]=0x619;$=0;ee=0;te=-4;lt(M,0x0)}function tt(){oe=-1;ce=-1;he=-1;ue=-1;de=-1;fe=-1;pe=-1;le=-1;be=-1;xe=-1;me=-1;ve=-1;ge=-1;ke=-1;Re=-1;ye=-1;Fe=-1;Ce=-1}function it(){return Z>>>2|0}function st(){var e=0x0;if(we>>30==0)return-1;e=(we&0xFFFFFFF)-(De&0xFFFFFFF)|0;return e|0}function rt(e){e=e|0;De=De+e|0}function at(){if(we>>30==0)return-1;return De&0xFFFFFFF|0}function nt(){Qe=G[Q+0x900>>2]|0;Ke=G[Q+0xA00>>2]|0;Ye=(G[Q+0x2010>>2]&0xFFF)<<16|G[Q+0x2014>>2]&0xFFFF|0}function ot(e){e=e|0;Ie=e&1<<0;Ae=e&1<<1;je=e&1<<2;_e=e&1<<3;Me=e&1<<4;Le=e&1<<5;qe=e&1<<6;Ue=e&1<<7;Pe=e&1<<8;Be=e&1<<9;We=e&1<<10;He=e&1<<11;ze=e&1<<12;Oe=e&1<<13;Ge=e&1<<14;Ne=1;Ve=e&1<<16;Xe=e>>28&0xF;if(Ue){a(p|0);n()}if(Xe){a(l|0);n()}if(Ge){a(b|0);n()}if(Oe){a(x|0);n()}}function ct(){var e=0x0;e=e|(Ie?1<<0:0);e=e|(Ae?1<<1:0);e=e|(je?1<<2:0);e=e|(_e?1<<3:0);e=e|(Me?1<<4:0);e=e|(Le?1<<5:0);e=e|(qe?1<<6:0);e=e|(Ue?1<<7:0);e=e|(Pe?1<<8:0);e=e|(Be?1<<9:0);e=e|(We?1<<10:0);e=e|(He?1<<11:0);e=e|(ze?1<<12:0);e=e|(Oe?1<<13:0);e=e|(Ge?1<<14:0);e=e|(Ne?1<<15:0);e=e|(Ve?1<<16:0);e=e|Xe<<28;return e|0}function ht(){Je=Te&Ee}function ut(e,t){e=e|0;t=t|0;var i=0;i=1<<e|0;Ee=Ee|i;ht()}function dt(e,t){e=e|0;t=t|0;Ee=Ee&~(1<<e);Je=Te&Ee}function ft(e,t){e=e|0;t=t|0;var i=0;var s=0;i=e&0x7FF;s=e>>11&0x1F;switch(s|0){case 0:if((i|0)==(F|0)){ot(t)}G[K+(i<<2)>>2]=t;break;case 1:G[Y+(i<<2)>>2]=t;break;case 2:G[J+(i<<2)>>2]=t;break;case 3:case 4:break;case 8:Ze=0x1;break;case 9:switch(i|0){case 0:Te=t|0x3;ht();if(je){if(Je){a(m|0);n()}}break;case 2:break;default:a(v|0);n()}break;case 10:switch(i|0){case 0:we=t|0;if((we>>30&3)!=0x3){a(g|0);n()}break;case 1:De=t|0;break;default:a(R|0);n();break}break;default:a(R|0);n();break}}function pt(e){e=e|0;var t=0;var i=0;t=e&0x7FF;i=e>>11&0x1F;switch(i|0){case 0:if((t|0)==(F|0)){return ct()|0}return G[K+(t<<2)>>2]|0;case 1:return G[Y+(t<<2)>>2]|0;case 2:return G[J+(t<<2)>>2]|0;case 8:return 0x0;case 9:switch(t|0){case 0:return Te|0;case 2:return Ee|0;default:a(R|0);n();break}break;case 10:switch(t|0){case 0:return we|0;case 1:return De|0;default:a(R|0);n();break}break;default:a(R|0);n();break}return 0|0}function lt(e,t){e=e|0;t=t|0;var i=0;i=e|(Ge?0xf0000000:0x0);ft(C,t);ft(w,ct()|0);Se=-1;ze=0;Ie=1;je=0;Ae=0;Le=0;oe=0;ce=0;he=0;ue=0;de=0;fe=0;pe=0;le=0;be=0;xe=0;me=0;ge=0;ve=0;Re=0;ke=0;ye=0;Fe=0;Ce=0;ie=$|0;re=i;switch(e|0){case 0x100:break;case 0x300:case 0x900:case 0xE00:case 0x200:Z=te+$|0;ft(S,Z-(se?4:0)|0);break;case 0xA00:case 0x400:case 0x500:case 0x800:ft(S,Z-(se?4:0)|0);break;case 0xC00:Z=te+$|0;ft(S,Z+4-(se?4:0)|0);break;default:a(k|0);n()}se=0;ne=0;qe=0}function bt(e,t){e=e|0;t=t|0;var i=0;var s=0;var r=0;var a=0;if((G[Q+0x900>>2]|0)==(Qe|0)){lt(L,e);return 0|0}i=e;s=G[Q+Ye>>2]|0;r=i>>>0x18<<2;a=r+s|0;r=0x40000000+a&0xFFFFFFFF;s=G[Q+r>>2]|0;if((s|0)==0){lt(q,e);return 0|0}s=0xffffe000;r=G[Q+r>>2]|0;r=r&s;a=i>>>0xD;s=a&0x7FF;s=s<<0x2;s=s+r|0;i=G[Q+s>>2]|0;if((i&1)==0){lt(q,e);return 0|0}r=i&0xFFFFe3fa;a=a&t-1;G[Y+((0x280|a)<<2)>>2]=r;i=e;r=i&0xFFFFE000;r=r|0x1;G[Y+((0x200|a)<<2)>>2]=r;return 1|0}function xt(e,t){e=e|0;t=t|0;var i=0;var s=0;var r=0;var a=0;if((G[Q+0xA00>>2]|0)==(Ke|0)){lt(j,e);return 0|0}i=e;s=G[Q+Ye>>2]|0;r=i>>>0x18<<2;a=r+s|0;r=0x40000000+a&0xFFFFFFFF;s=G[Q+r>>2]|0;if((s|0)==0){lt(_,e);return 0|0}s=0xffffe000;r=G[Q+r>>2]|0;r=r&s;a=i>>>0xD;s=a&0x7FF;s=s<<0x2;s=s+r|0;i=G[Q+s>>2]|0;if((i&1)==0){lt(_,e);return 0|0}r=i&0xFFFFe03a;s=i&0x7c0;if((s|0)!=0x0){a=a&t-1;r=r|0xc0}G[J+((0x280|a)<<2)>>2]=r;i=e;r=i&0xFFFFE000;r=r|0x1;G[J+((0x200|a)<<2)>>2]=r;return 1|0}function mt(e,t){e=e|0;t=t|0;var i=0;var s=0;var r=0;if(!Le){return e|0}i=e>>13&63;s=G[Y+((0x200|i)<<2)>>2]|0;if((s&1)==0){if(bt(e,64)|0){s=G[Y+(0x200+i<<2)>>2]|0}else{return-1|0}}if(s>>19!=e>>19){if(bt(e,64)|0){s=G[Y+(0x200+i<<2)>>2]|0}else{return-1|0}}r=G[Y+((0x280|i)<<2)>>2]|0;if(Ie){if(!t){if(!(r&0x100)){lt(q,e);return-1|0}}else{if(!(r&0x200)){lt(q,e);return-1|0}}}else{if(!t){if(!(r&0x40)){lt(q,e);return-1|0}}else{if(!(r&0x80)){lt(q,e);return-1|0}}}return r&0xFFFFE000|e&0x1FFF|0}function vt(e,t){e=e|0;t=t|0;var i=0x0;var p=0x0;var l=0;var b=0x0;var x=0x0,m=0x0,v=0x0;var g=0x0;var k=0x0;var y=0x0;var F=0x0;var D=0x0;var T=0x0;var E=-1;for(;;){if(($|0)!=(ie|0)){i=G[$>>2]|0;$=$+4|0;switch(i>>26&0x3F){case 0x0:Z=te+$|0;ae=Z+(i<<6>>4)|0;if((ie|0)==($|0)){ne=1}else{ie=$+4|0;re=ae|0}se=1;continue;case 0x1:Z=te+$|0;ae=Z+(i<<6>>4)|0;z[9]=Z+8|0;if((ie|0)==($|0)){ne=1}else{ie=$+4|0;re=ae|0}se=1;continue;case 0x3:if(Be){continue}Z=te+$|0;ae=Z+(i<<6>>4)|0;if((ie|0)==($|0)){ne=1}else{ie=$+4|0;re=ae|0}se=1;continue;case 0x4:if(!Be){continue}Z=te+$|0;ae=Z+(i<<6>>4)|0;if((ie|0)==($|0)){ne=1}else{ie=$+4|0;re=ae|0}se=1;continue;case 0x5:continue;case 0x6:b=i>>21&0x1F;z[b<<2>>2]=(i&0xFFFF)<<16;continue;case 0x8:if((i&0xFFFF0000)==0x21000000){lt(H,G[K+C>>2]|0)}else{lt(W,G[K+C>>2]|0)}continue;case 0x9:ae=pt(S)|0;tt();ie=$;re=ae;ot(pt(w)|0);continue;case 0x11:ae=z[(i>>9&0x7C)>>2]|0;if((ie|0)==($|0)){ne=1}else{ie=$+4|0;re=ae|0}se=1;continue;case 0x12:Z=te+$|0;ae=z[(i>>9&0x7C)>>2]|0;z[9]=Z+8|0;if((ie|0)==($|0)){ne=1}else{ie=$+4|0;re=ae|0}se=1;continue;case 0x1B:g=(z[(i>>14&0x7C)>>2]|0)+(i<<16>>16)|0;if((me^g)>>13){k=mt(g,0)|0;if((k|0)==-1){break}me=g;ce=(k^g)>>13<<13}k=ce^g;Se=k;z[(i>>19&0x7C)>>2]=(k|0)>0?G[Q+k>>2]|0:o(k|0)|0;continue;case 0x21:g=(z[(i>>14&0x7C)>>2]|0)+(i<<16>>16)|0;if((me^g)>>13){k=mt(g,0)|0;if((k|0)==-1){break}me=g;ce=(k^g)>>13<<13}k=ce^g;z[(i>>19&0x7C)>>2]=(k|0)>0?G[Q+k>>2]|0:o(k|0)|0;continue;case 0x23:g=(z[(i>>14&0x7C)>>2]|0)+(i<<16>>16)|0;if((ge^g)>>13){k=mt(g,0)|0;if((k|0)==-1){break}ge=g;ue=(k^g)>>13<<13}k=ue^g;if((k|0)>=0){z[(i>>19&0x7C)>>2]=N[Q+(k^3)|0]|0}else{z[(i>>19&0x7C)>>2]=d(k|0)|0}continue;case 0x24:g=(z[(i>>14&0x7C)>>2]|0)+(i<<16>>16)|0;if((ve^g)>>13){k=mt(g,0)|0;if((k|0)==-1){break}ve=g;he=(k^g)>>13<<13}k=he^g;if((k|0)>=0){z[(i>>19&0x7C)>>2]=N[Q+(k^3)|0]<<24>>24}else{z[(i>>19&0x7C)>>2]=(d(k|0)|0)<<24>>24}continue;case 0x25:g=(z[(i>>14&0x7C)>>2]|0)+(i<<16>>16)|0;if((Re^g)>>13){k=mt(g,0)|0;if((k|0)==-1){break}Re=g;fe=(k^g)>>13<<13}k=fe^g;if((k|0)>=0){z[(i>>19&0x7C)>>2]=V[Q+(k^2)>>1]}else{z[(i>>19&0x7C)>>2]=h(k|0)|0}continue;case 0x26:g=(z[(i>>14&0x7C)>>2]|0)+(i<<16>>16)|0;if((ke^g)>>13){k=mt(g,0)|0;if((k|0)==-1){break}ke=g;de=(k^g)>>13<<13}k=de^g;if((k|0)>=0){z[(i>>19&0x7C)>>2]=V[Q+(k^2)>>1]<<16>>16}else{z[(i>>19&0x7C)>>2]=(h(k|0)|0)<<16>>16}continue;case 0x27:x=z[(i>>14&0x7C)>>2]|0;b=i>>19&0x7C;z[b>>2]=x+(i<<16>>16)|0;We=z[b>>2]>>>0<x>>>0;continue;case 0x28:x=z[(i>>14&0x7C)>>2]|0;b=i>>19&0x7C;z[b>>2]=(x+(i<<16>>16)|0)+(We?1:0)|0;if(We){We=z[b>>2]>>>0<=x>>>0}else{We=z[b>>2]>>>0<x>>>0}continue;case 0x29:z[(i>>19&0x7C)>>2]=z[(i>>14&0x7C)>>2]&(i&0xFFFF);continue;case 0x2A:z[(i>>19&0x7C)>>2]=z[(i>>14&0x7C)>>2]|i&0xFFFF;continue;case 0x2B:x=z[(i>>14&0x7C)>>2]|0;z[(i>>19&0x7C)>>2]=x^i<<16>>16;continue;case 0x2C:x=z[(i>>14&0x7C)>>2]|0;z[(i>>19&0x7C)>>2]=r(x|0,i<<16>>16)|0;break;case 0x2D:z[(i>>19&0x7C)>>2]=pt(z[(i>>14&0x7C)>>2]|i&0xFFFF)|0;continue;case 0x2E:switch(i>>6&0x3){case 0:z[(i>>19&0x7C)>>2]=z[(i>>14&0x7C)>>2]<<(i&0x1F);continue;case 1:z[(i>>19&0x7C)>>2]=z[(i>>14&0x7C)>>2]>>>(i&0x1F);continue;case 2:z[(i>>19&0x7C)>>2]=z[(i>>14&0x7C)>>2]>>(i&0x1F);continue;default:a(R|0);n();break}break;case 0x2F:p=i<<16>>16;switch(i>>21&0x1F){case 0x0:Be=(z[(i>>14&0x7C)>>2]|0)==(p|0);continue;case 0x1:Be=(z[(i>>14&0x7C)>>2]|0)!=(p|0);continue;case 0x2:Be=z[(i>>14&0x7C)>>2]>>>0>p>>>0;continue;case 0x3:Be=z[(i>>14&0x7C)>>2]>>>0>=p>>>0;continue;case 0x4:Be=z[(i>>14&0x7C)>>2]>>>0<p>>>0;continue;case 0x5:Be=z[(i>>14&0x7C)>>2]>>>0<=p>>>0;continue;case 0xa:Be=(z[(i>>14&0x7C)>>2]|0)>(p|0);continue;case 0xb:Be=(z[(i>>14&0x7C)>>2]|0)>=(p|0);continue;case 0xc:Be=(z[(i>>14&0x7C)>>2]|0)<(p|0);continue;case 0xd:Be=(z[(i>>14&0x7C)>>2]|0)<=(p|0);continue;default:a(R|0);n();break}break;case 0x30:p=i&0x7FF|i>>10&0xF800;ft(z[(i>>14&0x7C)>>2]|p,z[(i>>9&0x7C)>>2]|0);if(Ze|0){Ze=0x0;if(we&1<<28)if(Ae|0){lt(P,G[K+(C<<2)>>2]|0);continue}if(je|0)if(Je|0){lt(B,G[K+(C<<2)>>2]|0);continue}return e|0}continue;case 0x32:x=i>>14&0x7C;m=i>>9&0x7C;v=i>>19&0x7C;switch(i&0xFF){case 0x0:O[v>>2]=+O[x>>2]+ +O[m>>2];continue;case 0x1:O[v>>2]=+O[x>>2]-+O[m>>2];continue;case 0x2:O[v>>2]=+O[x>>2]*+O[m>>2];continue;case 0x3:O[v>>2]=+O[x>>2]/+O[m>>2];continue;case 0x4:O[v>>2]=+(z[x>>2]|0);continue;case 0x5:z[v>>2]=~~+s(+O[x>>2]);continue;case 0x7:O[v>>2]=+O[v>>2]+ +O[x>>2]*+O[m>>2];continue;case 0x8:Be=+O[x>>2]==+O[m>>2];continue;case 0x9:Be=+O[x>>2]!=+O[m>>2];continue;case 0xa:Be=+O[x>>2]>+O[m>>2];continue;case 0xb:Be=+O[x>>2]>=+O[m>>2];continue;case 0xc:Be=+O[x>>2]<+O[m>>2];continue;case 0xd:Be=+O[x>>2]<=+O[m>>2];continue;default:a(R|0);n();break}break;case 0x33:p=(i>>10&0xF800|i&0x7FF)<<16>>16;g=(z[(i>>14&0x7C)>>2]|0)+p|0;if((ye^g)>>13){k=mt(g,1)|0;if((k|0)==-1){break}ye=g;pe=(k^g)>>13<<13}k=pe^g;Be=(k|0)==(Se|0)?1|0:0|0;Se=-1;if((Be|0)==0){break}if((k|0)>0){G[Q+k>>2]=z[(i>>9&0x7C)>>2]|0}else{c(k|0,z[(i>>9&0x7C)>>2]|0)}continue;case 0x35:p=(i>>10&0xF800|i&0x7FF)<<16>>16;g=(z[(i>>14&0x7C)>>2]|0)+p|0;if((ye^g)>>13){k=mt(g,1)|0;if((k|0)==-1){break}ye=g;pe=(k^g)>>13<<13}k=pe^g;if((k|0)>0){G[Q+k>>2]=z[(i>>9&0x7C)>>2]|0}else{c(k|0,z[(i>>9&0x7C)>>2]|0)}continue;case 0x36:p=(i>>10&0xF800|i&0x7FF)<<16>>16;g=(z[(i>>14&0x7C)>>2]|0)+p|0;if((Fe^g)>>13){k=mt(g,1)|0;if((k|0)==-1){break}Fe=g;le=(k^g)>>13<<13}k=le^g;if((k|0)>0){N[Q+(k^3)|0]=z[(i>>9&0x7C)>>2]|0}else{f(k|0,z[(i>>9&0x7C)>>2]|0)}continue;case 0x37:p=(i>>10&0xF800|i&0x7FF)<<16>>16;g=(z[(i>>14&0x7C)>>2]|0)+p|0;if((Ce^g)>>13){k=mt(g,1)|0;if((k|0)==-1){break}Ce=g;be=(k^g)>>13<<13}k=be^g;if((k|0)>=0){V[Q+(k^2)>>1]=z[(i>>9&0x7C)>>2]}else{u(k|0,z[(i>>9&0x7C)>>2]|0)}continue;case 0x38:x=z[(i>>14&0x7C)>>2]|0;m=z[(i>>9&0x7C)>>2]|0;b=i>>19&0x7C;switch(i&0x3CF){case 0x0:z[b>>2]=x+m|0;We=z[b>>2]>>>0<x>>>0;continue;case 0x1:z[b>>2]=(x+m|0)+(We?1:0)|0;if(We){We=z[b>>2]>>>0<=x>>>0}else{We=z[b>>2]>>>0<x>>>0}continue;case 0x2:z[b>>2]=x-m|0;We=m>>>0>x>>>0;continue;case 0x3:z[b>>2]=x&m;continue;case 0x4:z[b>>2]=x|m;continue;case 0x5:z[b>>2]=x^m;continue;case 0x8:z[b>>2]=x<<(m&0x1F);continue;case 0xc:z[b>>2]=x<<16>>16;continue;case 0xe:z[b>>2]=(Be?x:m)|0;continue;case 0x48:z[b>>2]=x>>>(m&0x1F);continue;case 0x4c:z[b>>2]=x<<24>>24;continue;case 0xf:z[b>>2]=0;for(l=0;(l|0)<32;l=l+1|0){if(x&1<<l){z[b>>2]=l+1;break}}continue;case 0x88:z[b>>2]=x>>(m&0x1F);continue;case 0x10f:z[b>>2]=0;for(l=31;(l|0)>=0;l=l-1|0){if(x&1<<l){z[b>>2]=l+1;break}}continue;case 0x306:z[b>>2]=r(x|0,m|0)|0;continue;case 0x30a:He=(m|0)==0;if(!He){z[b>>2]=(x>>>0)/(m>>>0)}continue;case 0x309:He=(m|0)==0;if(!He){z[b>>2]=(x|0)/(m|0)}continue;default:a(R|0);n();break}break;case 0x39:switch(i>>21&0x1F){case 0x0:Be=(z[(i>>14&0x7C)>>2]|0)==(z[(i>>9&0x7C)>>2]|0);continue;case 0x1:Be=(z[(i>>14&0x7C)>>2]|0)!=(z[(i>>9&0x7C)>>2]|0);continue;case 0x2:Be=z[(i>>14&0x7C)>>2]>>>0>z[(i>>9&0x7C)>>2]>>>0;continue;case 0x3:Be=z[(i>>14&0x7C)>>2]>>>0>=z[(i>>9&0x7C)>>2]>>>0;continue;case 0x4:Be=z[(i>>14&0x7C)>>2]>>>0<z[(i>>9&0x7C)>>2]>>>0;continue;case 0x5:Be=z[(i>>14&0x7C)>>2]>>>0<=z[(i>>9&0x7C)>>2]>>>0;continue;case 0xa:Be=(z[(i>>14&0x7C)>>2]|0)>(z[(i>>9&0x7C)>>2]|0);continue;case 0xb:Be=(z[(i>>14&0x7C)>>2]|0)>=(z[(i>>9&0x7C)>>2]|0);continue;case 0xc:Be=(z[(i>>14&0x7C)>>2]|0)<(z[(i>>9&0x7C)>>2]|0);continue;case 0xd:Be=(z[(i>>14&0x7C)>>2]|0)<=(z[(i>>9&0x7C)>>2]|0);continue;default:a(R|0);n()}break;default:a(R|0);n();break}}else{Z=re;if(!(ne|0)){se=0}E=E-($-ee>>2)|0;if((E|0)<0)if(!(ne|0)){E=E+64|0;e=e-64|0;if((e|0)<0)return 0x0;if(we>>30!=0){T=(we&0xFFFFFFF)-(De&0xFFFFFFF)|0;De=De+t|0;if((T|0)<=(t|0)){if(we&1<<29){we=we|1<<28}}}if(we&1<<28){if(Ae|0){lt(P,G[K+(C<<2)>>2]|0);Z=re}}}if(je|0)if(Je|0){lt(B,G[K+(C<<2)>>2]|0);Z=re}if((xe^Z)&0xFFFFE000){xe=Z;if(!qe){oe=0x0}else{y=Z>>13&63;F=G[J+((0x200|y)<<2)>>2]|0;if((F&1)==0){if(xt(Z,64)|0){F=G[J+((0x200|y)<<2)>>2]|0}else{ee=$;ne=0;continue}}if(F>>19!=Z>>19){if(xt(Z,64)|0){F=G[J+((0x200|y)<<2)>>2]|0}else{ee=$;ne=0;continue}}D=G[J+((0x280|y)<<2)>>2]|0;oe=(D^F)>>13<<13}}$=Q+(oe^Z)|0;ee=$;te=Z-4-ee|0;if(ne|0){ne=0;ie=$+4|0;re=ae}else{ie=($>>13)+1<<13;re=(Z>>13)+1<<13}}}return e|0}return{Init:$e,Reset:et,InvalidateTLB:tt,Step:vt,GetFlags:ct,SetFlags:ot,GetTimeToNextInterrupt:st,ProgressTime:rt,GetTicks:at,RaiseInterrupt:ut,ClearInterrupt:dt,AnalyzeImage:nt,GetStat:it}})}()}),define("cjs!jor1k/worker/or1k/safecpu",["require","exports","module","cjs!../messagehandler","cjs!../utils"],function(e,t,i){!function(){var t=e("cjs!../messagehandler"),s=e("cjs!../utils");function r(e){this.ram=e,this.r=new Int32Array(this.ram.heap,0,136),this.f=new Float32Array(this.ram.heap,0,128),this.group0=new Int32Array(this.ram.heap,8192,8192),this.group1=new Int32Array(this.ram.heap,16384,8192),this.group2=new Int32Array(this.ram.heap,24576,8192),this.pc=0,this.nextpc=0,this.delayedins=!1,this.clock=0,this.EA=-1,this.TTMR=0,this.TTCR=0,this.PICMR=3,this.PICSR=0,this.SR_SM=!0,this.SR_TEE=!1,this.SR_IEE=!1,this.SR_DCE=!1,this.SR_ICE=!1,this.SR_DME=!1,this.SR_IME=!1,this.SR_LEE=!1,this.SR_CE=!1,this.SR_F=!1,this.SR_CY=!1,this.SR_OV=!1,this.SR_OVE=!1,this.SR_DSX=!1,this.SR_EPH=!1,this.SR_FO=!0,this.SR_SUMRA=!1,this.SR_CID=0,this.Reset()}r.prototype.Reset=function(){this.TTMR=0,this.TTCR=0,this.PICMR=3,this.PICSR=0,this.group0[4]=24,this.group0[3]=24,this.group0[6]=72,this.group0[5]=72,this.group0[0]=301989889,this.group0[1]=1561,this.Exception(256,0),this.pc=this.nextpc,this.nextpc++},r.prototype.InvalidateTLB=function(){},r.prototype.GetTimeToNextInterrupt=function(){return this.TTMR>>30==0?-1:(268435455&this.TTMR)-(268435455&this.TTCR)},r.prototype.GetTicks=function(){return this.TTMR>>30==0?-1:268435455&this.TTCR},r.prototype.ProgressTime=function(e){this.TTCR=this.TTCR+e&4294967295},r.prototype.AnalyzeImage=function(){this.boot_dtlb_misshandler_address=0,this.boot_itlb_misshandler_address=0,this.current_pgd=0},r.prototype.SetFlags=function(e){this.SR_SM=!!(1&e),this.SR_TEE=!!(2&e);var i=this.SR_IEE;this.SR_IEE=!!(4&e),this.SR_DCE=!!(8&e),this.SR_ICE=!!(16&e);this.SR_DME;this.SR_DME=!!(32&e);this.SR_IME;this.SR_IME=!!(64&e),this.SR_LEE=!!(128&e),this.SR_CE=!!(256&e),this.SR_F=!!(512&e),this.SR_CY=!!(1024&e),this.SR_OV=!!(2048&e),this.SR_OVE=!!(4096&e),this.SR_DSX=!!(8192&e),this.SR_EPH=!!(16384&e),this.SR_FO=!0,this.SR_SUMRA=!!(65536&e),this.SR_CID=e>>28&15,this.SR_LEE&&(t.Debug("little endian not supported"),t.Abort()),this.SR_CID&&(t.Debug("context id not supported"),t.Abort()),this.SR_EPH&&(t.Debug("exception prefix not supported"),t.Abort()),this.SR_DSX&&(t.Debug("delay slot exception not supported"),t.Abort()),this.SR_IEE&&!i&&this.CheckForInterrupt()},r.prototype.GetFlags=function(){var e=0;return e|=this.SR_SM?1:0,e|=this.SR_TEE?2:0,e|=this.SR_IEE?4:0,e|=this.SR_DCE?8:0,e|=this.SR_ICE?16:0,e|=this.SR_DME?32:0,e|=this.SR_IME?64:0,e|=this.SR_LEE?128:0,e|=this.SR_CE?256:0,e|=this.SR_F?512:0,e|=this.SR_CY?1024:0,e|=this.SR_OV?2048:0,e|=this.SR_OVE?4096:0,e|=this.SR_DSX?8192:0,e|=this.SR_EPH?16384:0,e|=this.SR_FO?32768:0,e|=this.SR_SUMRA?65536:0,e|=this.SR_CID<<28},r.prototype.CheckForInterrupt=function(){this.SR_IEE&&this.PICMR&this.PICSR&&(this.Exception(2048,this.group0[48]),this.pc=this.nextpc++)},r.prototype.RaiseInterrupt=function(e,t){this.PICSR|=1<<e,this.CheckForInterrupt()},r.prototype.ClearInterrupt=function(e,t){this.PICSR&=~(1<<e)},r.prototype.SetSPR=function(e,i){var s=2047&e,r=e>>11&31;switch(r){case 0:17==s&&this.SetFlags(i),this.group0[s]=i;break;case 1:this.group1[s]=i;break;case 2:this.group2[s]=i;break;case 3:case 4:case 8:break;case 9:switch(s){case 0:this.PICMR=3|i,this.SR_IEE&&this.PICMR&this.PICSR&&(t.Debug("Error in SetSPR: Direct triggering of interrupt exception not supported?"),t.Abort());break;case 2:break;default:t.Debug("Error in SetSPR: interrupt address not supported"),t.Abort()}break;case 10:switch(s){case 0:this.TTMR=i,this.TTMR;break;case 1:this.TTCR=i;break;default:t.Debug("Error in SetSPR: Tick timer address not supported"),t.Abort()}break;default:t.Debug("Error in SetSPR: group "+r+" not found"),t.Abort()}},r.prototype.GetSPR=function(e){var i=2047&e,s=e>>11&31;switch(s){case 0:return 17==i?this.GetFlags():this.group0[i];case 1:return this.group1[i];case 2:return this.group2[i];case 8:return 0;case 9:switch(i){case 0:return this.PICMR;case 2:return this.PICSR;default:t.Debug("Error in GetSPR: PIC address unknown"),t.Abort()}break;case 10:switch(i){case 0:return this.TTMR;case 1:return this.TTCR;default:t.Debug("Error in GetSPR: Tick timer address unknown"),t.Abort()}break;default:t.Debug("Error in GetSPR: group "+s+" unknown"),t.Abort()}},r.prototype.Exception=function(e,i){var s=e|(this.SR_EPH?4026531840:0);switch(this.SetSPR(48,i),this.SetSPR(64,this.GetFlags()),this.EA=-1,this.SR_OVE=!1,this.SR_SM=!0,this.SR_IEE=!1,this.SR_TEE=!1,this.SR_DME=!1,this.nextpc=s>>2,e){case 256:break;case 2560:case 1024:case 2304:case 768:case 512:case 1280:case 2048:case 3584:this.SetSPR(32,(this.pc<<2)-(this.delayedins?4:0));break;case 3072:this.SetSPR(32,4+(this.pc<<2)-(this.delayedins?4:0));break;default:t.Debug("Error in Exception: exception type not supported"),t.Abort()}1280==e&&this.TTMR>>30==1&&(this.TTCR=0),this.delayedins=!1,this.SR_IME=!1},r.prototype.DTLBLookup=function(e,i){if(!this.SR_DME)return e;var s=e>>13&63,r=this.group1[512|s];if(0==(1&r)||r>>19!=e>>19)return this.Exception(2304,e),-1;192&r&&(t.Debug("Error: LRU ist not supported"),t.Abort());var a=this.group1[640|s];if(this.SR_SM){if(!i&&!(256&a)||i&&!(512&a))return this.Exception(768,e),-1}else if(!i&&!(64&a)||i&&!(128&a))return this.Exception(768,e),-1;return 4294959104&a|8191&e},r.prototype.GetInstruction=function(e){if(!this.SR_IME)return this.ram.Read32Big(e);var i=e>>13&63;i&=63;var s=this.group2[512|i];if(0==(1&s)||s>>19!=e>>19)return this.Exception(2560,this.pc<<2),-1;192&s&&(t.Debug("Error: LRU ist not supported"),t.Abort());var r=this.group2[640|i];if(this.SR_SM){if(!(64&r))return this.Exception(1024,this.pc<<2),-1}else if(!(128&r))return this.Exception(1024,this.pc<<2),-1;return this.ram.Read32Big(4294959104&r|8191&e)},r.prototype.Step=function(e,i){var r=0,a=0,n=0,o=0,c=0,h=0,u=0,d=this.r,f=this.f,p=this.ram,l=this.ram.int32mem,b=(this.group2,0),x=0;do{if(this.clock++,63&e||(this.TTMR>>30!=0&&(x=(268435455&this.TTMR)-(268435455&this.TTCR),this.TTCR=this.TTCR+i&4294967295,x<i&&this.TTMR&1<<29&&(this.TTMR|=1<<28)),this.SR_TEE&&this.TTMR&1<<28&&(this.Exception(1280,this.group0[48]),this.pc=this.nextpc++)),-1!=(r=this.GetInstruction(this.pc<<2))){switch(r>>26&63){case 0:b=this.pc+(r<<6>>6),this.pc=this.nextpc,this.nextpc=b,this.delayedins=!0;continue;case 1:b=this.pc+(r<<6>>6),d[9]=4+(this.nextpc<<2),this.pc=this.nextpc,this.nextpc=b,this.delayedins=!0;continue;case 3:if(this.SR_F)break;b=this.pc+(r<<6>>6),this.pc=this.nextpc,this.nextpc=b,this.delayedins=!0;continue;case 4:if(!this.SR_F)break;b=this.pc+(r<<6>>6),this.pc=this.nextpc,this.nextpc=b,this.delayedins=!0;continue;case 5:break;case 6:o=r>>21&31,65536&r?(t.Debug("Error: macrc not supported\n"),t.Abort()):d[o]=(65535&r)<<16;break;case 8:553648128==(4294901760&r)?(t.Debug("Trap at "+s.ToHex(this.pc<<2)),this.Exception(3584,this.group0[48])):this.Exception(3072,this.group0[48]);break;case 9:this.nextpc=this.GetSPR(32)>>2,this.pc=this.nextpc++,this.delayedins=!1,this.SetFlags(this.GetSPR(64));continue;case 17:b=d[r>>11&31]>>2,this.pc=this.nextpc,this.nextpc=b,this.delayedins=!0;continue;case 18:b=d[r>>11&31]>>2,d[9]=4+(this.nextpc<<2),this.pc=this.nextpc,this.nextpc=b,this.delayedins=!0;continue;case 27:if(d[32]=d[r>>16&31]+(r<<16>>16),0!=(3&d[32])&&(t.Debug("Error in lwz: no unaligned access allowed"),abort()),d[33]=this.DTLBLookup(d[32],!1),-1==d[33])break;this.EA=d[33],d[r>>21&31]=d[33]>0?p.int32mem[d[33]>>2]:p.Read32Big(d[33]);break;case 33:if(d[32]=d[r>>16&31]+(r<<16>>16),0!=(3&d[32])&&(t.Debug("Error in lwz: no unaligned access allowed"),abort()),d[33]=this.DTLBLookup(d[32],!1),-1==d[33])break;d[r>>21&31]=d[33]>0?p.int32mem[d[33]>>2]:p.Read32Big(d[33]);break;case 35:if(d[32]=d[r>>16&31]+(r<<16>>16),d[33]=this.DTLBLookup(d[32],!1),-1==d[33])break;d[r>>21&31]=p.Read8Big(d[33]);break;case 36:if(d[32]=d[r>>16&31]+(r<<16>>16),d[33]=this.DTLBLookup(d[32],!1),-1==d[33])break;d[r>>21&31]=p.Read8Big(d[33])<<24>>24;break;case 37:if(d[32]=d[r>>16&31]+(r<<16>>16),d[33]=this.DTLBLookup(d[32],!1),-1==d[33])break;d[r>>21&31]=p.Read16Big(d[33]);break;case 38:if(d[32]=d[r>>16&31]+(r<<16>>16),d[33]=this.DTLBLookup(d[32],!1),-1==d[33])break;d[r>>21&31]=p.Read16Big(d[33])<<16>>16;break;case 39:a=r<<16>>16,c=d[r>>16&31],d[o=r>>21&31]=c+a,this.SR_CY=d[o]>>>0<c>>>0;break;case 40:a=r<<16>>16,c=d[r>>16&31],d[o=r>>21&31]=c+a+(this.SR_CY?1:0),this.SR_CY?this.SR_CY=d[o]>>>0<=c>>>0:this.SR_CY=d[o]>>>0<c>>>0;break;case 41:d[r>>21&31]=65535&d[r>>16&31]&r;break;case 42:d[r>>21&31]=d[r>>16&31]|65535&r;break;case 43:c=d[r>>16&31],d[r>>21&31]=c^r<<16>>16;break;case 44:o=r>>21&31,c=d[r>>16&31],d[o]=c*(r<<16>>16)&4294967295;var m=65535&c,v=65535&r;d[o]=4294901760&d[o]|m*v&65535;break;case 45:d[r>>21&31]=this.GetSPR(d[r>>16&31]|65535&r);break;case 46:switch(r>>6&3){case 0:d[r>>21&31]=d[r>>16&31]<<(31&r);break;case 1:d[r>>21&31]=d[r>>16&31]>>>(31&r);break;case 2:d[r>>21&31]=d[r>>16&31]>>(31&r);break;default:t.Debug("Error: opcode 2E function not implemented"),abort()}break;case 47:switch(a=r<<16>>16,r>>21&31){case 0:this.SR_F=d[r>>16&31]==a;break;case 1:this.SR_F=d[r>>16&31]!=a;break;case 2:this.SR_F=d[r>>16&31]>>>0>a>>>0;break;case 3:this.SR_F=d[r>>16&31]>>>0>=a>>>0;break;case 4:this.SR_F=d[r>>16&31]>>>0<a>>>0;break;case 5:this.SR_F=d[r>>16&31]>>>0<=a>>>0;break;case 10:this.SR_F=d[r>>16&31]>a;break;case 11:this.SR_F=d[r>>16&31]>=a;break;case 12:this.SR_F=d[r>>16&31]<a;break;case 13:this.SR_F=d[r>>16&31]<=a;break;default:t.Debug("Error: sf...i not supported yet"),abort()}break;case 48:a=2047&r|r>>10&63488,this.pc=this.nextpc++,this.delayedins=!1,this.SetSPR(d[r>>16&31]|a,d[r>>11&31]);continue;case 50:switch(c=r>>16&31,h=r>>11&31,u=r>>21&31,255&r){case 0:f[u]=f[c]+f[h];break;case 1:f[u]=f[c]-f[h];break;case 2:f[u]=f[c]*f[h];break;case 3:f[u]=f[c]/f[h];break;case 4:f[u]=d[c];break;case 5:d[u]=f[c];break;case 7:f[u]+=f[c]*f[h];break;case 8:this.SR_F=f[c]==f[h];break;case 9:this.SR_F=f[c]!=f[h];break;case 10:this.SR_F=f[c]>f[h];break;case 11:this.SR_F=f[c]>=f[h];break;case 12:this.SR_F=f[c]<f[h];break;case 13:this.SR_F=f[c]<=f[h];break;default:t.Debug("Error: lf. function "+s.ToHex(255&r)+" not supported yet"),t.Abort()}break;case 51:if(a=(r>>10&63488|2047&r)<<16>>16,d[32]=d[r>>16&31]+a,3&d[32]&&(t.Debug("Error in sw: no aligned memory access"),abort()),d[33]=this.DTLBLookup(d[32],!0),-1==d[33])break;if(this.SR_F=d[33]==this.EA,this.EA=-1,0==this.SR_F)break;d[33]>0?l[d[33]>>2]=d[r>>11&31]:p.Write32Big(d[33],d[r>>11&31]);break;case 53:if(a=(r>>10&63488|2047&r)<<16>>16,d[32]=d[r>>16&31]+a,3&d[32]&&(t.Debug("Error in sw: no aligned memory access"),t.Abort()),d[33]=this.DTLBLookup(d[32],!0),-1==d[33])break;d[33]>0?l[d[33]>>2]=d[r>>11&31]:p.Write32Big(d[33],d[r>>11&31]);break;case 54:if(a=(r>>10&63488|2047&r)<<16>>16,d[32]=d[r>>16&31]+a,d[33]=this.DTLBLookup(d[32],!0),-1==d[33])break;p.Write8Big(d[33],d[r>>11&31]);break;case 55:if(a=(r>>10&63488|2047&r)<<16>>16,d[32]=d[r>>16&31]+a,d[33]=this.DTLBLookup(d[32],!0),-1==d[33])break;p.Write16Big(d[33],d[r>>11&31]);break;case 56:switch(c=d[r>>16&31],h=d[r>>11&31],o=r>>21&31,975&r){case 0:d[o]=c+h,this.SR_CY=d[o]>>>0<c>>>0;break;case 1:d[o]=c+h+(this.SR_CY?1:0),this.SR_CY?this.SR_CY=d[o]>>>0<=c>>>0:this.SR_CY=d[o]>>>0<c>>>0;break;case 2:d[o]=c-h,this.SR_CY=h>>>0>c>>>0;break;case 3:d[o]=c&h;break;case 4:d[o]=c|h;break;case 5:d[o]=c^h;break;case 8:d[o]=c<<(31&h);break;case 12:d[o]=c<<16>>16;break;case 14:d[o]=this.SR_F?c:h;break;case 15:for(d[o]=0,n=0;n<32;n++)if(c&1<<n){d[o]=n+1;break}break;case 72:d[o]=c>>>(31&h);break;case 76:d[o]=c<<24>>24;break;case 136:d[o]=c>>(31&h);break;case 271:for(d[o]=0,n=31;n>=0;n--)if(c&1<<n){d[o]=n+1;break}break;case 774:d[o]=s.int32(c>>0)*s.int32(h);m=65535&c,v=65535&h;d[o]=4294901760&d[o]|m*v&65535;break;case 778:this.SR_OV=0==h,this.SR_OV||(d[o]=(c>>>0)/(h>>>0));break;case 777:this.SR_OV=0==h,this.SR_OV||(d[o]=c/h);break;default:t.Debug("Error: op38 opcode not supported yet"),t.Abort()}break;case 57:switch(r>>21&31){case 0:this.SR_F=d[r>>16&31]==d[r>>11&31];break;case 1:this.SR_F=d[r>>16&31]!=d[r>>11&31];break;case 2:this.SR_F=d[r>>16&31]>>>0>d[r>>11&31]>>>0;break;case 3:this.SR_F=d[r>>16&31]>>>0>=d[r>>11&31]>>>0;break;case 4:this.SR_F=d[r>>16&31]>>>0<d[r>>11&31]>>>0;break;case 5:this.SR_F=d[r>>16&31]>>>0<=d[r>>11&31]>>>0;break;case 10:this.SR_F=d[r>>16&31]>d[r>>11&31];break;case 11:this.SR_F=d[r>>16&31]>=d[r>>11&31];break;case 12:this.SR_F=d[r>>16&31]<d[r>>11&31];break;case 13:this.SR_F=d[r>>16&31]<=d[r>>11&31];break;default:t.Debug("Error: sf.... function supported yet"),t.Abort()}break;default:t.Debug("Error: Instruction with opcode "+s.ToHex(r>>>26)+" not supported"),t.Abort()}this.pc=this.nextpc++,this.delayedins=!1}else this.pc=this.nextpc++}while(--e);return 0},i.exports=r}()}),define(function(e,t,i){!function(){e("cjs!../messagehandler");i.exports=((e,t,i)=>{"use asm";var s=e.Math.floor,r=t.imul,a=t.DebugMessage,n=t.abort,o=t.Read32,c=t.Write32,h=t.Read16,u=t.Write16,d=t.Read8,f=t.Write8,p=0,l=1,b=2,x=3,m=4,v=5,g=6,k=7,R=8,y=9,F=1,C=17,S=48,w=32,D=64,T=4,E=3,I=6,A=5,j=0,_=128,M=129,L=0xA00,q=0x400,U=0x100,P=0x900,B=0x300,W=0x200,H=0x500,z=0x800,O=0xC00,G=0xE00,N=new e.Int32Array(i),V=new e.Float32Array(i),X=new e.Int32Array(i),Q=new e.Uint8Array(i),K=new e.Uint16Array(i),Y=4,J=0xF,Z=0xF,$=0,ee=0x0,te=0x0,ie=0x100000,se=0x2000,re=0x4000,ae=0x6000,ne=0x0,oe=0,ce=0,he=-4,ue=0,de=0,fe=0x0,pe=0x0,le=0,be=-1,xe=-1,me=-1,ve=-1,ge=-1,ke=-1,Re=-1,ye=-1,Fe=-1,Ce=-1,Se=-1,we=-1,De=-1,Te=-1,Ee=-1,Ie=-1,Ae=-1,je=-1,_e=0x100,Me=0x104,Le=0x108,qe=0x10C,Ue=0x110,Pe=0x114,Be=1,We=0,He=0,ze=0,Oe=0,Ge=0,Ne=0,Ve=0,Xe=0,Qe=0,Ke=0,Ye=0,Je=0,Ze=0,$e=0,et=1,tt=0,it=0x0,st=0x0,rt=0x0,at=0x0,nt=0x0;function ot(e){e=e|0;Y=e|0;if((Y|0)==32)J=0xFFFFFFFF;else J=(1<<Y)-1|0;mt();ct()}function ct(){var e=0;Z=J;nt=0x0;for(e=0;(e|0)<(Y|0);e=e+1|0){X[ee+_e>>2]=0x0;X[ee+Me>>2]=0x0;X[ee+Le>>2]=0x3;X[ee+qe>>2]=0x0;X[ee+se+(T<<2)>>2]=0x18;X[ee+se+(E<<2)>>2]=0x18;X[ee+se+(I<<2)>>2]=0x0;X[ee+se+(A<<2)>>2]=0x0;X[ee+se+(j<<2)>>2]=0x12000001;X[ee+se+(_<<2)>>2]=$|0;X[ee+se+(M<<2)>>2]=2|0;X[ee+se+(F<<2)>>2]=0x619;oe=0;ce=0;he=-4;wt(U,0x0);ht()}}function ht(){var e=0;var t=0;if((Y|0)==1)return;e=$|0;if((Z|0)==0){a(y|0);n()}if((Z&Z-1)==0)if(Z&1<<$){return}do{e=e+1|0;if((e|0)>=(Y|0))e=0}while((Z&1<<e)==0);if((e|0)==($|0))return;X[ee+0x120>>2]=kt()|0;X[ee+0x124>>2]=ne;X[ee+0x128>>2]=oe;X[ee+0x12C>>2]=ce;X[ee+0x130>>2]=he;X[ee+0x134>>2]=ue;X[ee+0x138>>2]=fe;X[ee+0x13C>>2]=pe;X[ee+0x190>>2]=de;X[ee+0x194>>2]=le;X[ee+0x140>>2]=be;X[ee+0x144>>2]=xe;X[ee+0x148>>2]=me;X[ee+0x14C>>2]=ve;X[ee+0x150>>2]=ge;X[ee+0x154>>2]=ke;X[ee+0x158>>2]=Re;X[ee+0x15C>>2]=ye;X[ee+0x160>>2]=Fe;X[ee+0x164>>2]=Ce;X[ee+0x168>>2]=Se;X[ee+0x16C>>2]=we;X[ee+0x170>>2]=De;X[ee+0x174>>2]=Te;X[ee+0x178>>2]=Ee;X[ee+0x17C>>2]=Ie;X[ee+0x180>>2]=Ae;X[ee+0x184>>2]=je;$=e|0;ee=$<<15;vt(X[ee+0x120>>2]|0);ne=X[ee+0x124>>2]|0;oe=X[ee+0x128>>2]|0;ce=X[ee+0x12C>>2]|0;he=X[ee+0x130>>2]|0;ue=X[ee+0x134>>2]|0;fe=X[ee+0x138>>2]|0;pe=X[ee+0x13C>>2]|0;de=X[ee+0x190>>2]|0;le=X[ee+0x194>>2]|0;be=X[ee+0x140>>2]|0;xe=X[ee+0x144>>2]|0;me=X[ee+0x148>>2]|0;ve=X[ee+0x14C>>2]|0;ge=X[ee+0x150>>2]|0;ke=X[ee+0x154>>2]|0;Re=X[ee+0x158>>2]|0;ye=X[ee+0x15C>>2]|0;Fe=X[ee+0x160>>2]|0;Ce=X[ee+0x164>>2]|0;Se=X[ee+0x168>>2]|0;we=X[ee+0x16C>>2]|0;De=X[ee+0x170>>2]|0;Te=X[ee+0x174>>2]|0;Ee=X[ee+0x178>>2]|0;Ie=X[ee+0x17C>>2]|0;Ae=X[ee+0x180>>2]|0;je=X[ee+0x184>>2]|0}function ut(){be=-1;xe=-1;me=-1;ve=-1;ge=-1;ke=-1;Re=-1;ye=-1;Fe=-1;Ce=-1;Se=-1;we=-1;De=-1;Te=-1;Ee=-1;Ie=-1;Ae=-1;je=-1}function dt(e){e=e|0;Z=Z|1<<e;X[(e<<15)+_e>>2]=X[(e<<15)+_e>>2]|0|1<<28}function ft(e){e=e|0;var t=0;t=X[(e<<15)+_e>>2]>>29?1:0;return t|0}function pt(e){e=e|0;var t=0;t=(X[(e<<15)+_e>>2]&0xFFFFFFF)-(X[Me>>2]&0xFFFFFFF)|0;return t|0}function lt(){var e=0xFFFFFFF;var t=0x0;var i=0;for(i=0;(i|0)<(Y|0);i=i+1|0){if(!(ft(i)|0))continue;t=pt(i)|0;if((t|0)<(e|0))e=t|0}return e|0}function bt(e){e=e|0;var t=0;X[Me>>2]=(X[Me>>2]|0)+e|0;Z=J}function xt(){return X[Me>>2]&0xFFFFFFF|0}function mt(){st=X[ie+0x900>>2]|0;rt=X[ie+0xA00>>2]|0;at=(X[ie+0x2010>>2]&0xFFF)<<16|X[ie+0x2014>>2]&0xFFFF|0}function vt(e){e=e|0;Be=e&1<<0;We=e&1<<1;He=e&1<<2;ze=e&1<<3;Oe=e&1<<4;Ge=e&1<<5;Ne=e&1<<6;Ve=e&1<<7;Xe=e&1<<8;Qe=e&1<<9;Ke=e&1<<10;Ye=e&1<<11;Je=e&1<<12;Ze=e&1<<13;$e=e&1<<14;et=1;tt=e&1<<16;it=e>>28&0xF}function gt(e){e=e|0;var t=0;t=He;vt(e);if(Ve){a(p|0);n()}if(it){a(l|0);n()}if($e){a(b|0);n()}if(Ze){a(x|0);n()}if(He){if((t|0)==(0|0)){Rt($)}}}function kt(){var e=0x0;e=e|(Be?1<<0:0);e=e|(We?1<<1:0);e=e|(He?1<<2:0);e=e|(ze?1<<3:0);e=e|(Oe?1<<4:0);e=e|(Ge?1<<5:0);e=e|(Ne?1<<6:0);e=e|(Ve?1<<7:0);e=e|(Xe?1<<8:0);e=e|(Qe?1<<9:0);e=e|(Ke?1<<10:0);e=e|(Ye?1<<11:0);e=e|(Je?1<<12:0);e=e|(Ze?1<<13:0);e=e|($e?1<<14:0);e=e|(et?1<<15:0);e=e|(tt?1<<16:0);e=e|it<<28;return e|0}function Rt(e){e=e|0;var t=0;X[ee+0x120>>2]=kt()|0;t=X[(e<<15)+0x120>>2]|0;if(t&1<<2){if(X[(e<<15)+Le>>2]&X[(e<<15)+qe>>2]){Z=Z|1<<e;X[(e<<15)+Ue>>2]=1}}}function yt(e,t){e=e|0;t=t|0;var i=0;var s=0;var r=0;s=1<<e|0;if((t|0)==-1){for(i=0;(i|0)<(Y|0);i=i+1|0){r=(i<<15)+qe|0;X[r>>2]=X[r>>2]|0|s;Rt(i)}}else{r=(t<<15)+qe|0;X[r>>2]=X[r>>2]|0|s;Rt(t)}}function Ft(e,t){e=e|0;t=t|0;var i=0;var s=0;var r=0;s=1<<e|0;if((t|0)==-1){for(i=0;(i|0)<(Y|0);i=i+1|0){r=(i<<15)+qe|0;X[r>>2]=X[r>>2]&~s}}else{r=(t<<15)+qe|0;X[r>>2]=X[r>>2]&~s}}function Ct(e,t){e=e|0;t=t|0;var i=0;var s=0;i=e&0x7FF;s=e>>11&0x1F;switch(s|0){case 0:if((i|0)==(C|0)){gt(t)}X[ee+se+(i<<2)>>2]=t;break;case 1:X[ee+re+(i<<2)>>2]=t;break;case 2:X[ee+ae+(i<<2)>>2]=t;break;case 3:case 4:break;case 8:Z=Z&~(1<<$);break;case 9:switch(i|0){case 0:X[ee+Le>>2]=t|0x3;if(He){if(X[ee+Le>>2]&X[ee+qe>>2]){a(m|0);n()}}break;case 2:break;default:a(v|0);n()}break;case 10:switch(i|0){case 0:X[ee+_e>>2]=t|0;if((X[ee+_e>>2]>>30&3)!=0x3){a(g|0);n()}break;case 1:break;default:a(R|0);n();break}break;default:a(R|0);n();break}}function St(e){e=e|0;var t=0;var i=0;t=e&0x7FF;i=e>>11&0x1F;switch(i|0){case 0:if((t|0)==(C|0)){return kt()|0}return X[ee+se+(t<<2)>>2]|0;case 1:return X[ee+re+(t<<2)>>2]|0;case 2:return X[ee+ae+(t<<2)>>2]|0;case 8:return 0x0;case 9:switch(t|0){case 0:return X[ee+Le>>2]|0;case 2:return X[ee+qe>>2]|0;default:a(R|0);n();break}break;case 10:switch(t|0){case 0:return X[ee+_e>>2]|0;case 1:return X[Me>>2]|0;default:a(R|0);n();break}break;default:a(R|0);n();break}return 0|0}function wt(e,t){e=e|0;t=t|0;var i=0;i=e|($e?0xf0000000:0x0);Z=Z|1<<$;Ct(S,t);Ct(D,kt()|0);Je=0;Be=1;He=0;We=0;Ge=0;be=0;xe=0;me=0;ve=0;ge=0;ke=0;Re=0;ye=0;Fe=0;Ce=0;Se=0;De=0;we=0;Ee=0;Te=0;Ie=0;Ae=0;je=0;ue=oe|0;fe=i;switch(e|0){case 0x100:break;case 0x300:case 0x900:case 0xE00:case 0x200:ne=he+oe|0;Ct(w,ne-(de?4:0)|0);break;case 0xA00:case 0x400:case 0x500:case 0x800:Ct(w,ne-(de?4:0)|0);break;case 0xC00:ne=he+oe|0;Ct(w,ne+4-(de?4:0)|0);break;default:a(k|0);n()}de=0;Ne=0;X[ee+Pe>>2]=-1;nt=nt&~(1<<$)}function Dt(e,t){e=e|0;t=t|0;var i=0;var s=0;var r=0;var a=0;if((X[ie+0x900>>2]|0)==(st|0)){wt(P,e);return 0|0}i=e;s=X[ie+at+($<<2)>>2]|0;r=i>>>0x18<<2;a=r+s|0;r=0x40000000+a&0xFFFFFFFF;s=X[ie+r>>2]|0;if((s|0)==0){wt(B,e);return 0|0}s=0xffffe000;r=X[ie+r>>2]|0;r=r&s;a=i>>>0xD;s=a&0x7FF;s=s<<0x2;s=s+r|0;i=X[ie+s>>2]|0;if((i&1)==0){wt(B,e);return 0|0}r=i&0xFFFFe3fa;a=a&t-1;X[ee+re+((0x280|a)<<2)>>2]=r;i=e;r=i&0xFFFFE000;r=r|0x1;X[ee+re+((0x200|a)<<2)>>2]=r;return 1|0}function Tt(e,t){e=e|0;t=t|0;var i=0;var s=0;var r=0;var a=0;if((X[ie+0xA00>>2]|0)==(rt|0)){wt(L,e);return 0|0}i=e;s=X[ie+at+($<<2)>>2]|0;r=i>>>0x18<<2;a=r+s|0;r=0x40000000+a&0xFFFFFFFF;s=X[ie+r>>2]|0;if((s|0)==0){wt(q,e);return 0|0}s=0xffffe000;r=X[ie+r>>2]|0;r=r&s;a=i>>>0xD;s=a&0x7FF;s=s<<0x2;s=s+r|0;i=X[ie+s>>2]|0;if((i&1)==0){wt(q,e);return 0|0}r=i&0xFFFFe03a;s=i&0x7c0;if((s|0)!=0x0){a=a&t-1;r=r|0xc0}X[ee+ae+((0x280|a)<<2)>>2]=r;i=e;r=i&0xFFFFE000;r=r|0x1;X[ee+ae+((0x200|a)<<2)>>2]=r;return 1|0}function Et(e,t){e=e|0;t=t|0;var i=0;var s=0;var r=0;if(!Ge){return e|0}i=e>>13&63;s=X[ee+re+((0x200|i)<<2)>>2]|0;if((s&1)==0){if(Dt(e,64)|0){s=X[ee+re+(0x200+i<<2)>>2]|0}else{return-1|0}}if(s>>19!=e>>19){if(Dt(e,64)|0){s=X[ee+re+(0x200+i<<2)>>2]|0}else{return-1|0}}r=X[ee+re+((0x280|i)<<2)>>2]|0;if(Be){if(!t){if(!(r&0x100)){wt(B,e);return-1|0}}else{if(!(r&0x200)){wt(B,e);return-1|0}}}else{if(!t){if(!(r&0x40)){wt(B,e);return-1|0}}else{if(!(r&0x80)){wt(B,e);return-1|0}}}return r&0xFFFFE000|e&0x1FFF|0}function It(e,t){e=e|0;t=t|0;var i=0x0;var p=0x0;var l=0;var b=0x0;var x=0x0,m=0x0,v=0x0;var g=0x0;var k=0x0;var y=0;var F=0x0;var C=0x0;var T=0x0;var E=0x0;var I=0;for(;;){if((oe|0)==(ue|0)){ne=fe;if(!le|0){de=0}I=I-(oe-ce>>2)|0;if((I|0)<=0)if(!(le|0)){I=I+64|0;e=e-64|0;for(l=0;(l|0)<(Y|0);l=l+1|0){if(!(ft(l)|0))continue;E=pt(l)|0;if((E|0)<(t|0)){dt(l)}}X[Me>>2]=(X[Me>>2]|0)+t|0;if((e|0)<0)return 0x0}if(He|0){if(X[ee+Ue>>2]|0){X[ee+Ue>>2]=0;wt(z,X[ee+se+(S<<2)>>2]|0);ne=fe}else if(X[ee+_e>>2]&1<<28){wt(H,X[ee+se+(S<<2)>>2]|0);ne=fe}}if((Ce^ne)&0xFFFFE000){Ce=ne;if(!Ne){be=0x0}else{F=ne>>13&63;C=X[ee+ae+((0x200|F)<<2)>>2]|0;if((C&1)==0){if(Tt(ne,64)|0){C=X[ee+ae+((0x200|F)<<2)>>2]|0}else{ce=oe;le=0;continue}}if(C>>19!=ne>>19){if(Tt(ne,64)|0){C=X[ee+ae+((0x200|F)<<2)>>2]|0}else{ce=oe;le=0;continue}}T=X[ee+ae+((0x280|F)<<2)>>2]|0;be=(T^C)>>13<<13}}oe=ie+(be^ne)|0;ce=oe;he=ne-4-ce|0;if(le|0){le=0;ue=oe+4|0;fe=pe}else{ue=(oe>>13)+1<<13;fe=(ne>>13)+1<<13}y=y+1|0;if((y&7)==0){ht();continue}}i=X[oe>>2]|0;oe=oe+4|0;switch(i>>26&0x3F){case 0x0:ne=he+oe|0;pe=ne+(i<<6>>4)|0;if((ue|0)==(oe|0)){le=1}else{ue=oe+4|0;fe=pe|0}de=1;break;case 0x1:ne=he+oe|0;pe=ne+(i<<6>>4)|0;N[ee+(9<<2)>>2]=ne+8|0;if((ue|0)==(oe|0)){le=1}else{ue=oe+4|0;fe=pe|0}de=1;break;case 0x3:if(Qe){break}ne=he+oe|0;pe=ne+(i<<6>>4)|0;if((ue|0)==(oe|0)){le=1}else{ue=oe+4|0;fe=pe|0}de=1;break;case 0x4:if(!Qe){break}ne=he+oe|0;pe=ne+(i<<6>>4)|0;if((ue|0)==(oe|0)){le=1}else{ue=oe+4|0;fe=pe|0}de=1;break;case 0x5:break;case 0x6:b=i>>21&0x1F;N[ee+(b<<2)>>2]=(i&0xFFFF)<<16;break;case 0x8:if((i&0xFFFF0000)==0x21000000){wt(G,X[ee+se+S>>2]|0)}else{wt(O,X[ee+se+S>>2]|0)}break;case 0x9:pe=St(w)|0;ut();ue=oe;fe=pe;gt(St(D)|0);break;case 0x11:pe=N[ee+(i>>9&0x7C)>>2]|0;if((ue|0)==(oe|0)){le=1}else{ue=oe+4|0;fe=pe|0}de=1;break;case 0x12:ne=he+oe|0;pe=N[ee+(i>>9&0x7C)>>2]|0;N[ee+(9<<2)>>2]=ne+8|0;if((ue|0)==(oe|0)){le=1}else{ue=oe+4|0;fe=pe|0}de=1;break;case 0x1B:g=(N[ee+(i>>14&0x7C)>>2]|0)+(i<<16>>16)|0;if((Se^g)>>13){k=Et(g,0)|0;if((k|0)==-1){break}Se=g;xe=(k^g)>>13<<13}k=xe^g;nt=nt|1<<$;X[ee+Pe>>2]=k;N[ee+(i>>19&0x7C)>>2]=(k|0)>0?X[ie+k>>2]|0:o(k|0)|0;break;case 0x21:g=(N[ee+(i>>14&0x7C)>>2]|0)+(i<<16>>16)|0;if((Se^g)>>13){k=Et(g,0)|0;if((k|0)==-1){break}Se=g;xe=(k^g)>>13<<13}k=xe^g;N[ee+(i>>19&0x7C)>>2]=(k|0)>0?X[ie+k>>2]|0:o(k|0)|0;break;case 0x23:g=(N[ee+(i>>14&0x7C)>>2]|0)+(i<<16>>16)|0;if((De^g)>>13){k=Et(g,0)|0;if((k|0)==-1){break}De=g;ve=(k^g)>>13<<13}k=ve^g;if((k|0)>=0){N[ee+(i>>19&0x7C)>>2]=Q[ie+(k^3)|0]|0}else{N[ee+(i>>19&0x7C)>>2]=d(k|0)|0}break;case 0x24:g=(N[ee+(i>>14&0x7C)>>2]|0)+(i<<16>>16)|0;if((we^g)>>13){k=Et(g,0)|0;if((k|0)==-1){break}we=g;me=(k^g)>>13<<13}k=me^g;if((k|0)>=0){N[ee+(i>>19&0x7C)>>2]=Q[ie+(k^3)|0]<<24>>24}else{N[ee+(i>>19&0x7C)>>2]=(d(k|0)|0)<<24>>24}break;case 0x25:g=(N[ee+(i>>14&0x7C)>>2]|0)+(i<<16>>16)|0;if((Ee^g)>>13){k=Et(g,0)|0;if((k|0)==-1){break}Ee=g;ke=(k^g)>>13<<13}k=ke^g;if((k|0)>=0){N[ee+(i>>19&0x7C)>>2]=K[ie+(k^2)>>1]}else{N[ee+(i>>19&0x7C)>>2]=h(k|0)|0}break;case 0x26:g=(N[ee+(i>>14&0x7C)>>2]|0)+(i<<16>>16)|0;if((Te^g)>>13){k=Et(g,0)|0;if((k|0)==-1){break}Te=g;ge=(k^g)>>13<<13}k=ge^g;if((k|0)>=0){N[ee+(i>>19&0x7C)>>2]=K[ie+(k^2)>>1]<<16>>16}else{N[ee+(i>>19&0x7C)>>2]=(h(k|0)|0)<<16>>16}break;case 0x27:p=i<<16>>16;x=N[ee+(i>>14&0x7C)>>2]|0;b=ee+(i>>19&0x7C)|0;N[b>>2]=x+p|0;Ke=N[b>>2]>>>0<x>>>0;break;case 0x28:p=i<<16>>16;x=N[ee+(i>>14&0x7C)>>2]|0;b=ee+(i>>19&0x7C)|0;N[b>>2]=(x+p|0)+(Ke?1:0)|0;if(Ke|0){Ke=N[b>>2]>>>0<=x>>>0}else{Ke=N[b>>2]>>>0<x>>>0}break;case 0x29:N[ee+(i>>19&0x7C)>>2]=N[ee+(i>>14&0x7C)>>2]&(i&0xFFFF);break;case 0x2A:N[ee+(i>>19&0x7C)>>2]=N[ee+(i>>14&0x7C)>>2]|i&0xFFFF;break;case 0x2B:x=N[ee+(i>>14&0x7C)>>2]|0;N[ee+(i>>19&0x7C)>>2]=x^i<<16>>16;break;case 0x2C:x=N[ee+(i>>14&0x7C)>>2]|0;N[ee+(i>>19&0x7C)>>2]=r(x|0,i<<16>>16)|0;break;case 0x2D:N[ee+(i>>19&0x7C)>>2]=St(N[ee+(i>>14&0x7C)>>2]|i&0xFFFF)|0;break;case 0x2E:switch(i>>6&0x3){case 0:N[ee+(i>>19&0x7C)>>2]=N[ee+(i>>14&0x7C)>>2]<<(i&0x1F);break;case 1:N[ee+(i>>19&0x7C)>>2]=N[ee+(i>>14&0x7C)>>2]>>>(i&0x1F);break;case 2:N[ee+(i>>19&0x7C)>>2]=N[ee+(i>>14&0x7C)>>2]>>(i&0x1F);break;default:a(R|0);n();break}break;case 0x2F:p=i<<16>>16;switch(i>>21&0x1F){case 0x0:Qe=(N[ee+(i>>14&0x7C)>>2]|0)==(p|0);break;case 0x1:Qe=(N[ee+(i>>14&0x7C)>>2]|0)!=(p|0);break;case 0x2:Qe=N[ee+(i>>14&0x7C)>>2]>>>0>p>>>0;break;case 0x3:Qe=N[ee+(i>>14&0x7C)>>2]>>>0>=p>>>0;break;case 0x4:Qe=N[ee+(i>>14&0x7C)>>2]>>>0<p>>>0;break;case 0x5:Qe=N[ee+(i>>14&0x7C)>>2]>>>0<=p>>>0;break;case 0xa:Qe=(N[ee+(i>>14&0x7C)>>2]|0)>(p|0);break;case 0xb:Qe=(N[ee+(i>>14&0x7C)>>2]|0)>=(p|0);break;case 0xc:Qe=(N[ee+(i>>14&0x7C)>>2]|0)<(p|0);break;case 0xd:Qe=(N[ee+(i>>14&0x7C)>>2]|0)<=(p|0);break;default:a(R|0);n();break}break;case 0x30:p=i&0x7FF|i>>10&0xF800;Ct(N[ee+(i>>14&0x7C)>>2]|p,N[ee+(i>>9&0x7C)>>2]|0);if((Z|0)==0){Z=J;if(X[($<<15)+_e>>2]&1<<28)break;return e|0}else if((Z&1<<$)==0){ht()}break;case 0x32:x=i>>14&0x7C;m=i>>9&0x7C;v=i>>19&0x7C;switch(i&0xFF){case 0x0:V[ee+v>>2]=+V[ee+x>>2]+ +V[ee+m>>2];break;case 0x1:V[ee+v>>2]=+V[ee+x>>2]-+V[ee+m>>2];break;case 0x2:V[ee+v>>2]=+V[ee+x>>2]*+V[ee+m>>2];break;case 0x3:V[ee+v>>2]=+V[ee+x>>2]/+V[ee+m>>2];break;case 0x4:V[ee+v>>2]=+(N[ee+x>>2]|0);break;case 0x5:N[ee+v>>2]=~~+s(+V[ee+x>>2]);break;case 0x7:V[ee+v>>2]=+V[ee+v>>2]+ +V[ee+x>>2]*+V[ee+m>>2];break;case 0x8:Qe=+V[ee+x>>2]==+V[ee+m>>2];break;case 0x9:Qe=+V[ee+x>>2]!=+V[ee+m>>2];break;case 0xa:Qe=+V[ee+x>>2]>+V[ee+m>>2];break;case 0xb:Qe=+V[ee+x>>2]>=+V[ee+m>>2];break;case 0xc:Qe=+V[ee+x>>2]<+V[ee+m>>2];break;case 0xd:Qe=+V[ee+x>>2]<=+V[ee+m>>2];break;default:a(R|0);n();break}break;case 0x33:p=(i>>10&0xF800|i&0x7FF)<<16>>16;g=(N[ee+(i>>14&0x7C)>>2]|0)+p|0;if((Ie^g)>>13){k=Et(g,1)|0;if((k|0)==-1){break}Ie=g;Re=(k^g)>>13<<13}k=Re^g;Qe=(k|0)==(X[ee+Pe>>2]|0)?1|0:0|0;X[ee+Pe>>2]=-1;nt=nt&~(1<<$);if(nt)for(l=0;(l|0)<(Y|0);l=l+1|0){if((X[(l<<15)+Pe>>2]|0)==(k|0)){X[(l<<15)+Pe>>2]=-1;nt=nt&~(1<<l)}}if((Qe|0)==0){break}if((k|0)>0){X[ie+k>>2]=N[ee+(i>>9&0x7C)>>2]|0}else{c(k|0,N[ee+(i>>9&0x7C)>>2]|0)}break;case 0x35:p=(i>>10&0xF800|i&0x7FF)<<16>>16;g=(N[ee+(i>>14&0x7C)>>2]|0)+p|0;if((Ie^g)>>13){k=Et(g,1)|0;if((k|0)==-1){break}Ie=g;Re=(k^g)>>13<<13}k=Re^g;if(nt)for(l=0;(l|0)<(Y|0);l=l+1|0){if((X[(l<<15)+Pe>>2]|0)==(k|0)){X[(l<<15)+Pe>>2]=-1;nt=nt&~(1<<l)}}if((k|0)>0){X[ie+k>>2]=N[ee+(i>>9&0x7C)>>2]|0}else{c(k|0,N[ee+(i>>9&0x7C)>>2]|0)}break;case 0x36:p=(i>>10&0xF800|i&0x7FF)<<16>>16;g=(N[ee+(i>>14&0x7C)>>2]|0)+p|0;if((Ae^g)>>13){k=Et(g,1)|0;if((k|0)==-1){break}Ae=g;ye=(k^g)>>13<<13}k=ye^g;if(nt)for(l=0;(l|0)<(Y|0);l=l+1|0){if((X[(l<<15)+Pe>>2]|0)==(k&~3)){X[(l<<15)+Pe>>2]=-1;nt=nt&~(1<<l)}}if((k|0)>0){Q[ie+(k^3)|0]=N[ee+(i>>9&0x7C)>>2]|0}else{f(k|0,N[ee+(i>>9&0x7C)>>2]|0)}break;case 0x37:p=(i>>10&0xF800|i&0x7FF)<<16>>16;g=(N[ee+(i>>14&0x7C)>>2]|0)+p|0;if((je^g)>>13){k=Et(g,1)|0;if((k|0)==-1){break}je=g;Fe=(k^g)>>13<<13}k=Fe^g;if(nt)for(l=0;(l|0)<(Y|0);l=l+1|0){if((X[(l<<15)+Pe>>2]|0)==(k&~3)){X[(l<<15)+Pe>>2]=-1;nt=nt&~(1<<l)}}if((k|0)>=0){K[ie+(k^2)>>1]=N[ee+(i>>9&0x7C)>>2]}else{u(k|0,N[ee+(i>>9&0x7C)>>2]|0)}break;case 0x38:x=N[ee+(i>>14&0x7C)>>2]|0;m=N[ee+(i>>9&0x7C)>>2]|0;b=i>>19&0x7C;switch(i&0x3CF){case 0x0:N[ee+b>>2]=x+m|0;Ke=N[ee+b>>2]>>>0<x>>>0;break;case 0x1:N[ee+b>>2]=(x+m|0)+(Ke?1:0)|0;if(Ke|0){Ke=N[ee+b>>2]>>>0<=x>>>0}else{Ke=N[ee+b>>2]>>>0<x>>>0}break;case 0x2:N[ee+b>>2]=x-m;Ke=m>>>0>x>>>0;break;case 0x3:N[ee+b>>2]=x&m;break;case 0x4:N[ee+b>>2]=x|m;break;case 0x5:N[ee+b>>2]=x^m;break;case 0x8:N[ee+b>>2]=x<<(m&0x1F);break;case 0xc:N[ee+b>>2]=x<<16>>16;continue;case 0xe:N[ee+b>>2]=Qe?x:m;break;case 0x48:N[ee+b>>2]=x>>>(m&0x1F);break;case 0x4c:N[ee+b>>2]=x<<24>>24;break;case 0xf:N[ee+b>>2]=0;for(l=0;(l|0)<32;l=l+1|0){if(x&1<<l){N[ee+b>>2]=l+1;break}}break;case 0x88:N[ee+b>>2]=x>>(m&0x1F);break;case 0x10f:N[ee+b>>2]=0;for(l=31;(l|0)>=0;l=l-1|0){if(x&1<<l){N[ee+b>>2]=l+1;break}}break;case 0x306:{N[ee+b>>2]=r(x|0,m|0)|0}break;case 0x30a:Ye=(m|0)==0;if(!Ye){N[ee+b>>2]=(x>>>0)/(m>>>0)}break;case 0x309:Ye=(m|0)==0;if(!Ye){N[ee+b>>2]=(x|0)/(m|0)}break;default:a(R|0);n();break}break;case 0x39:switch(i>>21&0x1F){case 0x0:Qe=(N[ee+(i>>14&0x7C)>>2]|0)==(N[ee+(i>>9&0x7C)>>2]|0);break;case 0x1:Qe=(N[ee+(i>>14&0x7C)>>2]|0)!=(N[ee+(i>>9&0x7C)>>2]|0);break;case 0x2:Qe=N[ee+(i>>14&0x7C)>>2]>>>0>N[ee+(i>>9&0x7C)>>2]>>>0;break;case 0x3:Qe=N[ee+(i>>14&0x7C)>>2]>>>0>=N[ee+(i>>9&0x7C)>>2]>>>0;break;case 0x4:Qe=N[ee+(i>>14&0x7C)>>2]>>>0<N[ee+(i>>9&0x7C)>>2]>>>0;break;case 0x5:Qe=N[ee+(i>>14&0x7C)>>2]>>>0<=N[ee+(i>>9&0x7C)>>2]>>>0;break;case 0xa:Qe=(N[ee+(i>>14&0x7C)>>2]|0)>(N[ee+(i>>9&0x7C)>>2]|0);break;case 0xb:Qe=(N[ee+(i>>14&0x7C)>>2]|0)>=(N[ee+(i>>9&0x7C)>>2]|0);break;case 0xc:Qe=(N[ee+(i>>14&0x7C)>>2]|0)<(N[ee+(i>>9&0x7C)>>2]|0);break;case 0xd:Qe=(N[ee+(i>>14&0x7C)>>2]|0)<=(N[ee+(i>>9&0x7C)>>2]|0);break;default:a(R|0);n()}break;default:a(R|0);n();break}}return e|0}return{Init:ot,Reset:ct,InvalidateTLB:ut,Step:It,GetFlags:kt,SetFlags:gt,GetTimeToNextInterrupt:lt,ProgressTime:bt,GetTicks:xt,RaiseInterrupt:yt,ClearInterrupt:Ft,AnalyzeImage:mt}})}()}),define(function(e,t,i){!function(){var t=e("cjs!../../messagehandler"),s=e("cjs!../../utils");function r(e){this.ram=e,this.r=new Int32Array(this.ram.heap,0,136),this.f=new Float32Array(this.ram.heap,0,128),this.group0=new Int32Array(this.ram.heap,8192,8192),this.group1=new Int32Array(this.ram.heap,16384,8192),this.group2=new Int32Array(this.ram.heap,24576,8192),this.pc=0,this.nextpc=0,this.fence=0,this.ppc=0,this.delayedins_at_fence=!1,this.delayedins=!1,this.raise_interrupt=!1,this.idle=!1,this.EA=-1,this.TTMR=0,this.TTCR=0,this.PICMR=3,this.PICSR=0,this.SR_SM=!0,this.SR_TEE=!1,this.SR_IEE=!1,this.SR_DCE=!1,this.SR_ICE=!1,this.SR_DME=!1,this.SR_IME=!1,this.SR_LEE=!1,this.SR_CE=!1,this.SR_F=!1,this.SR_CY=!1,this.SR_OV=!1,this.SR_OVE=!1,this.SR_DSX=!1,this.SR_EPH=!1,this.SR_FO=!0,this.SR_SUMRA=!1,this.SR_CID=0,this.recompilepath="",this.recompilepid=-1,this.Reset()}r.prototype.Reset=function(){this.TTMR=0,this.TTCR=0,this.PICMR=3,this.PICSR=0,this.group0[4]=24,this.group0[3]=24,this.group0[6]=72,this.group0[5]=72,this.group0[0]=301989889,this.group0[1]=1561,this.ppc=0,this.Exception(256,0),this.pc=this.nextpc,this.nextpc=this.nextpc+1|0},r.prototype.InvalidateTLB=function(){},r.prototype.GetTimeToNextInterrupt=function(){return this.TTMR>>30==0?-1:(268435455&this.TTMR)-(268435455&this.TTCR)},r.prototype.GetTicks=function(){return this.TTMR>>30==0?-1:268435455&this.TTCR},r.prototype.ProgressTime=function(e){this.TTCR=this.TTCR+e&4294967295},r.prototype.AnalyzeImage=function(){this.boot_dtlb_misshandler_address=0|this.ram.int32mem[2304],this.boot_itlb_misshandler_address=0|this.ram.int32mem[2560],this.current_pgd=(4095&this.ram.int32mem[2052])<<16|65535&this.ram.int32mem[2053]|0},r.prototype.SetFlags=function(e){this.SR_SM=!!(1&e),this.SR_TEE=!!(2&e);var i=this.SR_IEE;this.SR_IEE=!!(4&e),this.SR_DCE=!!(8&e),this.SR_ICE=!!(16&e);this.SR_DME;this.SR_DME=!!(32&e);this.SR_IME;this.SR_IME=!!(64&e),this.SR_LEE=!!(128&e),this.SR_CE=!!(256&e),this.SR_F=!!(512&e),this.SR_CY=!!(1024&e),this.SR_OV=!!(2048&e),this.SR_OVE=!!(4096&e),this.SR_DSX=!!(8192&e),this.SR_EPH=!!(16384&e),this.SR_FO=!0,this.SR_SUMRA=!!(65536&e),this.SR_CID=e>>28&15,this.SR_LEE&&(t.Debug("little endian not supported"),t.Abort()),this.SR_CID&&(t.Debug("context id not supported"),t.Abort()),this.SR_EPH&&(t.Debug("exception prefix not supported"),t.Abort()),this.SR_DSX&&(t.Debug("delay slot exception not supported"),t.Abort()),this.SR_IEE&&!i&&this.CheckForInterrupt()},r.prototype.GetFlags=function(){var e=0;return e|=this.SR_SM?1:0,e|=this.SR_TEE?2:0,e|=this.SR_IEE?4:0,e|=this.SR_DCE?8:0,e|=this.SR_ICE?16:0,e|=this.SR_DME?32:0,e|=this.SR_IME?64:0,e|=this.SR_LEE?128:0,e|=this.SR_CE?256:0,e|=this.SR_F?512:0,e|=this.SR_CY?1024:0,e|=this.SR_OV?2048:0,e|=this.SR_OVE?4096:0,e|=this.SR_DSX?8192:0,e|=this.SR_EPH?16384:0,e|=this.SR_FO?32768:0,e|=this.SR_SUMRA?65536:0,e|=this.SR_CID<<28},r.prototype.CheckForInterrupt=function(){this.SR_IEE&&this.PICMR&this.PICSR&&(this.raise_interrupt=!0)},r.prototype.RaiseInterrupt=function(e,t){var i=1<<e;this.PICSR|=i,this.CheckForInterrupt()},r.prototype.ClearInterrupt=function(e,t){this.PICSR&=~(1<<e)},r.prototype.FetchAndInstantiate=function(e,i){return fetch(e).then(e=>e.arrayBuffer()).then(e=>WebAssembly.instantiate(e,i)).then(e=>{t.Debug("compiled"),this.instance=e.instance})},r.prototype.SetSPR=function(e,i){var s=2047&e,r=e>>11&31;switch(r){case 0:if(17==s&&this.SetFlags(i),20==s);else if(21==s)if(this.recompilepid=i,-1==i)this.recompilepath="";else{t.Debug("recompile pid: "+i+" path:"+this.recompilepath);var a={env:{Exception:function(e,t){this.SR_F=!!this.instance.exports.GetSR_F(),this.pc=this.instance.exports.GetPC()>>2,this.delayedins=!1,this.Exception(e,t)}.bind(this),ramp:1048576,group1p:16384,current_pgd:this.current_pgd,EXCEPT_DPF:768,memory:this.ram.memory,table:new WebAssembly.Table({initial:0,maximum:0,element:"anyfunc"}),memoryBase:0,tableBase:0}};"/usr/bin/fbdemo"==this.recompilepath&&this.FetchAndInstantiate(t.GetWorkingPath()+"/precompiled/fbdemo.wasm",a)}else 22==s&&(this.recompilepath+=String.fromCharCode(i));this.group0[s]=i;break;case 1:this.group1[s]=i;break;case 2:this.group2[s]=i;break;case 3:case 4:break;case 8:this.idle=!0;break;case 9:switch(s){case 0:this.PICMR=3|i,this.SR_IEE&&this.PICMR&this.PICSR&&(t.Debug("Error in SetSPR: Direct triggering of interrupt exception not supported?"),t.Abort());break;case 2:break;default:t.Debug("Error in SetSPR: interrupt address not supported"),t.Abort()}break;case 10:switch(s){case 0:this.TTMR=i,3!=(this.TTMR>>30&3)&&(t.Debug("Error in SetSPR: Timer mode other than continuous not supported"),t.Abort());break;case 1:this.TTCR=i;break;default:t.Debug("Error in SetSPR: Tick timer address not supported"),t.Abort()}break;default:t.Debug("Error in SetSPR: group "+r+" not found"),t.Abort()}},r.prototype.GetSPR=function(e){var i=2047&e,s=e>>11&31;switch(s){case 0:return 17==i?this.GetFlags():this.group0[i];case 1:return this.group1[i];case 2:return this.group2[i];case 8:return 0;case 9:switch(i){case 0:return this.PICMR;case 2:return this.PICSR;default:t.Debug("Error in GetSPR: PIC address unknown"),t.Abort()}break;case 10:switch(i){case 0:return this.TTMR;case 1:return this.TTCR;default:t.Debug("Error in GetSPR: Tick timer address unknown"),t.Abort()}break;default:t.Debug("Error in GetSPR: group "+s+" unknown"),t.Abort()}},r.prototype.Exception=function(e,i){var s=e|(this.SR_EPH?4026531840:0);switch(this.SetSPR(48,i),this.SetSPR(64,this.GetFlags()),this.EA=-1,this.SR_OVE=!1,this.SR_SM=!0,this.SR_IEE=!1,this.SR_TEE=!1,this.SR_DME=!1,this.fence=this.ppc,this.nextpc=s>>2,e){case 256:break;case 2560:case 1024:case 2304:case 768:case 512:case 1280:case 2048:case 3584:this.SetSPR(32,(this.pc<<2)-(this.delayedins?4:0));break;case 3072:this.SetSPR(32,4+(this.pc<<2)-(this.delayedins?4:0));break;default:t.Debug("Error in Exception: exception type not supported"),t.Abort()}this.delayedins=!1,this.delayedins_at_fence=!1,this.SR_IME=!1},r.prototype.DTLBLookup=function(e,i){if(!this.SR_DME)return e;var s=e>>13&63,r=this.group1[512|s];if(0==(1&r)||r>>19!=e>>19)return this.Exception(2304,e),-1;192&r&&(t.Debug("Error: LRU ist not supported"),t.Abort());var a=this.group1[640|s];if(this.SR_SM){if(!i&&!(256&a)||i&&!(512&a))return this.Exception(768,e),-1}else if(!i&&!(64&a)||i&&!(128&a))return this.Exception(768,e),-1;return 4294959104&a|8191&e},r.prototype.GetInstructionPointer=function(e){if(!this.SR_IME)return e;var i=e>>13&63;i&=63;var s=this.group2[512|i];if(0==(1&s)||s>>19!=e>>19)return this.Exception(2560,this.pc<<2),-1;192&s&&(t.Debug("Error: LRU ist not supported"),t.Abort());var r=this.group2[640|i];if(this.SR_SM){if(!(64&r))return this.Exception(1024,this.pc<<2),-1}else if(!(128&r))return this.Exception(1024,this.pc<<2),-1;return 4294959104&r|8191&e},r.prototype.Step=function(e,i){e|=0,i|=0;for(var r=0,a=0,n=0,o=0,c=0,h=0,u=0,d=this.r,f=this.f,p=this.ram,l=this.ram.int32mem,b=(this.group2,0),x=0,m=0,v=0;;){if(m=m-1|0,(0|this.ppc)==(0|this.fence)){if(this.delayedins_at_fence||(this.delayedins=!1),m<0&&!this.delayedins_at_fence){if(m=m+64|0,(e=e-64|0)<0)return 0;this.TTMR>>30!=0&&(x=(268435455&this.TTMR)-(268435455&this.TTCR),this.TTCR=this.TTCR+i&4294967295,x<i&&this.TTMR&1<<29&&(this.TTMR|=1<<28)),this.SR_TEE&&this.TTMR&1<<28&&(this.Exception(1280,this.group0[48]),this.pc=0|this.nextpc,this.nextpc=this.nextpc+1|0)}this.SR_IEE&&this.raise_interrupt&&(this.raise_interrupt=!1,this.Exception(2048,this.group0[48]),this.pc=0|this.nextpc,this.nextpc=this.nextpc+1|0);var g=0|this.GetInstructionPointer(this.pc<<2);if(-1==g){this.pc=0|this.nextpc,this.nextpc=this.nextpc+1|0,this.delayedins_at_fence=!1;continue}if(this.ppc=g,this.delayedins_at_fence?(this.delayedins_at_fence=!1,this.fence=this.ppc+4|0):this.fence=1+(this.ppc>>13)<<13,!this.SR_SM&&this.group0[20]==this.recompilepid&&this.instance&&!v&&this.pc<268435456){this.pc;var k=e;e=this.instance.exports.Exec(this.pc<<2,k,this.SR_F?1:0),this.SR_SM||(this.SR_F=!!this.instance.exports.GetSR_F(),this.pc=this.instance.exports.GetPC()>>2,this.nextpc=this.pc+1|0,this.fence=0|this.ppc),m=-1,v=1;continue}}switch(v=0,r=0|l[this.ppc>>2],this.ppc=this.ppc+4|0,r>>26&63){case 0:b=this.pc+(r<<6>>6),this.pc=0|this.nextpc,this.nextpc=0|b,(0|this.fence)==(0|this.ppc)?this.delayedins_at_fence=!0:this.fence=this.ppc+4|0,this.delayedins=!0;continue;case 1:b=this.pc+(r<<6>>6),d[9]=4+(this.nextpc<<2),this.pc=0|this.nextpc,this.nextpc=0|b,(0|this.fence)==(0|this.ppc)?this.delayedins_at_fence=!0:this.fence=this.ppc+4|0,this.delayedins=!0;continue;case 3:if(this.SR_F)break;b=this.pc+(r<<6>>6),this.pc=0|this.nextpc,this.nextpc=0|b,(0|this.fence)==(0|this.ppc)?this.delayedins_at_fence=!0:this.fence=this.ppc+4|0,this.delayedins=!0;continue;case 4:if(!this.SR_F)break;b=this.pc+(r<<6>>6),this.pc=0|this.nextpc,this.nextpc=0|b,(0|this.fence)==(0|this.ppc)?this.delayedins_at_fence=!0:this.fence=this.ppc+4|0,this.delayedins=!0;continue;case 5:break;case 6:o=r>>21&31,65536&r?(t.Debug("Error: macrc not supported\n"),t.Abort()):d[o]=(65535&r)<<16;break;case 8:553648128==(4294901760&r)?(t.Debug("Trap at "+s.ToHex(this.pc<<2)),this.Exception(3584,this.group0[48])):this.Exception(3072,this.group0[48]);break;case 9:this.nextpc=this.GetSPR(32)>>2,this.fence=0|this.ppc,this.SetFlags(this.GetSPR(64));break;case 17:b=d[r>>11&31]>>2,this.pc=0|this.nextpc,this.nextpc=0|b,(0|this.fence)==(0|this.ppc)?this.delayedins_at_fence=!0:this.fence=this.ppc+4|0,this.delayedins=!0;continue;case 18:b=d[r>>11&31]>>2,d[9]=4+(this.nextpc<<2)|0,this.pc=0|this.nextpc,this.nextpc=0|b,(0|this.fence)==(0|this.ppc)?this.delayedins_at_fence=!0:this.fence=this.ppc+4|0,this.delayedins=!0;continue;case 27:if(d[32]=d[r>>16&31]+(r<<16>>16),0!=(3&d[32])&&(t.Debug("Error in lwa: no unaligned access allowed"),t.Abort()),d[33]=this.DTLBLookup(d[32],!1),-1==d[33])break;this.EA=d[33],d[r>>21&31]=d[33]>0?l[d[33]>>2]:p.Read32Big(d[33]);break;case 33:if(d[32]=d[r>>16&31]+(r<<16>>16),0!=(3&d[32])&&(t.Debug("Error in lwz: no unaligned access allowed"),t.Abort()),d[33]=this.DTLBLookup(d[32],!1),-1==d[33])break;d[r>>21&31]=d[33]>0?l[d[33]>>2]:p.Read32Big(d[33]);break;case 35:if(d[32]=d[r>>16&31]+(r<<16>>16),d[33]=this.DTLBLookup(d[32],!1),-1==d[33])break;d[r>>21&31]=p.Read8Big(d[33]);break;case 36:if(d[32]=d[r>>16&31]+(r<<16>>16),d[33]=this.DTLBLookup(d[32],!1),-1==d[33])break;d[r>>21&31]=p.Read8Big(d[33])<<24>>24;break;case 37:if(d[32]=d[r>>16&31]+(r<<16>>16),d[33]=this.DTLBLookup(d[32],!1),-1==d[33])break;d[r>>21&31]=p.Read16Big(d[33]);break;case 38:if(d[32]=d[r>>16&31]+(r<<16>>16),d[33]=this.DTLBLookup(d[32],!1),-1==d[33])break;d[r>>21&31]=p.Read16Big(d[33])<<16>>16;break;case 39:a=r<<16>>16,c=d[r>>16&31],d[o=r>>21&31]=c+a,this.SR_CY=d[o]>>>0<c>>>0;break;case 40:a=r<<16>>16,c=d[r>>16&31],d[o=r>>21&31]=(c+a|0)+(this.SR_CY?1:0)|0,this.SR_CY?this.SR_CY=d[o]>>>0<=c>>>0:this.SR_CY=d[o]>>>0<c>>>0;break;case 41:d[r>>21&31]=65535&d[r>>16&31]&r;break;case 42:d[r>>21&31]=d[r>>16&31]|65535&r;break;case 43:c=d[r>>16&31],d[r>>21&31]=c^r<<16>>16;break;case 44:o=r>>21&31,c=d[r>>16&31],d[o]=c*(r<<16>>16)&4294967295;var R=65535&c,y=65535&r;d[o]=4294901760&d[o]|R*y&65535;break;case 45:d[r>>21&31]=this.GetSPR(d[r>>16&31]|65535&r);break;case 46:switch(r>>6&3){case 0:d[r>>21&31]=d[r>>16&31]<<(31&r);break;case 1:d[r>>21&31]=d[r>>16&31]>>>(31&r);break;case 2:d[r>>21&31]=d[r>>16&31]>>(31&r);break;default:t.Debug("Error: opcode 2E function not implemented"),t.Abort()}break;case 47:switch(a=r<<16>>16,r>>21&31){case 0:this.SR_F=d[r>>16&31]==a;break;case 1:this.SR_F=d[r>>16&31]!=a;break;case 2:this.SR_F=d[r>>16&31]>>>0>a>>>0;break;case 3:this.SR_F=d[r>>16&31]>>>0>=a>>>0;break;case 4:this.SR_F=d[r>>16&31]>>>0<a>>>0;break;case 5:this.SR_F=d[r>>16&31]>>>0<=a>>>0;break;case 10:this.SR_F=d[r>>16&31]>a;break;case 11:this.SR_F=d[r>>16&31]>=a;break;case 12:this.SR_F=d[r>>16&31]<a;break;case 13:this.SR_F=d[r>>16&31]<=a;break;default:t.Debug("Error: sf...i not supported yet"),t.Abort()}break;case 48:if(a=2047&r|r>>10&63488,this.SetSPR(d[r>>16&31]|a,d[r>>11&31]),this.idle&&(this.idle=!1,0==this.raise_interrupt&&!(this.TTMR&1<<28)))return this.pc=0|this.nextpc,this.nextpc=this.nextpc+1|0,0|e;break;case 50:switch(c=r>>16&31,h=r>>11&31,u=r>>21&31,255&r){case 0:f[u]=f[c]+f[h];break;case 1:f[u]=f[c]-f[h];break;case 2:f[u]=f[c]*f[h];break;case 3:f[u]=f[c]/f[h];break;case 4:f[u]=d[c];break;case 5:d[u]=f[c];break;case 7:f[u]+=f[c]*f[h];break;case 8:this.SR_F=f[c]==f[h];break;case 9:this.SR_F=f[c]!=f[h];break;case 10:this.SR_F=f[c]>f[h];break;case 11:this.SR_F=f[c]>=f[h];break;case 12:this.SR_F=f[c]<f[h];break;case 13:this.SR_F=f[c]<=f[h];break;default:t.Debug("Error: lf. function "+s.ToHex(255&r)+" not supported yet"),t.Abort()}break;case 51:if(a=(r>>10&63488|2047&r)<<16>>16,d[32]=d[r>>16&31]+a,3&d[32]&&(t.Debug("Error in swa: no aligned memory access"),t.Abort()),d[33]=this.DTLBLookup(d[32],!0),-1==d[33])break;if(this.SR_F=d[33]==this.EA,this.EA=-1,0==this.SR_F)break;d[33]>0?l[d[33]>>2]=d[r>>11&31]:p.Write32Big(d[33],d[r>>11&31]);break;case 53:if(a=(r>>10&63488|2047&r)<<16>>16,d[32]=d[r>>16&31]+a,3&d[32]&&(t.Debug("Error in sw: no aligned memory access"),t.Abort()),d[33]=this.DTLBLookup(d[32],!0),-1==d[33])break;d[33]>0?l[d[33]>>2]=d[r>>11&31]:p.Write32Big(d[33],d[r>>11&31]);break;case 54:if(a=(r>>10&63488|2047&r)<<16>>16,d[32]=d[r>>16&31]+a,d[33]=this.DTLBLookup(d[32],!0),-1==d[33])break;p.Write8Big(d[33],d[r>>11&31]);break;case 55:if(a=(r>>10&63488|2047&r)<<16>>16,d[32]=d[r>>16&31]+a,d[33]=this.DTLBLookup(d[32],!0),-1==d[33])break;p.Write16Big(d[33],d[r>>11&31]);break;case 56:switch(c=d[r>>16&31],h=d[r>>11&31],o=r>>21&31,975&r){case 0:d[o]=c+h,this.SR_CY=d[o]>>>0<c>>>0;break;case 1:d[o]=c+h+(this.SR_CY?1:0),this.SR_CY?this.SR_CY=d[o]>>>0<=c>>>0:this.SR_CY=d[o]>>>0<c>>>0;break;case 2:d[o]=c-h,this.SR_CY=h>>>0>c>>>0;break;case 3:d[o]=c&h;break;case 4:d[o]=c|h;break;case 5:d[o]=c^h;break;case 8:d[o]=c<<(31&h);break;case 12:d[o]=c<<16>>16;break;case 14:d[o]=this.SR_F?c:h;break;case 72:d[o]=c>>>(31&h);break;case 76:d[o]=c<<24>>24;break;case 15:for(d[o]=0,n=0;n<32;n++)if(c&1<<n){d[o]=n+1;break}break;case 136:d[o]=c>>(31&h);break;case 271:for(d[o]=0,n=31;n>=0;n--)if(c&1<<n){d[o]=n+1;break}break;case 774:d[o]=(0|c)*(0|h);R=65535&c,y=65535&h;d[o]=4294901760&d[o]|R*y&65535;break;case 778:this.SR_OV=0==h,this.SR_OV||(d[o]=(c>>>0)/(h>>>0));break;case 777:this.SR_OV=0==h,this.SR_OV||(d[o]=c/h);break;default:t.Debug("Error: op38 opcode not supported yet"),t.Abort()}break;case 57:switch(r>>21&31){case 0:this.SR_F=d[r>>16&31]==d[r>>11&31];break;case 1:this.SR_F=d[r>>16&31]!=d[r>>11&31];break;case 2:this.SR_F=d[r>>16&31]>>>0>d[r>>11&31]>>>0;break;case 3:this.SR_F=d[r>>16&31]>>>0>=d[r>>11&31]>>>0;break;case 4:this.SR_F=d[r>>16&31]>>>0<d[r>>11&31]>>>0;break;case 5:this.SR_F=d[r>>16&31]>>>0<=d[r>>11&31]>>>0;break;case 10:this.SR_F=d[r>>16&31]>d[r>>11&31];break;case 11:this.SR_F=d[r>>16&31]>=d[r>>11&31];break;case 12:this.SR_F=d[r>>16&31]<d[r>>11&31];break;case 13:this.SR_F=d[r>>16&31]<=d[r>>11&31];break;default:t.Debug("Error: sf.... function supported yet"),t.Abort()}break;default:t.Debug("Error: Instruction with opcode "+s.ToHex(r>>>26)+" not supported"),t.Abort()}this.oldpc=0|this.pc,this.pc=0|this.nextpc,this.nextpc=this.nextpc+1|0}return 0},i.exports=r}()}),define("cjs!jor1k/worker/or1k/index",["require","exports","module","cjs!../messagehandler","cjs!../utils","cjs!../imul","cjs!./fastcpu","cjs!./safecpu","cjs!./smpcpu","cjs!./dynamic/dynamiccpu"],function(e,t,i){!function(){var t=e("cjs!../messagehandler"),s=e("cjs!../utils").ToHex,r=e("cjs!../imul"),a=e("cjs!./fastcpu"),n=e("cjs!./safecpu"),o=e("cjs!./smpcpu"),c=e("cjs!./dynamic/dynamiccpu"),h=null,u=null,d={Int32Array:Int32Array,Float32Array:Float32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array,Math:Math};function f(e,i,s,n){var c={DebugMessage:t.Debug,abort:t.Abort,imul:Math.imul||r,Read32:i.Read32Big.bind(i),Write32:i.Write32Big.bind(i),Read16:i.Read16Big.bind(i),Write16:i.Write16Big.bind(i),Read8:i.Read8Big.bind(i),Write8:i.Write8Big.bind(i)};return"asm"===e?(null===h&&(h=a(d,c,s)).Init(),h):"smp"===e?(null===u&&(u=o(d,c,s)).Init(n),u):void 0}function p(e,t,i,s){return this.cpu=function(e,t,i,s){var r=null;if("safe"===e)return new n(t);if("dynamic"===e)return new c(t);if("asm"===e)return(r=f(e,t,i,s)).Init(),r;if("smp"===e)return(r=f(e,t,i,s)).Init(s),r;throw new Error("invalid CPU name:"+e)}(e,t,i,s),this.name=e,this.ncores=s,this.ram=t,this.heap=i,this.littleendian=!1,this}p.prototype.toString=function(){var e=new Uint32Array(this.heap),t="";t+="Current state of the machine\n",t+="PC: "+s(this.cpu.pc<<2)+"\n",t+="next PC: "+s(this.cpu.nextpc<<2)+"\n";for(var i=0;i<32;i+=4)t+="   r"+(i+0)+": "+s(e[i+0])+"   r"+(i+1)+": "+s(e[i+1])+"   r"+(i+2)+": "+s(e[i+2])+"   r"+(i+3)+": "+s(e[i+3])+"\n";return this.cpu.delayedins&&(t+="delayed instruction\n"),this.cpu.SR_SM?t+="Supervisor mode\n":t+="User mode\n",this.cpu.SR_TEE&&(t+="tick timer exception enabled\n"),this.cpu.SR_IEE&&(t+="interrupt exception enabled\n"),this.cpu.SR_DME&&(t+="data mmu enabled\n"),this.cpu.SR_IME&&(t+="instruction mmu enabled\n"),this.cpu.SR_LEE&&(t+="little endian enabled\n"),this.cpu.SR_CID&&(t+="context id enabled\n"),this.cpu.SR_F&&(t+="flag set\n"),this.cpu.SR_CY&&(t+="carry set\n"),this.cpu.SR_OV&&(t+="overflow set\n"),t};["Reset","Step","RaiseInterrupt","Step","AnalyzeImage","GetTicks","GetTimeToNextInterrupt","ProgressTime","ClearInterrupt"].forEach(function(e){p.prototype[e]=function(){return this.cpu[e].apply(this.cpu,arguments)}}),i.exports=p}()}),define("cjs!jor1k/worker/dev/uart",["require","exports","module","cjs!../messagehandler","cjs!../utils"],function(e,t,i){!function(){var t=e("cjs!../messagehandler"),s=(e("cjs!../utils"),["DataTerminalReady","RTS","AuxOut1","AuxOut2","Loopback","Autoflow"]),r=["FIFO enable","Reset","XMIT-FIFO-Reset","DMA-Mode","Reserved","Reserved","RecrTrig(LSB)","RecrTrig(MSB)"],a=["WordLen","WordLen","StopBits","Parity","EvenParity","StickParity","Break","DivisorLatch"],n=["DeltaCTS","DeltaDataSetReady","DeltaRingIndicator","DeltaCarrierDetect","ClearToSend","DataSetReady","RingIndicator","CarrierDetect"],o=["RxDataAvail","OverrunErr","ParityErr","FrameErr","BreakSignal","TxEmpty","TxEmptyLine","BadRxFifoData"],c=["RxAvailableI","TxEmptyI","BreakI","MSI"];function h(e,i,s){this.intno=s,this.intdev=i,this.id=e,this.verboseuart=!1,t.Register("tty"+e,this.ReceiveChar.bind(this)),this.Reset()}h.prototype.ToBitDescription=function(e,t){for(var i=("00000000"+(e&=255).toString(2)).substr(-8)+":",s=0;s<t.length;s++)i+=" "+t[s]+":"+(e>>s&1);return i},h.prototype.Reset=function(){this.LCR=3,this.LSR=96,this.MSR=176,this.ints=0,this.IIR=1,this.IER=0,this.DLL=0,this.DLH=0,this.FCR=0,this.MCR=0,this.rxbuf=new Array,this.txbuf=new Array},h.prototype.Step=function(){0!=this.txbuf.length&&(t.Send("tty"+this.id,this.txbuf),this.txbuf=new Array)},h.prototype.ReceiveChar=function(e){e.forEach(function(e){this.rxbuf.push(255&e)}.bind(this)),this.verboseuart&&t.Debug("Received bytes: "+this.rxbuf.length),this.rxbuf.length>0&&(this.LSR|=1,this.ThrowInterrupt(12))},h.prototype.CheckInterrupt=function(){this.verboseuart&&t.Debug("Check Interrupt "+this.ints),30&this.LSR&&4&this.IER?(this.IIR=6,this.verboseuart&&t.Debug("IIR_RLSI "+this.intno),this.intdev.RaiseInterrupt(this.intno)):4096&this.ints&&1&this.IER?(this.IIR=12,this.verboseuart&&t.Debug("IIR_CTI "+this.intno),this.intdev.RaiseInterrupt(this.intno)):4&this.ints&&2&this.IER?(this.IIR=2,this.verboseuart&&t.Debug("IIR_THRI "+this.intno),this.intdev.RaiseInterrupt(this.intno)):1&this.ints&&8&this.IER?(this.IIR=0,this.verboseuart&&t.Debug("IIR_MSI "+this.intno),this.intdev.RaiseInterrupt(this.intno)):(this.IIR=1,this.verboseuart&&t.Debug("IIR_NO_INT "+this.intno),this.intdev.ClearInterrupt(this.intno))},h.prototype.ThrowInterrupt=function(e){this.ints|=1<<e,this.CheckInterrupt()},h.prototype.ClearInterrupt=function(e){this.ints&=~(1<<e),this.CheckInterrupt()},h.prototype.ReadReg8=function(e){if(128&this.LCR)switch(e){case 0:return this.DLL;case 1:return this.DLH}switch(e){case 0:var i=0;return this.rxbuf.length>0&&(i=this.rxbuf.shift()),this.verboseuart&&t.Debug("Get RXBUF"),0==this.rxbuf.length&&(this.LSR&=-2,this.ClearInterrupt(12)),255&i;case 1:return 15&this.IER;case 6:i=this.MSR;return this.MSR&=240,this.verboseuart&&t.Debug("Get UART_MSR "+this.ToBitDescription(i,n)),i;case 2:i=15&this.IIR|192;return 2==this.IIR&&this.ClearInterrupt(2),i;case 3:return this.LCR;case 5:return this.verboseuart&&t.Debug("Get UART_LSR "+this.ToBitDescription(this.LSR,o)),this.LSR;default:t.Debug("Error in ReadRegister: not supported"),t.Abort()}},h.prototype.WriteReg8=function(e,i){if(i&=255,128&this.LCR)switch(e){case 0:return void(this.DLL=i);case 1:return void(this.DLH=i)}switch(e){case 0:this.LSR&=-65,this.LSR&=-33,this.txbuf.push(i),this.verboseuart&&t.Debug("send "+i),this.LSR|=96,this.ThrowInterrupt(2);break;case 1:this.IER=15&i,this.ints&=-5,this.verboseuart&&t.Debug("Set UART_IER "+this.ToBitDescription(i,c)),this.CheckInterrupt();break;case 2:this.verboseuart&&t.Debug("Set UART_FCR "+this.ToBitDescription(i,r)),this.FCR=201&i,2&i&&(this.ClearInterrupt(12),this.rxbuf=new Array),4&i&&(this.txbuf=new Array,this.ClearInterrupt(2));break;case 3:this.verboseuart&&t.Debug("Set UART_LCR "+this.ToBitDescription(i,a)),3!=(3&this.LCR)&&t.Debug("Warning in UART: Data word length other than 8 bits are not supported"),this.LCR=i;break;case 4:this.verboseuart&&t.Debug("Set UART_MCR "+this.ToBitDescription(i,s)),this.MCR=i;break;default:t.Debug("Error in WriteRegister: not supported"),t.Abort()}},i.exports=h}()}),define("cjs!jor1k/worker/dev/irq",["require","exports","module","cjs!../messagehandler","cjs!../utils"],function(e,t,i){!function(){var t=e("cjs!../messagehandler"),s=e("cjs!../utils");function r(e){this.intdev=e,this.regs=new Uint32Array(64),this.Reset()}r.prototype.Reset=function(){for(var e=0;e<64;e++)this.regs[e]=0},r.prototype.ReadReg32=function(e){return(e>>=2)>64?(t.Debug("IRQDev: Unknown ReadReg32: "+s.ToHex(e)),0):this.regs[e]},r.prototype.WriteReg32=function(e,i){if((e>>=2)>64)t.Debug("IRQDev: unknown  WriteReg32: "+s.ToHex(e)+": "+s.ToHex(i));else{var r=e>>1;if(1&e)t.Debug("Error in IRQDev: Write STAT of CPU "+r+" : "+s.ToHex(i));else{this.regs[e]=i;var a=65535&i,n=i>>16&16383,o=i>>30&3;if(1&o){if(n==r&&t.Debug("Warning in IRQDev: Try to raise its own IRQ"),this.regs[1+(n<<1)]&1<<30){t.Debug("Warning in IRQDev: CPU "+r+" raised irq on cpu "+n+" without previous acknowledge");var c=new Int32Array(this.intdev.heap);t.Debug("The pc of cpu "+n+" is "+s.ToHex(c[292+(n<<15)>>2])),t.Debug("The IEE flag of cpu "+n+" is "+(4&c[288+(n<<15)>>2])),t.Debug("r9 of cpu "+n+" is "+s.ToHex(c[36+(n<<15)>>2]))}this.regs[1+(n<<1)]=1<<30|(16383&r)<<16|a,this.intdev.RaiseSoftInterrupt(1,n)}2&o&&(this.regs[e+1]&=~(1<<30),this.intdev.ClearSoftInterrupt(1,r))}}},i.exports=r}()}),define("cjs!jor1k/worker/dev/timer",["require","exports","module","cjs!../messagehandler"],function(e,t,i){!function(){var t=e("cjs!../messagehandler");function s(){this.Reset()}s.prototype.Reset=function(){this.sync=0},s.prototype.ReadReg32=function(e){return this.sync},s.prototype.WriteReg32=function(e,i){t.Debug("Error in Timer: Write reg "+e+" : "+i)},i.exports=s}()}),define("cjs!jor1k/worker/dev/framebuffer",["require","exports","module","cjs!../utils","cjs!../messagehandler"],function(e,t,i){!function(){var t=e("cjs!../utils"),s=e("cjs!../messagehandler");function r(e){this.ram=e,this.width=640,this.height=400,this.addr=16e6,this.n=this.width*this.height>>1,this.buffer=new Int32Array(this.n),s.Register("GetFB",this.OnGetFB.bind(this))}r.prototype.Reset=function(){},r.prototype.ReadReg32=function(e){return 0},r.prototype.WriteReg32=function(e,i){switch(e){case 20:this.addr=t.Swap32(i);break;default:return}},r.prototype.OnGetFB=function(){s.Send("GetFB",this.GetBuffer())},r.prototype.GetBuffer=function(){var e=0,t=this.buffer.length,i=this.buffer,s=this.ram.int32mem,r=this.addr>>2;for(e=0;e<t;++e)i[e]=s[r+e];return this.buffer},i.exports=r}()}),define("cjs!jor1k/worker/dev/ethmac",["require","exports","module","cjs!../messagehandler","cjs!../utils"],function(e,t,i){!function(){var t=e("cjs!../messagehandler"),s=(e("cjs!../utils"),0),r=4,a=8,n=12,o=16,c=20,h=24,u=28,d=32,f=36,p=40,l=44,b=48,x=52,m=56,v=60,g=64,k=68,R=72,y=76,F=80,C=1024,S=2047,w=0,D=1,T=2,E=3,I=4,A=25;i.exports=function(e,i,j){this.ram=e,this.intdev=i,this.TransmitCallback=function(e){},this.toTxStat=function(e){return{LEN:e>>>16,RD:e>>>15&1,IRQ:e>>>14&1,WR:e>>>13&1,PAD:e>>>12&1,CRC:e>>>11&1,UR:e>>>8&1,RTRY:e>>>4&15,RL:e>>>3&1,LC:e>>>2&1,DF:e>>>1&1,CS:1&e}},this.fromTxStat=function(e){var t=e.LEN<<16;return t|=(1&e.RD)<<15,t|=(1&e.IRQ)<<14,t|=(1&e.WR)<<13,t|=(1&e.PAD)<<12,t|=(1&e.CRC)<<11,t|=(1&e.UR)<<8,t|=(15&e.RTRY)<<4,t|=(1&e.RL)<<3,t|=(1&e.LC)<<2,t|=(1&e.CDF)<<1,t|=1&e.CS},this.toRxStat=function(e){return{LEN:e>>>16,E:e>>>15&1,IRQ:e>>>14&1,WR:e>>>13&1,CF:e>>>8&1,M:e>>>7&1,OR:e>>>6&1,IS:e>>>5&1,DN:e>>>4&1,TL:e>>>3&1,SF:e>>>2&1,CRC:e>>>1&1,LC:1&e}},this.fromRxStat=function(e){var t=e.LEN<<16;return t|=(1&e.E)<<15,t|=(1&e.IRQ)<<14,t|=(1&e.WR)<<13,t|=(1&e.CF)<<8,t|=(1&e.M)<<7,t|=(1&e.OR)<<6,t|=(1&e.IS)<<5,t|=(1&e.DN)<<4,t|=(1&e.TL)<<3,t|=(1&e.SF)<<2,t|=(1&e.CRC)<<1,t|=1&e.LC},this.makeCRCTable=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var s=0;s<8;s++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t},this.crcTable=this.makeCRCTable(),this.crc32=function(e,t,i){var s=-1,r=4;e instanceof Uint16Array||e instanceof Int16Array?r=2:(e instanceof Uint8Array||e instanceof Int8Array)&&(r=1),i||(i=e.length),t||(t=0);for(var a=0,n=t;n<i;n++)a=255&e[n],s=s>>>8^this.crcTable[255&(s^a)],r>1&&(a=e[n]>>>8&255,s=s>>>8^this.crcTable[255&(s^a)],r>2&&(a=e[n]>>>16&255,s=s>>>8^this.crcTable[255&(s^a)],a=e[n]>>>24&255,s=s>>>8^this.crcTable[255&(s^a)]));return(-1^s)>>>0},this.Reset=function(){this.MODER=40960,this.INT_SOURCE=0,this.INT_MASK=0,this.IPGT=18,this.IPGR1=12,this.IPGR2=18,this.PACKETLEN=4195840,this.COLLCONF=983103,this.TX_BD_NUM=64,this.CTRLMODER=0,this.MIIMODER=100,this.MIICOMMAND=0,this.MIIADDRESS=0,this.MIITX_DATA=0,this.MIIRX_DATA=34,this.MIISTATUS=0,this.MAC_ADDR0|=Math.floor(256*Math.random())<<24,this.MAC_ADDR0|=Math.floor(256*Math.random())<<16,this.MAC_ADDR0|=Math.floor(256*Math.random())<<8,this.MAC_ADDR0|=Math.floor(256*Math.random()),this.MAC_ADDR1|=Math.floor(256*Math.random())<<8&254|2,this.MAC_ADDR1|=Math.floor(256*Math.random()),this.ETH_HASH0_ADR=0,this.ETH_HASH1_ADR=0,this.ETH_TXCTRL=0,this.BD=new Uint32Array(256);for(var e=0;e<256;e++)this.BD[e]=0;this.MIIregs=new Uint16Array(16),this.MIIregs[w]=256,this.MIIregs[D]=30756,this.MIIregs[T]=8192,this.MIIregs[E]=23696,this.MIIregs[I]=481,this.MIIregs[A]=0,this.currRX=this.TX_BD_NUM<<1},this.Receive=function(t){if(0!=(1&this.MODER)){var i=new Uint8Array(t),s=!1,r=!1,a=!1,n=0,o=0;n|=i[2]<<24,n|=i[3]<<16,n|=i[4]<<8,n|=i[5],o|=i[0]<<8,o|=i[1],n==this.MAC_ADDR0&&o==this.MAC_ADDR1?r=!0:32768&o&&(a=!0),32&this.MODER&&(s=!0);var c=this.currRX;if(s||a||r){if(32768&this.BD[c]){var h=this.toRxStat(this.BD[c]);r||a||!s||(h.M=1),h.DN=0,i.length>(65535&this.PACKETLEN)&&16384&this.MODER?h.TL=1:h.TL=0,0==h.DN&&(h.CRC=0),i[i.length-4],i[i.length-3],i[i.length-2],i[i.length-1],h.LEN=i.length,h.LEN>(65535&this.PACKETLEN)&&(h.LEN=65535&this.PACKETLEN);for(var u=this.BD[c+1],d=0;d<h.LEN;d++)e.Write8(u+d,i[d]);h.LEN+=4,h.E=0,this.BD[c]=this.fromRxStat(h),h.IRQ&&(this.INT_SOURCE|=4,this.INT_MASK&this.INT_SOURCE?this.intdev.RaiseInterrupt(4):this.intdev.ClearInterrupt(4))}else this.INT_SOURCE|=16,this.INT_MASK&this.INT_SOURCE?this.intdev.RaiseInterrupt(4):this.intdev.ClearInterrupt(4);8192&this.BD[this.currRX]||this.currRX+2>=this.BD.length?this.currRX=this.TX_BD_NUM<<1:this.currRX+=2}}},this.Transmit=function(t){if(0!=(2&this.MODER)){var i=this.toTxStat(this.BD[t<<1]),s=this.BD[1+(t<<1)];if(0!=i.RD){var r=i.LEN;i.CRC||this.MODER,(i.PAD||32768&this.MODER)&&this.PACKETLEN>>>16>i.LEN&&(r=this.PACKETLEN>>>16);for(var a=new Uint8Array(r),n=0;n<a.length;n++)n<i.LEN?a[n]=e.Read8(s+n):a[n]=0;this.TransmitCallback(a.buffer),i.UR=0,i.RTRY=0,i.RL=0,i.LC=0,i.DF=0,i.CS=0,i.RD=0,this.BD[t<<1]=this.fromTxStat(i),this.INT_SOURCE|=1,this.INT_MASK&this.INT_SOURCE?this.intdev.RaiseInterrupt(4):this.intdev.ClearInterrupt(4)}}},this.ReadReg32=function(e){var i=0;switch(e){case s:i=this.MODER;break;case r:i=this.INT_SOURCE;break;case a:i=this.INT_MASK;break;case n:i=this.IPGT;break;case o:i=this.IPGR1;break;case c:i=this.IPGR2;break;case h:i=this.PACKETLEN;break;case u:i=this.COLLCONF;break;case d:i=this.TX_BD_NUM;break;case f:i=this.CTRLMODER;break;case p:i=this.MIIMODER;break;case l:i=this.MIICOMMAND;break;case b:i=this.MIIADDRESS;break;case x:i=this.MIITX_DATA;break;case m:i=this.MIIRX_DATA;break;case v:i=this.MIISTATUS;break;case g:i=this.MAC_ADDR0;break;case k:i=this.MAC_ADDR1;break;case R:i=this.ETH_HASH0_ADR;break;case y:i=this.ETH_HASH1_ADR;break;case F:i=this.ETH_TXCTRL;break;default:e>=C&&e<=S?i=this.BD[e-C>>>2]:t.Debug("Attempt to access ethmac register beyond 0x800")}return i},this.HandleMIICommand=function(){var e=31&this.MIIADDRESS,i=this.MIIADDRESS>>8&31;switch(this.MIICOMMAND){case 0:case 1:break;case 2:this.MIIRX_DATA=0!=e?65535:this.MIIregs[i];break;case 4:break;default:t.Debug("Error in ethmac: Unknown mii command detected")}},this.WriteReg32=function(e,i){switch(e){case s:this.MODER=i;break;case r:this.INT_SOURCE=this.INT_SOURCE&~i,this.INT_MASK&this.INT_SOURCE?this.intdev.RaiseInterrupt(4):this.intdev.ClearInterrupt(4);break;case a:this.INT_MASK=i,this.INT_MASK&this.INT_SOURCE?this.intdev.RaiseInterrupt(4):this.intdev.ClearInterrupt(4);break;case n:this.IPGT=i;break;case o:this.IPGR1=i;break;case c:this.IPGR2=i;break;case h:this.PACKETLEN=i;break;case u:this.COLLCONF=i;break;case d:this.TX_BD_NUM=i,this.currRX=i<<1;break;case f:this.CTRLMODER=i;break;case p:this.MIIMODER=i;break;case l:this.MIICOMMAND=i,this.HandleMIICommand();break;case b:this.MIIADDRESS=i;break;case x:this.MIITX_DATA=i;break;case m:this.MIIRX_DATA=i;break;case v:this.MIISTATUS=i;break;case g:this.MAC_ADDR0=i;break;case k:this.MAC_ADDR1=i;break;case R:this.ETH_HASH0_ADR=i;break;case y:this.ETH_HASH1_ADR=i;break;case F:this.ETH_TXCTRL=i;break;default:if(e>=C&&e<=S){this.BD[e-C>>>2]=i;var w=e-C>>>3;(w<<3)+C==e&&0!=(32768&i)&&w<this.TX_BD_NUM&&this.Transmit(w)}else t.Debug("Attempt to access ethmac register beyond 0x800")}},this.Reset(),t.Register("ethmac",this.Receive.bind(this))}}()}),define("cjs!jor1k/worker/dev/ata",["require","exports","module","cjs!../utils","cjs!../messagehandler"],function(e,t,i){!function(){var t=e("cjs!../utils"),s=e("cjs!../messagehandler");function r(e){this.intdev=e;var t=new ArrayBuffer(512);this.identifybuffer=new Uint16Array(t),this.Reset();t=new ArrayBuffer(65536);this.SetBuffer(t)}r.prototype.Reset=function(){this.DCR=8,this.DR=160,this.SCR=1,this.SNR=1,this.SR=64,this.FR=0,this.ER=1,this.CR=0,this.lcyl=0,this.hcyl=0,this.select=160,this.driveselected=!0,this.readbuffer=this.identifybuffer,this.readbufferindex=0,this.readbuffermax=256},r.prototype.SetBuffer=function(e){this.diskbuffer=new Uint16Array(e),this.heads=16,this.sectors=64,this.cylinders=e.byteLength/(this.heads*this.sectors*512),this.nsectors=this.heads*this.sectors*this.cylinders,this.BuildIdentifyBuffer(this.identifybuffer)},r.prototype.BuildIdentifyBuffer=function(e){for(var t=0;t<256;t++)e[t]=0;e[0]=64,e[1]=this.cylinders,e[3]=this.heads,e[4]=512*this.sectors,e[5]=512,e[6]=this.sectors,e[20]=3,e[21]=512,e[22]=4,e[27]=27247,e[28]=29233,e[29]=27437,e[30]=25705,e[31]=29547;for(t=32;t<=46;t++)e[t]=8224;e[47]=32896,e[48]=0,e[49]=512,e[51]=512,e[52]=512,e[54]=this.cylinders,e[55]=this.heads,e[56]=this.sectors,e[57]=this.nsectors>>0&65535,e[58]=this.nsectors>>16&65535,e[59]=0,e[60]=this.nsectors>>0&65535,e[61]=this.nsectors>>16&65535,e[80]=6,e[82]=16384,e[83]=16384,e[84]=16384,e[85]=16384,e[86]=0,e[87]=16384},r.prototype.ReadReg8=function(e){if(!this.driveselected)return 255;switch(e){case 4:return this.ER;case 8:return this.SNR;case 12:return this.SCR;case 16:return this.lcyl;case 20:return this.hcyl;case 24:return this.DR;case 28:return this.intdev.ClearInterrupt(15),this.SR;case 256:return this.SR;default:s.Debug("ATADev: Error in ReadRegister8: register "+t.ToHex(e)+" not supported"),s.Abort()}return 0},r.prototype.GetSector=function(){return 64&this.DR||(s.Debug("ATADev: CHS mode not supported"),s.Abort()),(15&this.DR)<<24|this.hcyl<<16|this.lcyl<<8|this.SCR},r.prototype.SetSector=function(e){64&this.DR||(s.Debug("ATADev: CHS mode not supported"),s.Abort()),this.SCR=255&e,this.lcyl=e>>8&255,this.hcyl=e>>16&255,this.DR=240&this.DR|e>>24&15},r.prototype.ExecuteCommand=function(){switch(this.CR){case 236:this.readbuffer=this.identifybuffer,this.readbufferindex=0,this.readbuffermax=256,this.SR=88,2&this.DCR||this.intdev.RaiseInterrupt(15);break;case 145:this.SR=80,this.ER=0,2&this.DCR||this.intdev.RaiseInterrupt(15);break;case 32:case 48:var e=this.GetSector();0==this.SNR&&(this.SNR=256),this.readbuffer=this.diskbuffer,this.readbufferindex=256*e,this.readbuffermax=this.readbufferindex+256,this.SR=88,this.ER=0,32==this.CR&&(2&this.DCR||this.intdev.RaiseInterrupt(15));break;case 196:case 197:e=this.GetSector();0==this.SNR&&(this.SNR=256),this.readbuffer=this.diskbuffer,this.readbufferindex=256*e,this.readbuffermax=this.readbufferindex+256*this.SNR,this.SR=88,this.ER=0,196==this.CR&&(2&this.DCR||this.intdev.RaiseInterrupt(15));break;default:s.Debug("ATADev: Command "+t.ToHex(this.CR)+" not supported"),s.Abort()}},r.prototype.WriteReg8=function(e,i){if(24==e)return this.DR=i,void(this.driveselected=!(i>>4&1));if(256==e)return!(4&i)&&4&this.DCR?(this.DR&=240,this.SR=80,this.SCR=1,this.SNR=1,this.lcyl=0,this.hcyl=0,this.ER=1,this.CR=0):4&i&&!(4&this.DCR)&&(this.ER=1,this.SR=144),void(this.DCR=i);if(this.driveselected)switch(e){case 4:this.FR=i;break;case 8:this.SNR=i;break;case 12:this.SCR=i;break;case 16:this.lcyl=i;break;case 20:this.hcyl=i;break;case 28:this.CR=i,this.ExecuteCommand();break;default:s.Debug("ATADev: Error in WriteRegister8: register "+t.ToHex(e)+" not supported (value: "+t.ToHex(i)+")"),s.Abort()}},r.prototype.ReadReg16=function(e){0!=e&&(s.Debug("ATADev: Error in ReadRegister16: register "+t.ToHex(e)+" not supported"),s.Abort());var i=t.Swap16(this.readbuffer[this.readbufferindex]);return this.readbufferindex++,this.readbufferindex>=this.readbuffermax&&(this.SR=80,32==this.CR&&this.SNR>1&&(this.SNR--,this.SetSector(this.GetSector()+1),this.readbuffermax+=256,this.SR=88,2&this.DCR||this.intdev.RaiseInterrupt(15))),i},r.prototype.WriteReg16=function(e,i){0!=e&&(s.Debug("ATADev: Error in WriteRegister16: register "+t.ToHex(e)+" not supported"),s.Abort()),this.readbuffer[this.readbufferindex]=t.Swap16(i),this.readbufferindex++,this.readbufferindex>=this.readbuffermax&&(this.SR=80,2&this.DCR||this.intdev.RaiseInterrupt(15),48==this.CR&&this.SNR>1&&(this.SNR--,this.SetSector(this.GetSector()+1),this.readbuffermax+=256,this.SR=88))},r.prototype.ReadReg32=function(e){s.Debug("ATADev: Error in ReadRegister32: register "+t.ToHex(e)+" not supported"),this.mesage.Abort()},r.prototype.WriteReg32=function(e,i){s.Debug("ATADev: Error in WriteRegister32: register "+t.ToHex(e)+" not supported"),s.Abort()},i.exports=r}()}),define("cjs!jor1k/worker/dev/rtc",["require","exports","module","cjs!../messagehandler","cjs!../utils"],function(e,t,i){!function(){var t=e("cjs!../messagehandler"),s=e("cjs!../utils");function r(e){this.intdev=e,this.Reset()}r.prototype.Reset=function(){this.ctrl=0},r.prototype.ReadReg32=function(e){switch(e){case 0:return Math.floor((new Date).getTime()/1e3);case 16:return this.ctrl;case 24:return 3049340711;case 8:case 20:return 0;default:return t.Debug("RTC: unknown ReadReg32: "+s.ToHex(e)),0}return 0},r.prototype.WriteReg32=function(e,i){switch(e){case 16:this.ctrl=i;break;default:return void t.Debug("RTC: unknown  WriteReg32: "+s.ToHex(e)+": "+s.ToHex(i))}},i.exports=r}()}),define("cjs!jor1k/worker/dev/touchscreen",["require","exports","module","cjs!../messagehandler","cjs!../utils"],function(e,t,i){!function(){var t=e("cjs!../messagehandler");e("cjs!../utils");function s(e){this.intdev=e,this.Reset(),t.Register("tsmousedown",this.onmousedown.bind(this)),t.Register("tsmouseup",this.onmouseup.bind(this)),t.Register("tsmousemove",this.onmousemove.bind(this))}s.prototype.Reset=function(){this.control=0,this.status=128,this.ispressed=!1,this.mousemovecount=0,this.fifo=0,this.fifosize=0},s.prototype.onmousedown=function(e){if(1&this.control){var t=e.x,i=e.y;this.status&=-129,this.fifosize=4,this.fifo=0,this.fifo|=(1023-t&1023)<<16,this.fifo|=1023-i&1023,this.ispressed=!0,this.intdev.RaiseInterrupt(9)}},s.prototype.onmousemove=function(e){if(1&this.control&&this.ispressed&&(this.mousemovecount++,!(3&this.mousemovecount))){var t=e.x,i=e.y;this.status&=-129,this.fifosize=4,this.fifo=0,this.fifo|=(1023-t&1023)<<16,this.fifo|=1023-i&1023,this.intdev.RaiseInterrupt(9)}},s.prototype.onmouseup=function(e){if(1&this.control){e.x,e.y;this.status&=-129,this.fifosize=0,this.fifo=1<<31,this.ispressed=!1,this.intdev.RaiseInterrupt(9)}},s.prototype.ReadReg32=function(e){switch(e){case 8:return this.control;case 0:return this.intdev.ClearInterrupt(9),this.status;case 12:return this.fifosize<=0&&(this.status|=128),this.fifosize--,this.fifo}return 0},s.prototype.WriteReg32=function(e,t){switch(e){case 8:return void(this.control=t);case 4:case 36:case 40:case 44:case 48:case 52:case 56:case 60:case 20:case 16:case 28:case 32:case 24:return}},i.exports=s}()}),define("cjs!jor1k/worker/dev/keyboard",["require","exports","module","cjs!../messagehandler"],function(e,t,i){!function(){var t=e("cjs!../messagehandler"),s=[0,0,0,0,0,0,0,0,14,15,0,0,0,28,0,0,42,29,56,119,58,0,0,0,0,0,0,1,0,0,0,0,57,104,109,107,102,105,103,106,108,0,0,0,0,110,111,0,11,2,3,4,5,6,7,8,9,10,0,39,,13,0,0,0,30,48,46,32,18,33,34,35,23,36,37,38,50,49,24,25,16,19,31,20,22,47,17,45,21,44,0,0,0,0,0,82,79,80,81,75,76,77,71,72,73,55,77,0,12,83,181,59,60,61,62,63,64,65,66,67,68,87,88,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,69,70,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,39,13,51,12,52,53,40,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,26,43,27,40,0,0,0,0,0,0,0];function r(e){this.intdev=e,t.Register("keydown",this.OnKeyDown.bind(this)),t.Register("keyup",this.OnKeyUp.bind(this)),this.Reset()}r.prototype.Reset=function(){this.key=0,this.fifo=[]},r.prototype.OnKeyDown=function(e){this.key=0|s[e.keyCode],0!=this.key&&(this.fifo.push(this.key),this.intdev.RaiseInterrupt(5))},r.prototype.OnKeyUp=function(e){this.key=s[e.keyCode],0!=this.key&&(this.key=128|this.key,this.fifo.push(this.key),this.intdev.RaiseInterrupt(5))},r.prototype.ReadReg8=function(e){var t=this.fifo.shift();return 0==this.fifo.length&&this.intdev.ClearInterrupt(5),t},i.exports=r}()}),define("cjs!jor1k/worker/dev/sound",["require","exports","module","cjs!../messagehandler","cjs!../utils"],function(e,t,i){!function(){var t=e("cjs!../messagehandler"),s=e("cjs!../utils");function r(e,i){t.Debug("Start sound"),this.intdev=e,this.ramdev=i,this.Reset()}r.prototype.Reset=function(){this.addr=0,this.status=0,this.periods=0,this.period_size=0,this.rate=22050,this.channels=1,this.offset=0,this.playing=!1,this.nextperiod=0,this.starttime=0,this.lasttotalframe=0},r.prototype.GetTimeToNextInterrupt=function(){return this.playing?1e3*this.nextperiod/this.rate:-1},r.prototype.Progress=function(){},r.prototype.Elapsed=function(){var e=new Int8Array(this.period_size),i=this.periods*this.period_size;if(1==this.format)for(var s=0;s<this.period_size;s++)e[s]=this.ramdev.uint8mem[this.addr+(this.offset++<<0^3)]-128,this.offset==i&&(this.offset=0);else for(s=0;s<this.period_size;s++)e[s]=this.ramdev.sint8mem[this.addr+1+(this.offset++<<1^3)],this.offset==i&&(this.offset=0);t.Send("sound",e)},r.prototype.ReadReg32=function(e){switch(e){case 0:return this.intdev.ClearInterrupt(7),this.Elapsed(),this.playing?1:0;case 16:return this.offset;default:return t.Debug("Sound: unknown ReadReg32: "+s.ToHex(e)),0}return 0},r.prototype.WriteReg32=function(e,i){switch(e){case 0:this.playing=!!i,this.nextperiod=this.period_size,this.starttime=s.GetMilliseconds(),this.lasttotalframe=0,this.offset=0,t.Send("sound.rate",this.rate),this.Elapsed();break;case 4:this.addr=i;break;case 8:this.periods=i;break;case 12:this.period_size=i;break;case 20:this.rate=i;break;case 24:this.channels=i;break;case 28:this.format=i;break;default:return void t.Debug("sound: unknown  WriteReg32: "+s.ToHex(e)+": "+s.ToHex(i))}},i.exports=r}()}),define("cjs!jor1k/worker/dev/virtio",["require","exports","module","cjs!../utils","cjs!./virtio/marshall","cjs!../messagehandler"],function(e,t,i){!function(){var t=e("cjs!../utils"),s=e("cjs!./virtio/marshall"),r=e("cjs!../messagehandler");function a(e,t,i,s){this.dev=s,this.dev.SendReply=this.SendReply.bind(this),this.intdev=e,this.intno=t,this.ramdev=i,this.queuenum=new Uint32Array(16),this.queueready=new Uint32Array(16),this.queuepfn=new Uint32Array(16),this.descaddr=new Uint32Array(16),this.usedaddr=new Uint32Array(16),this.availaddr=new Uint32Array(16),this.lastavailidx=new Uint32Array(16),this.version=2,this.Reset()}a.prototype.Reset=function(){this.status=0,this.intstatus=0,this.pagesize=8192,this.align=8192,this.availidx=0,this.hostfeaturewordselect=0,this.queuesel=0;for(var e=0;e<16;e++)this.queueready[e]=0,this.queuenum[e]=16,this.queuepfn[e]=0,this.descaddr[e]=0,this.usedaddr[e]=0,this.availaddr[e]=0,this.lastavailidx[e]=0},a.prototype.UpdateAddr=function(){if(1==this.version){var e=this.queuesel;if(this.descaddr[e]=this.queuepfn[e]*this.pagesize,this.availaddr[e]=this.descaddr[e]+16*this.queuenum[e],this.usedaddr[e]=this.availaddr[e]+2+2+2*this.queuenum[e]+2,this.usedaddr[e]&this.align-1){var t=~(this.align-1);this.usedaddr[e]=(this.usedaddr[e]&t)+this.align}this.lastavailidx[e]=this.ramdev.Read16Little(this.availaddr[e]+2)}},a.prototype.ReadReg8=function(e){return this.dev.configspace[e-256]},a.prototype.ReadReg16=function(e){return"little"==this.ramdev.nativeendian?this.dev.configspace[e-256+1]<<8|this.dev.configspace[e-256]:this.dev.configspace[e-256]<<8|this.dev.configspace[e-256+1]},a.prototype.WriteReg8=function(e,t){this.dev.WriteConfig(e-256,t)},a.prototype.ReadReg32=function(e){var i=0;if(e>=256)return this.dev.configspace[e-256+0]<<24|this.dev.configspace[e-256+1]<<16|this.dev.configspace[e-256+2]<<8|this.dev.configspace[e-256+3]<<0;switch(e){case 0:i=1953655158;break;case 4:i=this.version;break;case 8:i=this.dev.deviceid;break;case 12:i=4294967295;break;case 16:i=0,0==this.hostfeaturewordselect?i=this.dev.hostfeature:1==this.hostfeaturewordselect&&(i=1);break;case 52:i=this.queuenum[this.queuesel];break;case 64:i=this.queuepfn[this.queuesel];break;case 68:i=this.queueready[this.queuesel];break;case 96:i=this.intstatus;break;case 112:i=this.status;break;case 252:i=0;break;default:r.Debug("Error in VirtIODev: Attempt to read register "+t.ToHex(e)),r.Abort()}return"little"==this.ramdev.nativeendian?i:t.Swap32(i)},a.prototype.GetDescriptor=function(e,t){var i=this.descaddr[e]+16*t,r=new Uint8Array(16);!function(e,t,i,s){for(var r=0;r<s;r++)t[r]=e.Read8(i+r)}(this.ramdev,r,i,16);var a=s.Unmarshall(["d","w","h","h"],r,0);return{addr:a[0],len:a[1],flags:a[2],next:a[3]}},a.prototype.ConsumeDescriptor=function(e,t,i){var s=this.usedaddr[e]+2,r=this.ramdev.Read16Little(s);this.ramdev.Write16Little(s,r+1);var a=this.usedaddr[e]+4+8*(r&this.queuenum[e]-1);this.ramdev.Write32Little(a+0,t),this.ramdev.Write32Little(a+4,i)},a.prototype.SendReply=function(e,t){this.ConsumeDescriptor(e,t,this.dev.replybuffersize);this.ramdev.Read16Little(this.availaddr[e]);if(0==this.dev.replybuffersize)return this.intstatus=1,void this.intdev.RaiseInterrupt(this.intno);for(var i=this.GetDescriptor(e,t);0==(2&i.flags);)1&i.flags?i=this.GetDescriptor(e,i.next):(r.Debug("Error in virtiodev: Descriptor is not continuing"),r.Abort());0==(2&i.flags)&&(r.Debug("Error in virtiodev: Descriptor is not allowed to write"),r.Abort());for(var s=0,a=0;a<this.dev.replybuffersize;a++)s>=i.len&&(s=0,0==(2&(i=this.GetDescriptor(0,i.next)).flags)&&(r.Debug("Error in virtiodev: Descriptor is not allowed to write"),r.Abort())),this.ramdev.Write8(i.addr+s,this.dev.replybuffer[a]),s++;this.intstatus=1,this.intdev.RaiseInterrupt(this.intno)},a.prototype.GetDescriptorBufferSize=function(e,t){for(var i=0,s=0,a=this.GetDescriptor(e,t);4&a.flags&&(r.Debug("Error in VirtIO: Indirect descriptors not supported"),r.Abort()),2&a.flags?i+=a.len:s+=a.len,0!=(1&a.flags);)a=this.GetDescriptor(e,a.next);return{write:i,read:s}},a.prototype.WriteReg32=function(e,i){switch("big"==this.ramdev.nativeendian&&(i=t.Swap32(i)),e){case 40:this.pagesize=i,this.UpdateAddr();break;case 20:this.hostfeaturewordselect=i;break;case 36:case 32:break;case 48:this.queuesel=i;break;case 56:this.queuenum[this.queuesel]=i,this.UpdateAddr();break;case 60:this.align=i,this.pagesize=i,this.UpdateAddr();break;case 64:this.queuepfn[this.queuesel]=i,this.UpdateAddr();break;case 80:for(var s=i,a=this.ramdev.Read16Little(this.availaddr[s]+2);this.lastavailidx[s]!=a;){var n=this.lastavailidx[s]&this.queuenum[s]-1,o=this.ramdev.Read16Little(this.availaddr[i]+4+2*n),c=this.GetDescriptorBufferSize(s,o),h=this.GetDescriptor(s,o),u=function(e,t,i){return function(){t>=i.len&&(t=0,1&i.flags?i=this.GetDescriptor(e,i.next):(r.Debug("Error in virtiodev: Descriptor is not continuing"),r.Abort()));var s=this.ramdev.Read8(i.addr+t);return t++,s}.bind(this)}.bind(this)(s,0,h);this.dev.ReceiveRequest(s,o,u,c),this.lastavailidx[s]++,this.lastavailidx[s]&=65535}break;case 68:this.queueready[this.queuesel]=i;break;case 100:this.intstatus&=~i,this.intdev.ClearInterrupt(this.intno);break;case 112:switch(this.status=i,this.status){case 0:this.intdev.ClearInterrupt(this.intno),this.intstatus=0,this.Reset();break;case 1:case 3:case 7:case 11:case 15:break;case 131:r.Debug("Error: virtio device initialization failed with status "+this.status),r.Abort();case 139:r.Debug("Error: virtio device initialization failed with status "+this.status),r.Abort();break;default:r.Debug("Error in virtio status register: Unknown status "+this.status),r.Abort()}break;case 128:this.descaddr[this.queuesel]=i;break;case 132:break;case 144:this.availaddr[this.queuesel]=i,this.lastavailidx[this.queuesel]=this.ramdev.Read16Little(this.availaddr[this.queuesel]+2);break;case 148:break;case 160:this.usedaddr[this.queuesel]=i;break;case 164:break;default:r.Debug("Error in VirtIODev: Attempt to write register "+t.ToHex(e)+":"+t.ToHex(i)),r.Abort()}},i.exports=a}()}),define("cjs!jor1k/worker/dev/virtio/9p",["require","exports","module","cjs!./marshall","cjs!../../messagehandler","cjs!../../utils"],function(e,t,i){!function(){var t=e("cjs!./marshall"),s=e("cjs!../../messagehandler");e("cjs!../../utils");function r(e,t){this.fs=t,this.SendReply=function(){},this.deviceid=9,this.hostfeature=1,this.configspace=[9,0,47,100,101,118,47,114,111,111,116],this.VERSION="9P2000.L",this.BLOCKSIZE=8192,this.msize=8192,this.replybuffer=new Uint8Array(2*this.msize),this.replybuffersize=0,this.Reset()}r.prototype.Createfid=function(e,t,i){return{inodeid:e,type:t,uid:i}},r.prototype.Reset=function(){this.fids=[]},r.prototype.BuildReply=function(e,i,r){t.Marshall(["w","b","h"],[r+7,e+1,i],this.replybuffer,0),r+7>=this.replybuffer.length&&s.Debug("Error in 9p: payloadsize exceeds maximum length"),this.replybuffersize=r+7},r.prototype.SendError=function(e,i,s){var r=t.Marshall(["w"],[s],this.replybuffer,7);this.BuildReply(6,e,r)},r.prototype.ReceiveRequest=function(e,i,r){var a=t.Unmarshall2(["w","b","h"],r),n=a[0],o=a[1],c=a[2];switch(o){case 8:n=this.fs.GetTotalSize();(q=[])[0]=16914839,q[1]=this.BLOCKSIZE,q[2]=Math.floor(1073741824/q[1]),q[3]=q[2]-Math.floor(n/q[1]),q[4]=q[2]-Math.floor(n/q[1]),q[5]=this.fs.inodes.length,q[6]=1048576,q[7]=0,q[8]=256;n=t.Marshall(["w","w","d","d","d","d","d","d","w"],q,this.replybuffer,7);this.BuildReply(o,c,n),this.SendReply(0,i);break;case 112:case 12:var h=(q=t.Unmarshall2(["w","w"],r))[0],u=q[1],d=this.fids[h].inodeid,f=this.fs.GetInode(d),p=(this.fs.OpenInode(d,u),function(e,i,s,r){return function(){var a=this.fs.GetInode(e);q[0]=a.qid,q[1]=this.msize-24,t.Marshall(["Q","w"],q,this.replybuffer,7),this.BuildReply(i,s,17),this.SendReply(0,r)}.bind(this)}.bind(this)(d,o,c,i));this.fs.AddEvent(d,p);break;case 70:var l=(q=t.Unmarshall2(["w","w","s"],r))[0],b=(h=q[1],q[2]),x=(f=this.fs.CreateInode(),this.fs.GetInode(this.fids[h].inodeid));f.mode=x.mode,f.size=x.size,f.symlink=x.symlink,f.data=new Uint8Array(f.size);for(var m=0;m<f.size;m++)f.data[m]=this.fs.ReadByte(x,m);f.name=b,f.parentid=this.fids[l].inodeid,this.fs.PushInode(f),this.BuildReply(o,c,0),this.SendReply(0,i);break;case 16:h=(q=t.Unmarshall2(["w","s","s","w"],r))[0],b=q[1];var v=q[2],g=q[3];d=this.fs.CreateSymlink(b,this.fids[h].inodeid,v);(f=this.fs.GetInode(d)).uid=this.fids[h].uid,f.gid=g,t.Marshall(["Q"],[f.qid],this.replybuffer,7),this.BuildReply(o,c,13),this.SendReply(0,i);break;case 18:h=(q=t.Unmarshall2(["w","s","w","w","w","w"],r))[0],b=q[1],u=q[2];var k=q[3],R=q[4];g=q[5],d=this.fs.CreateNode(b,this.fids[h].inodeid,k,R);(f=this.fs.GetInode(d)).mode=u,f.uid=this.fids[h].uid,f.gid=g,t.Marshall(["Q"],[f.qid],this.replybuffer,7),this.BuildReply(o,c,13),this.SendReply(0,i);break;case 22:h=(q=t.Unmarshall2(["w"],r))[0],f=this.fs.GetInode(this.fids[h].inodeid),n=t.Marshall(["s"],[f.symlink],this.replybuffer,7);this.BuildReply(o,c,n),this.SendReply(0,i);break;case 72:h=(q=t.Unmarshall2(["w","s","w","w"],r))[0],b=q[1],u=q[2],g=q[3],d=this.fs.CreateDirectory(b,this.fids[h].inodeid);(f=this.fs.GetInode(d)).mode=16384|u,f.uid=this.fids[h].uid,f.gid=g,t.Marshall(["Q"],[f.qid],this.replybuffer,7),this.BuildReply(o,c,13),this.SendReply(0,i);break;case 14:h=(q=t.Unmarshall2(["w","s","w","w","w"],r))[0],b=q[1],q[2],u=q[3],g=q[4],d=this.fs.CreateFile(b,this.fids[h].inodeid);this.fids[h].inodeid=d,this.fids[h].type=1,(f=this.fs.GetInode(d)).uid=this.fids[h].uid,f.gid=g,f.mode=u,t.Marshall(["Q","w"],[f.qid,this.msize-24],this.replybuffer,7),this.BuildReply(o,c,17),this.SendReply(0,i);break;case 52:t.Marshall(["w"],[0],this.replybuffer,7),this.BuildReply(o,c,1),this.SendReply(0,i);break;case 24:h=(q=t.Unmarshall2(["w","d"],r))[0],f=this.fs.GetInode(this.fids[h].inodeid);q[0]|=4096,q[0]=q[1],q[1]=f.qid,q[2]=f.mode,q[3]=f.uid,q[4]=f.gid,q[5]=f.nlinks,q[6]=f.major<<8|f.minor,q[7]=f.size,q[8]=this.BLOCKSIZE,q[9]=Math.floor(f.size/512+1),q[10]=f.atime,q[11]=0,q[12]=f.mtime,q[13]=0,q[14]=f.ctime,q[15]=0,q[16]=0,q[17]=0,q[18]=0,q[19]=0,t.Marshall(["d","Q","w","w","w","d","d","d","d","d","d","d","d","d","d","d","d","d","d","d"],q,this.replybuffer,7),this.BuildReply(o,c,153),this.SendReply(0,i);break;case 26:h=(q=t.Unmarshall2(["w","w","w","w","w","d","d","d","d","d"],r))[0],f=this.fs.GetInode(this.fids[h].inodeid);1&q[1]&&(f.mode=q[2]),2&q[1]&&(f.uid=q[3]),4&q[1]&&(f.gid=q[4]),128&q[1]&&(f.atime=q[6]),256&q[1]&&(f.atime=q[8]),16&q[1]&&(f.atime=Math.floor((new Date).getTime()/1e3)),32&q[1]&&(f.mtime=Math.floor((new Date).getTime()/1e3)),64&q[1]&&(f.ctime=Math.floor((new Date).getTime()/1e3)),8&q[1]&&this.fs.ChangeSize(this.fids[h].inodeid,q[5]),this.BuildReply(o,c,0),this.SendReply(0,i);break;case 50:h=(q=t.Unmarshall2(["w","d"],r))[0];this.BuildReply(o,c,0),this.SendReply(0,i);break;case 40:case 116:h=(q=t.Unmarshall2(["w","d","w"],r))[0];var y=q[1],F=q[2];f=this.fs.GetInode(this.fids[h].inodeid);if(2==this.fids[h].type){f.caps.length<y+F&&(F=f.caps.length-y);for(m=0;m<F;m++)this.replybuffer[11+m]=f.caps[y+m]}else{f.size<y+F&&(F=f.size-y);for(m=0;m<F;m++)this.replybuffer[11+m]=this.fs.ReadByte(f,y+m)}t.Marshall(["w"],[F],this.replybuffer,7),this.BuildReply(o,c,4+F),this.SendReply(0,i);break;case 118:h=(q=t.Unmarshall2(["w","d","w"],r))[0],y=q[1],F=q[2];this.fs.Write(this.fids[h].inodeid,y,F,r),t.Marshall(["w"],[F],this.replybuffer,7),this.BuildReply(o,c,4),this.SendReply(0,i);break;case 74:var C=(q=t.Unmarshall2(["w","s","w","s"],r))[0],S=q[1],w=q[2],D=q[3];if(0==this.fs.Rename(this.fids[C].inodeid,S,this.fids[w].inodeid,D)){this.SendError(c,"No such file or directory",2),this.SendReply(0,i);break}this.BuildReply(o,c,0),this.SendReply(0,i);break;case 76:var T=(q=t.Unmarshall2(["w","s","w"],r))[0];b=q[1],q[2];if(-1==(o=this.fs.Search(this.fids[T].inodeid,b))){this.SendError(c,"No such file or directory",2),this.SendReply(0,i);break}if(!this.fs.Unlink(o)){this.SendError(c,"Directory not empty",39),this.SendReply(0,i);break}this.BuildReply(o,c,0),this.SendReply(0,i);break;case 100:var E=t.Unmarshall2(["w","s"],r);this.msize=E[0];n=t.Marshall(["w","s"],[this.msize,this.VERSION],this.replybuffer,7);this.BuildReply(o,c,n),this.SendReply(0,i);break;case 104:h=(q=t.Unmarshall2(["w","w","s","s","w"],r))[0];var I=q[4];this.fids[h]=this.Createfid(0,1,I);f=this.fs.GetInode(this.fids[h].inodeid);t.Marshall(["Q"],[f.qid],this.replybuffer,7),this.BuildReply(o,c,13),this.SendReply(0,i);break;case 108:(q=t.Unmarshall2(["h"],r))[0];this.BuildReply(o,c,0),this.SendReply(0,i);break;case 110:h=(q=t.Unmarshall2(["w","w","h"],r))[0];var A=q[1],j=q[2];if(0==j){this.fids[A]=this.Createfid(this.fids[h].inodeid,1,this.fids[h].uid),this.fids[A].inodeid=this.fids[h].inodeid,t.Marshall(["h"],[0],this.replybuffer,7),this.BuildReply(o,c,2),this.SendReply(0,i);break}var _=[];for(m=0;m<j;m++)_.push("s");var M=t.Unmarshall2(_,r),L=(d=this.fids[h].inodeid,y=9,0);for(m=0;m<j&&-1!=(d=this.fs.Search(d,M[m]));m++)y+=t.Marshall(["Q"],[this.fs.inodes[d].qid],this.replybuffer,y),L++,this.fids[A]=this.Createfid(d,1,this.fids[h].uid);t.Marshall(["h"],[L],this.replybuffer,7),this.BuildReply(o,c,y-7),this.SendReply(0,i);break;case 120:var q=t.Unmarshall2(["w"],r);this.fids[q[0]]&&this.fids[q[0]].inodeid>=0&&(this.fs.CloseInode(this.fids[q[0]].inodeid),this.fids[q[0]].inodeid=-1,this.fids[q[0]].type=-1),this.BuildReply(o,c,0),this.SendReply(0,i);break;case 30:h=(q=t.Unmarshall2(["w","w","s"],r))[0];var U=q[1];b=q[2];this.fids[U]=this.Createfid(this.fids[h].inodeid,-1,this.fids[h].uid);var P=0;"security.capability"==b&&(P=this.fs.PrepareCAPs(this.fids[h].inodeid),this.fids[U].type=2),t.Marshall(["d"],[P],this.replybuffer,7),this.BuildReply(o,c,8),this.SendReply(0,i);break;default:s.Debug("Error in Virtio9p: Unknown id "+o+" received"),s.Abort()}},i.exports=r}()}),define("cjs!jor1k/worker/dev/virtio/dummy",["require","exports","module","cjs!../../messagehandler","cjs!../../utils"],function(e,t,i){!function(){e("cjs!../../messagehandler"),e("cjs!../../utils");function t(e){this.configspace=[0],this.deviceid=0,this.hostfeature=0,this.Reset()}t.prototype.Reset=function(){},t.prototype.ReceiveRequest=function(e,t){},i.exports=t}()}),define("cjs!jor1k/worker/dev/virtio/input",["require","exports","module","cjs!../../messagehandler","cjs!../../utils","cjs!./marshall"],function(e,t,i){!function(){var t=e("cjs!../../messagehandler"),s=(e("cjs!../../utils"),e("cjs!./marshall"));function r(e){this.configspace=new Uint8Array(256),this.deviceid=18,this.hostfeature=0,t.Register("virtio.kbd.keydown",this.OnKeyDown.bind(this)),t.Register("virtio.kbd.keyup",this.OnKeyUp.bind(this)),this.replybuffersize=8,this.replybuffer=new Uint8Array(8),this.Reset()}r.prototype.Reset=function(){this.receivebufferdesc=new Array},r.prototype.OnKeyDown=function(e){if(0!=this.receivebufferdesc.length){var t=this.receivebufferdesc[0];this.receivebufferdesc.shift(),this.replybuffersize=8,s.Marshall(["h","h","w"],[1,e.keyCode,1],this.replybuffer,0),this.SendReply(0,t.idx)}},r.prototype.OnKeyUp=function(e){if(0!=this.receivebufferdesc.length){var t=this.receivebufferdesc[0];this.receivebufferdesc.shift(),this.replybuffersize=8,s.Marshall(["h","h","w"],[1,e.keyCode,0],this.replybuffer,0),this.SendReply(0,t.idx)}},r.prototype.WriteConfig=function(e,i){if(this.configspace[e]=i,1==e)switch(this.configspace[0]){case 0:break;case 1:this.configspace[2]=5,this.configspace[8]=86,this.configspace[9]=75,this.configspace[10]=66,this.configspace[11]=68,this.configspace[12]=0;break;case 2:this.configspace[2]=0,this.configspace[8]=0;break;case 3:case 16:this.configspace[2]=0;break;case 17:switch(this.configspace[1]){case 20:this.configspace[2]=0;break;case 1:this.configspace[2]=16,this.configspace[8]=255,this.configspace[9]=255,this.configspace[10]=255,this.configspace[11]=255,this.configspace[12]=255,this.configspace[13]=255,this.configspace[14]=255,this.configspace[15]=255,this.configspace[16]=255,this.configspace[17]=255,this.configspace[18]=255,this.configspace[19]=255,this.configspace[20]=255,this.configspace[21]=255,this.configspace[22]=255,this.configspace[22]=255;break;default:this.configspace[2]=0}break;case 18:this.configspace[2]=0,t.Debug("Virtioinput: abs_info not implemented"),t.Abort();break;default:t.Debug("Error in virtio input: Unknown config"),t.Abort()}},r.prototype.ReceiveRequest=function(e,i,s,r){if(e>=1&&(t.Debug("Error in Virtio input: Unsupported queue index"),t.Abort()),0!=e);else{for(var a=0;a<this.receivebufferdesc.length;a++)if(this.receivebufferdesc[a].idx==i)return;this.receivebufferdesc.push({idx:i,size:r})}},i.exports=r}()}),define("cjs!jor1k/worker/dev/virtio/net",["require","exports","module","cjs!../../messagehandler","cjs!../../utils","cjs!./marshall"],function(e,t,i){!function(){var t=e("cjs!../../messagehandler"),s=(e("cjs!../../utils"),e("cjs!./marshall"));function r(e){this.configspace=[0,0,0,0,0,0],this.deviceid=1,this.hostfeature=32,this.replybuffer=new Uint8Array(65550),this.replybuffersize=0;for(var i=1;i<6;i++)this.configspace[i]=Math.floor(256*Math.random());t.Register("ethmac",this.Receive.bind(this)),this.Reset()}r.prototype.Reset=function(){this.receivebufferdesc=new Array,this.receivebuffer=new Array},r.prototype.Receive=function(e){this.receivebuffer.push(e),this.HandleReceive()},r.prototype.HandleReceive=function(){if(0!=this.receivebuffer.length&&0!=this.receivebufferdesc.length){var e=new Uint8Array(this.receivebuffer[0]),i=this.receivebufferdesc[0];e.length>i.size.write&&(t.Debug("Error in VirtioNET: Received packet is larger than the next receive buffer"),t.Abort()),this.receivebuffer.shift(),this.receivebufferdesc.shift(),this.replybuffersize=e.length+12,s.Marshall(["b","b","h","h","h","h","h"],[0,0,0,0,0,0,0],this.replybuffer,0);for(var r=0;r<e.length;r++)this.replybuffer[r+12]=e[r];this.SendReply(0,i.idx)}},r.prototype.ReceiveRequest=function(e,i,r,a){if(e>1&&(t.Debug("Error in VirtioNET: Unsupported ringbuffer"),t.Abort()),0==e){for(var n=0;n<this.receivebufferdesc.length;n++)if(this.receivebufferdesc[n].idx==i)return;return this.receivebufferdesc.push({idx:i,size:a}),void this.HandleReceive()}s.Unmarshall2(["b","b","h","h","h","h","h"],r);var o=new Uint8Array(a.read-12);for(n=0;n<a.read-12;n++)o[n]=r();t.Send("ethmac",o.buffer),this.replybuffersize=0,this.SendReply(e,i)},i.exports=r}()}),define("cjs!jor1k/worker/dev/virtio/block",["require","exports","module","cjs!../../messagehandler","cjs!../../utils","cjs!./marshall"],function(e,t,i){!function(){var t=e("cjs!../../messagehandler"),s=(e("cjs!../../utils"),e("cjs!./marshall"));function r(e){this.blocks=100,this.configspace=[this.blocks>>0&255,this.blocks>>8&255,this.blocks>>16&255,0,0,0,0,0],this.deviceid=2,this.hostfeature=0,this.replybuffer=new Uint8Array(65536),this.replybuffersize=0,this.buffer=new Uint8Array(512*this.blocks),this.Reset()}r.prototype.Reset=function(){},r.prototype.ReceiveRequest=function(e,i,r,a){var n=s.Unmarshall2(["w","w","d"],r),o=n[0],c=n[2];switch(o){case 0:a.write>65536&&(t.Debug("Error in virtioblock: replybuffer too small"),t.Abort());for(var h=0;h<a.write-1;h++)this.replybuffer[h]=this.buffer[512*c+h];this.replybuffersize=a.write,this.replybuffer[a.write-1]=0,this.SendReply(0,i);break;case 1:for(h=0;h<a.read-16;h++)this.buffer[512*c+h]=r();this.replybuffersize=1,this.replybuffer[0]=0,this.SendReply(0,i);break;case 4:case 5:break;default:t.Debug("Error in VirtioBlock: Unknown request type "+o),t.Abort()}},i.exports=r}()}),define("cjs!jor1k/worker/dev/virtio/gpu",["require","exports","module","cjs!../../messagehandler","cjs!../../utils","cjs!./marshall"],function(e,t,i){!function(){var t=e("cjs!../../messagehandler"),s=e("cjs!../../utils"),r=e("cjs!./marshall");function a(e){this.configspace=[0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0],this.deviceid=16,this.hostfeature=0,this.replybuffersize=0,this.replybuffer=new Uint8Array(1024),this.Reset()}a.prototype.Reset=function(){this.resource=new Array},a.prototype.ReplyOk=function(e){r.Marshall(["w","w","d","w","w"],[4352,0,0,0,0],this.replybuffer,0),this.replybuffersize=24,this.SendReply(0,e)},a.prototype.ReceiveRequest=function(e,i,a,n){t.Debug(""),t.Debug("Virtio GPU request of ringbuffer "+e+" "+i+" "+n.read+" "+n.write),0!=e&&(t.Debug("Error in virtio gpu: queue no. "+e+" unknown"),t.Abort());var o=(b=r.Unmarshall2(["w","w","d","w","w"],a))[0],c=b[3];switch(t.Debug("type: "+o+" flags: "+b[1]+" fence: "+b[2]+" ctx_id: "+c),b[0]){case 256:r.Marshall(["w","w","d","w","w"],[4353,0,0,0,0],this.replybuffer,0);for(var h=0;h<408;h++)this.replybuffersize[h]=0;r.Marshall(["w","w","w","w","w","w"],[0,0,1024,768,1,0],this.replybuffer,24),t.Debug("get display info"),this.replybuffersize=408,this.SendReply(e,i);break;case 257:var u=(b=r.Unmarshall2(["w","w","w","w"],a))[0],d=b[2],f=b[3],p=b[1];0==u&&t.Debug("Error in virtio gpu: resource_id is 0"),this.resource[u]={valid:!0,width:d,height:f,format:p,addr:0,length:0,scanout_id:-1},t.Debug("create 2d: "+d+"x"+f+" format: "+p+" resource_id: "+b[0]),this.ReplyOk(i);break;case 258:u=(b=r.Unmarshall2(["w"],a))[0];this.resource[u].valid=!1,t.Debug("resource unref: resource_id: "+b[0]),this.ReplyOk(i);break;case 262:var l=(b=r.Unmarshall2(["w","w"],a))[1];u=b[0];t.Debug("attach backing: resource_id: "+u+" nr_entries:"+b[1]);for(h=0;h<l;h++){var b=r.Unmarshall2(["d","w","w"],a);t.Debug("attach backing: addr:"+s.ToHex(b[0])+" length: "+b[1]),this.resource[u].addr=b[0],this.resource[u].length=b[1]}this.ReplyOk(i);break;case 263:u=(b=r.Unmarshall2(["w"],a))[0];t.Debug("detach backing: resource_id: "+u),this.resource[u].addr=0,this.resource[u].length=0,this.ReplyOk(i);break;case 259:var x=(b=r.Unmarshall2(["w","w","w","w","w","w"],a))[0],m=b[1],v=(d=b[2],f=b[3],b[4]);u=b[5];t.Debug("set scanout: x: "+x+" y: "+m+" width: "+d+" height: "+f+" scanout_id: "+v+" resource_id: "+u),0!=u&&(this.resource[u].scanout_id=v),this.ReplyOk(i);break;default:t.Debug("Error in virtio gpu: Unknown type "+o),t.Abort()}},i.exports=a}()}),define("cjs!jor1k/worker/dev/virtio/console",["require","exports","module","cjs!../../messagehandler","cjs!../../utils","cjs!./marshall"],function(e,t,i){!function(){var t=e("cjs!../../messagehandler"),s=(e("cjs!../../utils"),e("cjs!./marshall"));function r(e){this.configspace=[80,0,24,0,1,0,0,0],this.deviceid=3,this.hostfeature=0,this.replybuffersize=0,this.replybuffer=new Uint8Array(8),this.Reset()}r.prototype.Receive=function(e){},r.prototype.Reset=function(){},r.prototype.ReceiveRequest=function(e,i,r,a){if(t.Debug("Virtio console request of ringbuffer "+e+" "+i+" "+a.read+" "+a.write),1==e){for(var n="",o=0;o<a.read;o++)n+=String.fromCharCode(r());t.Debug("Write: "+n),this.replybuffersize=0,this.SendReply(e,i)}if(3==e){var c=s.Unmarshall2(["w","h","h"],r),h=c[0],u=c[1],d=c[2];switch(t.Debug("virtio console: "+h+" "+u+" "+d),u){case 0:this.replybuffersize=0,this.SendReply(e,i);break;default:t.Debug("Error in virtio console: Unknown event"),t.Abort()}}},i.exports=r}()}),define("cjs!jor1k/worker/init_openrisc",["require","exports","module","cjs!./messagehandler","cjs!./utils","cjs!./or1k","cjs!./dev/uart","cjs!./dev/irq","cjs!./dev/timer","cjs!./dev/framebuffer","cjs!./dev/ethmac","cjs!./dev/ata","cjs!./dev/rtc","cjs!./dev/touchscreen","cjs!./dev/keyboard","cjs!./dev/sound","cjs!./dev/virtio","cjs!./dev/virtio/9p","cjs!./dev/virtio/dummy","cjs!./dev/virtio/input","cjs!./dev/virtio/net","cjs!./dev/virtio/block","cjs!./dev/virtio/gpu","cjs!./dev/virtio/console"],function(e,t,i){!function(){var t=e("cjs!./messagehandler"),s=(e("cjs!./utils"),e("cjs!./or1k")),r=e("cjs!./dev/uart"),a=e("cjs!./dev/irq"),n=e("cjs!./dev/timer"),o=e("cjs!./dev/framebuffer"),c=e("cjs!./dev/ethmac"),h=e("cjs!./dev/ata"),u=e("cjs!./dev/rtc"),d=e("cjs!./dev/touchscreen"),f=e("cjs!./dev/keyboard"),p=e("cjs!./dev/sound"),l=e("cjs!./dev/virtio"),b=(e("cjs!./dev/virtio/9p"),e("cjs!./dev/virtio/dummy"));e("cjs!./dev/virtio/input"),e("cjs!./dev/virtio/net"),e("cjs!./dev/virtio/block"),e("cjs!./dev/virtio/gpu"),e("cjs!./dev/virtio/console");i.exports=function(e,i){t.Debug("Init OpenRISC SoC");var x=e;try{e.cpu=new s(i.cpu,e.ram,e.heap,e.ncores)}catch(e){t.Debug("Error: failed to create CPU:"+e)}e.devices.push(e.cpu),e.irqdev=new a(x),e.timerdev=new n,e.uartdev0=new r(0,x,2),e.uartdev1=new r(1,x,3),e.ethdev=new c(e.ram,x),e.ethdev.TransmitCallback=function(e){t.Send("ethmac",e)},e.fbdev=new o(e.ram),e.atadev=new h(x),e.tsdev=new d(x),e.kbddev=new f(x),e.snddev=new p(x,e.ram),e.rtcdev=new u(x),e.virtiodummydev=new b(e.ram),e.virtiodev1=new l(x,6,e.ram,e.virtio9pdev),e.virtiodev2=new l(x,11,e.ram,e.virtiodummydev),e.virtiodev3=new l(x,12,e.ram,e.virtiodummydev),e.devices.push(e.irqdev),e.devices.push(e.timerdev),e.devices.push(e.uartdev0),e.devices.push(e.uartdev1),e.devices.push(e.ethdev),e.devices.push(e.fbdev),e.devices.push(e.atadev),e.devices.push(e.tsdev),e.devices.push(e.kbddev),e.devices.push(e.snddev),e.devices.push(e.rtcdev),e.devices.push(e.virtio9pdev),e.devices.push(e.virtiodev1),e.devices.push(e.virtiodev2),e.devices.push(e.virtiodev3),e.devices.push(e.virtiodummydev),e.ram.AddDevice(e.uartdev0,2415919104,7),e.ram.AddDevice(e.fbdev,2432696320,4096),e.ram.AddDevice(e.ethdev,2449473536,4096),e.ram.AddDevice(e.tsdev,2466250752,4096),e.ram.AddDevice(e.kbddev,2483027968,256),e.ram.AddDevice(e.uartdev1,2516582400,7),e.ram.AddDevice(e.virtiodev1,2533359616,4096),e.ram.AddDevice(e.snddev,2550136832,1024),e.ram.AddDevice(e.rtcdev,2566914048,4096),e.ram.AddDevice(e.irqdev,2583691264,4096),e.ram.AddDevice(e.timerdev,2600468480,4096),e.ram.AddDevice(e.virtiodev2,2617245696,4096),e.ram.AddDevice(e.virtiodev3,2634022912,4096),e.ram.AddDevice(e.atadev,2650800128,4096)}}()}),define("cjs!jor1k/worker/riscv/disassemble",["require","exports","module","cjs!../messagehandler","cjs!../utils"],function(e,t,i){!function(){var t=e("cjs!../messagehandler"),s=e("cjs!../utils"),r=0,a=1,n=2,o=3,c=768;i.exports.Disassemble=function(e,i,h,u){switch(t.Debug("pc="+s.ToHex(u)+" ins="+s.ToHex(e)),127&e){case 3:switch(e>>12&7){case 0:t.Debug("lb");break;case 1:t.Debug("lh");break;case 2:t.Debug("lw");break;case 4:t.Debug("lbu");break;case 5:t.Debug("lhu");break;default:t.Debug("Error in disassemble: Instruction "+s.ToHex(e)+"not found")}break;case 35:switch(e>>12&7){case 0:t.Debug("sb");break;case 1:t.Debug("sh");break;case 2:t.Debug("sw");break;default:t.Debug("Error in disassemble: Instruction "+s.ToHex(e)+"not found")}break;case 19:switch(e>>12&7){case 0:t.Debug("addi");break;case 2:t.Debug("slti");break;case 3:t.Debug("sltiu");break;case 4:t.Debug("xori");break;case 6:t.Debug("ori");break;case 7:t.Debug("andi");break;case 1:t.Debug("slli");break;case 5:0==(e>>25&127)?t.Debug("srli"):32==(e>>25&127)&&t.Debug("srai");break;default:t.Debug("Error in disassemble: Instruction "+s.ToHex(e)+"not found")}break;case 51:switch(e>>25&127){case 0:switch(e>>12&7){case 0:t.Debug("add");break;case 2:t.Debug("slt");break;case 3:t.Debug("sltu");break;case 7:t.Debug("and");break;case 6:t.Debug("or");break;case 4:t.Debug("xor");break;case 1:t.Debug("sll");break;case 5:t.Debug("srl")}break;case 32:switch(e>>12&7){case 0:t.Debug("sub");break;case 5:t.Debug("sra")}break;case 1:switch(e>>12&7){case 0:t.Debug("mul");break;case 1:t.Debug("mulh");break;case 2:t.Debug("mulhsu");break;case 3:t.Debug("mulhu");break;case 4:t.Debug("div");break;case 5:t.Debug("divu");break;case 6:t.Debug("rem");break;case 7:t.Debug("remu")}break;default:t.Debug("Error in disassemble: Instruction "+s.ToHex(e)+"not found")}break;case 55:t.Debug("Lui");break;case 23:t.Debug("auipc");break;case 111:t.Debug("jal");break;case 103:t.Debug("jalr");break;case 99:switch(e>>12&7){case 0:t.Debug("beq");break;case 1:t.Debug("bne");break;case 4:t.Debug("blt");break;case 5:t.Debug("bge");break;case 6:t.Debug("bltu");break;case 7:t.Debug("bgeu");break;default:t.Debug("Error in disassemble: Instruction "+s.ToHex(e)+"not found")}break;case 115:switch(e>>12&7){case 1:t.Debug("csrrw");break;case 2:t.Debug("csrrs");break;case 3:t.Debug("csrrc - "+s.ToHex(e));break;case 5:t.Debug("csrrwi - "+s.ToHex(e));break;case 6:t.Debug("csrrsi - "+s.ToHex(e));break;case 7:t.Debug("csrrci - "+s.ToHex(e));break;case 0:switch(e>>20&4095){case 0:switch(d=(6&h[c])>>1){case r:t.Debug("ecall PRV_U -"+s.ToHex(e));break;case a:t.Debug("ecall PRV_S -"+s.ToHex(e));break;case n:t.Debug("Not supported ecall PRV_H -"+s.ToHex(e));break;case o:t.Debug("ecall PRV_M -"+s.ToHex(e));break;default:t.Debug("Error in ecall: Don't know how to handle privilege level "+d)}break;case 1:t.Debug("ebreak - "+s.ToHex(e)+" at PC"+s.ToHex(this.pc));break;case 256:var d;if((d=(6&h[c])>>1)<a){t.Debug("Error in eret: current_privilege_level isn't allowed access");break}switch(d){case a:t.Debug("eret PRV_S -"+s.ToHex(e));break;case n:t.Debug("Not supported eret PRV_H -"+s.ToHex(e));break;case o:t.Debug("eret PRV_M -"+s.ToHex(e));break;default:t.Debug("Error in eret: Don't know how to handle privilege level "+d)}break;case 773:if(d!=o){t.Debug("Error in mrts: current_privilege_level isn't allowed access");break}t.Debug("mrts - "+s.ToHex(e));break;case 288:t.Debug("sfence.vma - "+s.ToHex(e));break;default:t.Debug("Error in disassemble: Instruction "+s.ToHex(e)+"not found")}break;default:t.Debug("Error in disassemble: Instruction "+s.ToHex(e)+"not found")}break;case 7:switch(e>>12&7){case 2:t.Debug("flw - "+s.ToHex(e));break;case 3:t.Debug("fld");break;default:t.Debug("Error in disassemble: Instruction "+s.ToHex(e)+"not found")}break;case 39:switch(e>>12&7){case 2:case 3:t.Debug("fsw");break;default:t.Debug("Error in disassemble: Instruction "+s.ToHex(e)+"not found")}break;case 83:switch(e>>25&127){case 0:t.Debug("fadd.s");break;case 4:t.Debug("fsub.s");break;case 96:t.Debug("fcvt.w.s");break;case 1:t.Debug("fadd.d");break;case 5:t.Debug("fsub.d");break;case 97:t.Debug("fcvt.w.s");break;case 120:t.Debug("fmv.s.x");break;default:t.Debug("Error in disassemble: Instruction "+s.ToHex(e)+"not found")}break;case 47:switch(e>>27&31){case 1:t.Debug("amoswap");break;case 0:t.Debug("amoadd");break;case 4:t.Debug("amoxor");break;case 12:t.Debug("amoand");break;case 8:t.Debug("amoor");break;case 16:t.Debug("amomin");break;case 20:t.Debug("amomax");break;case 24:t.Debug("amominu");break;case 28:t.Debug("amomaxu");break;case 2:t.Debug("lr.d");break;case 3:t.Debug("sc.d");break;default:t.Debug("Error in Atomic Memory Instruction "+s.ToHex(e)+"not found")}break;case 15:t.Debug("fence");break;default:t.Debug("Error in disassemble: Instruction "+s.ToHex(e)+" not found")}}}()}),define("cjs!jor1k/worker/riscv/safecpu",["require","exports","module","cjs!../messagehandler","cjs!../utils","cjs!./disassemble"],function(e,t,i){!function(){var t=e("cjs!../messagehandler"),s=e("cjs!../utils");e("cjs!./disassemble");function r(e,i){t.Debug("Initialize RISCV CPU"),this.ram=e,this.htif=i,this.r=new Int32Array(this.ram.heap,0,32),this.f=new Float64Array(this.ram.heap,128,32),this.fi=new Int32Array(this.ram.heap,128,64),this.ff=new Float32Array(this.ram.heap,0,1),this.csr=new Int32Array(this.ram.heap,8192,4096),this.Reset()}function a(e,t){return((e=0|e)&(t=0|t))/(t&~(t<<1))|0}function n(e,t,i){return(e=0|e)&~(t=0|t)|(i=0|i)*(t&~(t<<1))&t}r.prototype.Reset=function(){this.ticks=0,this.prv=3,this.csr[768]=0,this.csr[3860]=0,this.csr[769]=1073746217,this.csr[834]=0,this.amoaddr=0,this.amovalue=0,this.pc=4096},r.prototype.InvalidateTLB=function(){},r.prototype.GetTimeToNextInterrupt=function(){return 0|((0|this.csr[3137])-(0|this.ticks)|0)},r.prototype.GetTicks=function(){return 0|this.ticks},r.prototype.ProgressTime=function(e){e|=0,this.ticks=this.ticks+e|0,this.csr[3073]=0|this.ticks,(e=this.csr[3137]-this.ticks|0)<=1&&(this.csr[836]=32|this.csr[836]),this.CheckForInterrupt()},r.prototype.AnalyzeImage=function(){},r.prototype.RaiseInterrupt=function(e,t){9==e&&(this.csr[836]|=512)},r.prototype.ClearInterrupt=function(e,t){9==e&&(this.csr[836]&=-513)},r.prototype.CheckForInterrupt=function(){var e=this.csr[836]&this.csr[772],t=a(this.csr[768],8),i=this.prv<3||3==this.prv&&t?1:0,s=e&~this.csr[771]&-i;if(0==s){var r=a(this.csr[768],2),n=this.prv<1||1==this.prv&&r?1:0;s|=e&this.csr[771]&-n}s&&this.Trap(2147483648|function(e){var t=0;if(e|=0)for(;0==(1&e);)e>>=1,t++;return t}(s),this.pc,-1)},r.prototype.Trap=function(e,t,i){t|=0,i|=0;var s=e|=0,r=this.csr[770],o=0!=(s&1<<31);if(o&&(r=this.csr[771],s&=~(1<<31)),this.prv<=1&&s<32&&r>>s&1){this.pc=this.csr[261],this.csr[322]=e,this.csr[321]=t,this.csr[323]=i,c=0|n(c=0|this.csr[768],32,a(c,2)),c=0|n(c,256,this.prv),c=0|n(c,2,0),this.csr[768]=c,this.prv=1}else{var c,h=1&this.csr[773]&&o?4*s:0;this.pc=(-2&this.csr[773])+h,this.csr[833]=t,this.csr[834]=e,this.csr[835]=i,c=0|n(c=0|this.csr[768],128,a(c,8)),c=0|n(c,6144,this.prv),c=0|n(c,8,0),this.csr[768]=c,this.prv=3}this.amoaddr=0,this.amovalue=0},r.prototype.MemAccessTrap=function(e,t){switch(t){case 0:this.Trap(13,this.pc-4|0,e);break;case 1:this.Trap(15,this.pc-4|0,e);break;case 2:this.Trap(12,this.pc,e)}},r.prototype.CheckVMPrivilege=function(e,i){e|=0,i|=0;var r=1==this.prv,a=262144&this.csr[768],n=524288&this.csr[768];if(16&e){if(r&&!a)return t.Debug("Illegal access from privilege mode at pc="+s.ToHex(this.pc)+" "+i),t.Abort(),!1}else if(!r)return!1;if(!(1&e)||!(2&e)&&4&e)return!1;switch(0|i){case 2:return 8&e;case 0:return 2&e||n&&8&e;case 1:return 2&e&&4&e}t.Debug("Error in CheckVMPRivilege: unknown operation"),t.Abort()},r.prototype.TranslateVM=function(e,t){t|=0,e|=0;if(0==(this.csr[384]>>31&1)||3==this.prv)return e;var i=(4194303&this.csr[384])<<12,s=i+(e>>>22<<2),r=0|this.ram.Read32(s);if(1!=(15&r))return this.CheckVMPrivilege(r,t)?r>>10<<12|4194303&e:(this.MemAccessTrap(e,t),-1);s=(i=(4294966272&r)<<2)+((e>>12&1023)<<2);return 1==(15&(r=0|this.ram.Read32(s)))?(this.MemAccessTrap(e,t),-1):this.CheckVMPrivilege(r,t)?r>>10<<12|4095&e:(this.MemAccessTrap(e,t),-1)},r.prototype.SetCSR=function(e,i){var r=this.csr;switch(e){case 768:923648&(i^r[768])&&this.InvalidateTLB();var a=8386986;r[e]=i&~a|i&a;var n=24576==(24576&r[768]);n|=98304==(98304&r[768]),r[768]=2147483647&r[768]|(n?1:0);break;case 256:r[e]=i;a=909602;this.SetCSR(768,r[768]&~a|i&a);break;case 772:a=4778;r[772]=r[772]&~a|i&a;break;case 260:r[772]=r[772]&~r[771]|i&r[771];break;case 769:r[769]=i;break;case 836:a=34;r[836]=r[836]&~a|i&a;break;case 321:case 833:case 323:case 322:r[e]=i;break;case 3:case 770:case 771:case 832:case 320:r[e]=i;break;case 384:this.InvalidateTLB(),r[e]=-2143289345&i;break;case 261:case 773:r[e]=-4&i;break;case 774:case 262:case 1953:r[e]=i;break;case 928:case 944:r[e]=i;break;default:r[e]=i,t.Debug("Error in SetCSR: PC "+s.ToHex(this.pc)+" Address "+s.ToHex(e)+" unkown"),t.Abort()}},r.prototype.GetCSR=function(e){var i=this.csr;switch(e){case 3:return 0;case 3860:case 769:return i[e];case 260:return i[772]&i[771];case 772:return i[e];case 321:case 833:case 834:case 322:case 770:case 771:case 768:case 836:case 323:case 835:return i[e];case 256:var r=385314&i[768];return 24576!=(24576&r)&&98304!=(98304&r)||(r|=2147483648),r;case 832:case 320:case 384:return i[e];case 261:case 773:return i[e];case 774:case 262:return i[e];case 3073:return this.ticks;case 3201:return 0;case 928:case 944:return 0;case 1953:return i[e];default:return t.Debug("Error in GetCSR: PC "+s.ToHex(this.pc)+" Address "+s.ToHex(e)+" unkown"),t.Abort(),i[e]}},r.prototype.UMul64=function(e,t){var i=[0,0];if(t>>>=0,(e>>>=0)<32767&&t<65536)return i[0]=e*t,i[1]=i[0]<0?-1:0,i;var s=65535&e,r=e>>>16,a=65535&t,n=t>>>16,o=s*a,c=(o>>>16)+r*a,h=c>>>16,u=(h+=(c=(65535&c)+s*n)>>>16)>>>16;return u+=(h=(65535&h)+r*n)>>>16,i[0]=(65535&c)<<16|65535&o,i[1]=(65535&u)<<16|65535&h,i},r.prototype.IMul64=function(e,t){var i=[0,0];if(0==e)return i[0]=i[1]=0,i;if(0==t)return i[0]=i[1]=0,i;if(t|=0,(e|=0)>=-32768&&e<=32767&&t>=-32768&&t<=32767)return i[0]=e*t,i[1]=i[0]<0?-1:0,i;var s=e<0^t<0;return i=this.UMul64(Math.abs(e),Math.abs(t)),s&&(i[0]=~i[0],i[1]=~i[1],i[0]=i[0]+1|0,0==i[0]&&(i[1]=i[1]+1|0)),i},r.prototype.SUMul64=function(e,t){var i=[0,0];if(0==e)return i[0]=i[1]=0,i;if(0==t)return i[0]=i[1]=0,i;if(t>>>=0,(e|=0)>=-32768&&e<=32767&&t<65536)return i[0]=e*t,i[1]=i[0]<0?-1:0,i;var s=e<0;return i=this.UMul64(Math.abs(e),Math.abs(t)),s&&(i[0]=~i[0],i[1]=~i[1],i[0]=i[0]+1|0,0==i[0]&&(i[1]=i[1]+1|0)),i},r.prototype.Step=function(e,i){var r=this.r,o=this.fi,c=this.ff,h=this.f,u=this.csr,d=0,f=0,p=0,l=0,b=0,x=0,m=0,v=0,g=0,k=0,R=0,y=0;e|=0,i|=0;var F=0;this.n=0;do{if(r[0]=0,!(63&e)){F=u[3137]-this.ticks|0;this.ticks=this.ticks+i|0,u[3073]=0|this.ticks,F<i&&(u[836]=32|u[836]),this.CheckForInterrupt()}if(-1!=(y=0|this.TranslateVM(this.pc,2)))switch(R=this.ram.Read32(y),this.pc=this.pc+4|0,127&R){case 3:switch(f=R>>20,x=r[R>>15&31],d=R>>7&31,R>>12&7){case 0:if(-1==(y=0|this.TranslateVM(x+f|0,0)))break;r[d]=this.ram.Read8(y)<<24>>24;break;case 1:if(x+f&1){this.Trap(4,this.pc-4|0,x+f|0);break}if(-1==(y=0|this.TranslateVM(x+f|0,0)))break;r[d]=this.ram.Read16(y)<<16>>16;break;case 2:if(x+f&3){this.Trap(4,this.pc-4|0,x+f|0);break}if(-1==(y=0|this.TranslateVM(x+f|0,0)))break;y>>>0==2147524616&&(this.ram.Write32(y+0,this.htif.ReadToHost()),this.ram.Write32(y+4,this.htif.ReadDEVCMDToHost())),y>>>0==2147524608&&(this.ram.Write32(y+0,this.htif.ReadFromHost()),this.ram.Write32(y+4,this.htif.ReadDEVCMDFromHost())),r[d]=this.ram.Read32(y);break;case 4:if(-1==(y=0|this.TranslateVM(x+f|0,0)))break;r[d]=255&this.ram.Read8(y);break;case 5:if(x+f&1&&(t.Debug("Error in lhu: unaligned address"),t.Abort()),-1==(y=0|this.TranslateVM(x+f|0,0)))break;r[d]=65535&this.ram.Read16(y);break;default:t.Debug("Error in safecpu: Instruction "+s.ToHex(R)+" not found"),t.Abort()}break;case 35:switch(f=R>>25<<5|R>>7&31,x=r[R>>15&31],d=R>>20&31,R>>12&7){case 0:if(-1==(y=0|this.TranslateVM(x+f|0,1)))break;this.ram.Write8(y,255&r[d]);break;case 1:if(x+f&1){this.Trap(6,this.pc-4|0,x+f|0);break}if(-1==(y=0|this.TranslateVM(x+f|0,1)))break;this.ram.Write16(y,65535&r[d]);break;case 2:if(x+f&3){this.Trap(6,this.pc-4|0,x+f|0);break}if(-1==(y=0|this.TranslateVM(x+f|0,1)))break;this.ram.Write32(y,r[d]),y>>>0==2147524620&&(this.htif.WriteDEVCMDToHost(this.ram.Read32(y)),this.htif.WriteToHost(this.ram.Read32(y-4))),y>>>0==2147524612&&(this.htif.WriteDEVCMDFromHost(this.ram.Read32(y)),this.htif.WriteFromHost(this.ram.Read32(y-4)));break;default:t.Debug("Error in safecpu: Instruction "+s.ToHex(R)+" not found"),t.Abort()}break;case 19:switch(d=R>>7&31,x=r[R>>15&31],f=R>>20,R>>12&7){case 0:r[d]=x+f;break;case 2:r[d]=x<f?1:0;break;case 3:r[d]=x>>>0<f>>>0?1:0;break;case 4:r[d]=x^f;break;case 6:r[d]=x|f;break;case 7:r[d]=x&f;break;case 1:r[d]=x<<f;break;case 5:0==(R>>25&127)?r[d]=x>>>f:32==(R>>25&127)?r[d]=x>>f:(t.Debug("Error in safecpu: Instruction (sra, srl)"+s.ToHex(R)+" not found"),t.Abort());break;default:t.Debug("Error in safecpu: Instruction "+s.ToHex(R)+" not found"),t.Abort()}break;case 51:switch(R>>25&127){case 0:switch(x=r[R>>15&31],m=r[R>>20&31],d=R>>7&31,R>>12&7){case 0:r[d]=x+m;break;case 1:r[d]=x<<(31&m);break;case 2:r[d]=x<m?1:0;break;case 3:r[d]=x>>>0<m>>>0?1:0;break;case 4:r[d]=x^m;break;case 5:r[d]=x>>>(31&m);break;case 6:r[d]=x|m;break;case 7:r[d]=x&m}break;case 32:switch(x=r[R>>15&31],m=r[R>>20&31],d=R>>7&31,R>>12&7){case 0:r[d]=x-m;break;case 5:r[d]=x>>(31&m);break;default:t.Debug("Error in safecpu: Instruction (sub,sra) "+s.ToHex(R)+" not found"),t.Abort()}break;case 1:switch(x=0|r[R>>15&31],m=0|r[R>>20&31],d=R>>7&31,R>>12&7){case 0:var C=this.IMul64(x,m);r[d]=C[0];break;case 1:C=this.IMul64(x,m);r[d]=C[1];break;case 2:C=this.SUMul64(x,m>>>0);r[d]=C[1];break;case 3:C=this.UMul64(x>>>0,m>>>0);r[d]=C[1];break;case 4:l=0==m?-1:x/m|0,r[d]=l;break;case 5:l=0==m?-1:(x>>>0)/(m>>>0)|0,r[d]=l;break;case 6:b=0==m?0|x:x%m|0,r[d]=b;break;case 7:b=0==m?0|x:(x>>>0)%(m>>>0)|0,r[d]=b}break;default:t.Debug("Error in safecpu: Instruction "+s.ToHex(R)+" not found"),t.Abort()}break;case 55:r[d=R>>7&31]=4294963200&R;break;case 23:f=4294963200&R,r[d=R>>7&31]=this.pc+f-4|0;break;case 111:f=(R>>21&1023|(R>>20&1)<<10|(R>>12&255)<<11|R>>31<<19)<<1,r[d=R>>7&31]=this.pc,this.pc=this.pc+f-4|0;break;case 103:f=R>>20,x=r[R>>15&31],r[d=R>>7&31]=this.pc,this.pc=x+f&4294967294;break;case 99:switch(f=(R>>31<<11|(R>>25&63)<<4|R>>8&15|(R>>7&1)<<10)<<1,x=0|r[R>>15&31],m=0|r[R>>20&31],R>>12&7){case 0:x==m&&(this.pc=this.pc+f-4|0);break;case 1:x!=m&&(this.pc=this.pc+f-4|0);break;case 4:x<m&&(this.pc=this.pc+f-4|0);break;case 5:x>=m&&(this.pc=this.pc+f-4|0);break;case 6:x>>>0<m>>>0&&(this.pc=this.pc+f-4|0);break;case 7:x>>>0>=m>>>0&&(this.pc=this.pc+f-4|0);break;default:t.Debug("Error in safecpu: Instruction "+s.ToHex(R)+" not found"),t.Abort()}break;case 115:switch(f=R>>>20,x=r[R>>15&31],d=R>>7&31,R>>12&7){case 1:r[d]=this.GetCSR(f),this.SetCSR(f,x);break;case 2:r[d]=this.GetCSR(f),0!=x&&this.SetCSR(f,this.GetCSR(f)|x);break;case 3:r[d]=this.GetCSR(f),0!=x&&this.SetCSR(f,this.GetCSR(f)&~x);break;case 5:r[d]=this.GetCSR(f),p=R>>15&31,this.SetCSR(f,p>>0);break;case 6:r[d]=this.GetCSR(f),0!=(p=R>>15&31)&&this.SetCSR(f,this.GetCSR(f)|p>>0);break;case 7:r[d]=this.GetCSR(f),0!=(p=R>>15&31)&&this.SetCSR(f,this.GetCSR(f)&~(p>>0));break;case 0:switch(R>>20&4095){case 0:switch(this.prv){case 0:this.Trap(8,this.pc-4|0,-1);break;case 1:this.Trap(9,this.pc-4|0,-1);break;case 2:this.Trap(10,this.pc-4|0,-1),this.Abort();break;case 3:this.Trap(11,this.pc-4|0,-1);break;default:t.Debug("Error in ecall: Don't know how to handle privilege level "+privilege_mode),t.Abort()}break;case 1:this.Trap(3,this.pc-4|0,-1);break;case 258:if(1!=this.prv){t.Debug("Error in sret: privilege_mode isn't allowed access"),t.Abort();break}this.pc=0|u[321];var S=a(w=0|u[768],256);w=n(w,2,a(w,32)),w=n(w,32,1),w=n(w,256,0),u[768]=w,this.prv=S,this.InvalidateTLB();break;case 261:if(0==(u[772]&u[836]))return e;break;case 770:if(3!=this.prv){t.Debug("Error in mret: privilege_mode isn't allowed access"),t.Abort();break}this.pc=0|u[833];var w;S=a(w=0|u[768],6144);w=n(w,8,a(w,128)),w=n(w,128,1),w=n(w,6144,0),u[768]=w,this.prv=S,this.InvalidateTLB();break;case 288:break;default:t.Debug("Error in safecpu: Instruction "+s.ToHex(R)+" not found"),t.Abort()}break;default:t.Debug("Error in safecpu: Instruction "+s.ToHex(R)+" not found"),t.Abort()}break;case 7:switch(f=R>>20,x=r[R>>15&31],d=R>>7&31,R>>12&7){case 2:if(x+f&3&&(t.Debug("Error in flw: unaligned address"),t.Abort()),-1==(y=0|this.TranslateVM(x+f|0,0)))break;r[0]=this.ram.Read32(y),h[d]=c[0];break;case 3:if(x+f&7&&(t.Debug("Error in flw: unaligned address"),t.Abort()),-1==(y=0|this.TranslateVM(x+f|0,0)))break;o[0+(d<<1)]=this.ram.Read32(y+0),o[1+(d<<1)]=this.ram.Read32(y+4);break;default:t.Debug("Error in safecpu: Instruction "+s.ToHex(R)+" not found"),t.Abort()}break;case 39:switch(f=(R>>25<<5)+(R>>7&31),x=r[R>>15&31],d=R>>20&31,R>>12&7){case 2:if(c[0]=h[d],x+f&3&&(t.Debug("Error in fsw: unaligned address"),t.Abort()),-1==(y=0|this.TranslateVM(x+f|0,1)))break;this.ram.Write32(y,r[0]);break;case 3:if(x+f&7&&(t.Debug("Error in fsd: unaligned address"),t.Abort()),-1==(y=0|this.TranslateVM(x+f|0,1)))break;this.ram.Write32(y+0,o[0+(d<<1)]),this.ram.Write32(y+4,o[1+(d<<1)]);break;default:t.Debug("Error in safecpu: Instruction "+s.ToHex(R)+" not found"),t.Abort()}break;case 83:switch(d=R>>7&31,R>>25&127){case 0:case 1:v=h[R>>15&31],g=h[R>>20&31],h[d]=v+g;break;case 4:case 5:v=h[R>>15&31],g=h[R>>20&31],h[d]=v-g;break;case 80:case 81:switch(v=h[R>>15&31],g=h[R>>20&31],R>>12&7){case 0:r[d]=v<=g?1:0;break;case 1:r[d]=v<g?1:0;break;case 2:r[d]=v==g?1:0;break;default:t.Debug("Error in safecpu: Instruction (fcmp) "+s.ToHex(R)+" not found"),t.Abort()}break;case 32:case 33:v=h[R>>15&31],h[d]=v;break;case 96:case 97:r[d]=h[R>>15&31];break;case 104:case 105:h[d]=r[R>>15&31];break;case 8:case 9:v=h[R>>15&31],g=h[R>>20&31],h[d]=v*g;break;case 12:case 13:v=h[R>>15&31],g=h[R>>20&31],h[d]=v/g;break;case 16:case 17:switch(v=h[R>>15&31],g=h[R>>20&31],R>>12&7){case 0:h[d]=g<0?-Math.abs(v):Math.abs(v);break;case 1:h[d]=g<0?Math.abs(v):-Math.abs(v);break;case 2:h[d]=g<0&&v<0||g>0&&v>0?Math.abs(v):-Math.abs(v);break;default:t.Debug("Error in safecpu: Instruction (fsgn) "+s.ToHex(R)+" not found"),t.Abort()}break;case 120:x=r[R>>15&31],r[0]=x,h[d]=c[0];break;default:t.Debug("Error in safecpu: Instruction "+s.ToHex(R)+" not found"),t.Abort()}break;case 67:v=h[R>>15&31],g=h[R>>20&31],k=h[R>>27&31],h[d=R>>7&31]=v*g+k;break;case 71:v=h[R>>15&31],g=h[R>>20&31],k=h[R>>27&31],h[d=R>>7&31]=v*g-k;break;case 75:v=h[R>>15&31],g=h[R>>20&31],k=h[R>>27&31],h[d=R>>7&31]=-(v*g+k);break;case 79:v=h[R>>15&31],g=h[R>>20&31],k=h[R>>27&31],h[d=R>>7&31]=-(v*g-k);break;case 47:if(x=r[R>>15&31],m=r[R>>20&31],d=R>>7&31,-1==(y=0|this.TranslateVM(0|x,0)))break;switch(R>>27&31){case 1:if(r[d]=this.ram.Read32(y),-1==(y=0|this.TranslateVM(0|x,1)))break;this.ram.Write32(y,m);break;case 0:if(r[d]=this.ram.Read32(y),-1==(y=0|this.TranslateVM(0|x,1)))break;this.ram.Write32(y,r[d]+m);break;case 4:if(r[d]=this.ram.Read32(y),-1==(y=0|this.TranslateVM(0|x,1)))break;this.ram.Write32(y,r[d]^m);break;case 12:if(r[d]=this.ram.Read32(y),-1==(y=0|this.TranslateVM(0|x,1)))break;this.ram.Write32(y,r[d]&m);break;case 8:if(r[d]=this.ram.Read32(y),-1==(y=0|this.TranslateVM(0|x,1)))break;this.ram.Write32(y,r[d]|m);break;case 16:if(r[d]=this.ram.Read32(y),m>>0>r[d]>>0?r[0]=r[d]:r[0]=m,-1==(y=0|this.TranslateVM(0|x,1)))break;this.ram.Write32(y,r[0]);break;case 20:if(r[d]=this.ram.Read32(y),m<r[d]?r[0]=r[d]:r[0]=m,-1==(y=0|this.TranslateVM(x,1)))break;this.ram.Write32(y,r[0]);break;case 24:if(r[d]=this.ram.Read32(y),m>>>0>r[d]>>>0?r[0]=r[d]:r[0]=m,-1==(y=0|this.TranslateVM(x,1)))break;this.ram.Write32(y,r[0]);break;case 28:if(r[d]=this.ram.Read32(y),m>>>0<r[d]>>>0?r[0]=r[d]:r[0]=m,-1==(y=0|this.TranslateVM(x,1)))break;this.ram.Write32(y,r[0]);break;case 2:r[d]=this.ram.Read32(y),this.amoaddr=x,this.amovalue=r[d];break;case 3:if(x!=this.amoaddr){r[d]=1;break}if(this.ram.Read32(y)!=this.amovalue){r[d]=1;break}if(r[d]=0,-1==(y=0|this.TranslateVM(x,1)))break;this.ram.Write32(y,m);break;default:t.Debug("Error in Atomic Memory Instruction "+s.ToHex(R)+" not found"),t.Abort()}break;case 15:break;default:3!=(3&R)?t.Debug("Error in safecpu: Compressed Instruction "+s.ToHex(65535&R)+" not supported at "+s.ToHex(this.pc-4)):t.Debug("Error in safecpu: Instruction "+s.ToHex(R)+" not found at "+s.ToHex(this.pc-4)),t.Abort()}}while(e=e-1|0);return 0},i.exports=r}()}),define(function(e,t,i){!function(){e("cjs!../messagehandler"),e("cjs!../utils"),e("cjs!./disassemble");i.exports=((e,t,i)=>{"use asm";var s=t.DebugMessage,r=t.abort,a=t.Read32,n=t.Write32,o=t.Read16,c=t.Write16,h=t.Read8,u=t.Write8,d=t.ReadDEVCMDToHost,f=t.ReadDEVCMDFromHost,p=t.WriteDEVCMDToHost,l=t.WriteDEVCMDFromHost,b=t.ReadToHost,x=t.ReadFromHost,m=t.WriteToHost,v=t.WriteFromHost,g=t.imul,k=e.Math.abs,R=e.Math.floor,y=0,F=1,C=2,S=3,w=4,D=5,T=6,E=7,I=8,A=9,j=10,_=11,M=12,L=0x00,q=0x01,U=0x02,P=0x03,B=0,W=1,H=2,z=0x80000001,O=0x80000002,G=0x80000000,N=0x01,V=0x02,X=0x03,Q=0x05,K=0x07,Y=0x08,J=0x09,Z=0x0A,$=0x0B,ee=0x3000,te=0x2400,ie=0x4,se=0x8,re=0xC,ae=0x400,ne=0x404,oe=0x410,ce=0x484,he=0x500,ue=0x504,de=0x510,fe=0x600,pe=0x604,le=0x904,be=0xC00,xe=0xC04,me=0xC08,ve=0xC10,ge=0xC84,ke=0xD84,Re=0xD04,ye=0xD00,Fe=0xD08,Ce=0xD0C,Se=0xD10,we=0xD14,De=0x1C04,Te=0x1D04,Ee=0x1E08,Ie=0x1E0C,Ae=0x1E00,je=0x1E04,_e=0x1E40,Me=0x1E44,Le=0x2404,qe=0x2408,Ue=0x2600,Pe=0x2604,Be=0x2608,We=0x2804,He=0x3604,ze=0x2A04,Oe=0x3404,Ge=0x3508,Ne=0x350C,Ve=0x3C00,Xe=0x3C04,Qe=0x3C40,Ke=0x3200,Ye=0x3204,Je=0x3208,Ze=0x3004,$e=0x3008,et=0x300,tt=0x3300,it=0x3304,st=0x3008,rt=0x330C,at=0x3310,nt=0x3314,ot=0x3318,ct=0x331C,ht=0x3320,ut=0x3324,dt=0x3328,ft=0x332C,pt=0x3330,lt=0x33334,bt=0x33338,xt=0x3333C,mt=new e.Int32Array(i),vt=0x00,gt=new e.Float64Array(i),kt=0x80,Rt=new e.Int32Array(i),yt=0x80,Ft=new e.Float32Array(i),Ct=0x00,St=new e.Int32Array(i),wt=0x2000,Dt=new e.Int32Array(i),Tt=0x100000,Et=new e.Int8Array(i),It=new e.Int16Array(i),At=0x200,jt=0x200,_t=1,Mt=0,Lt=0,qt=0,Ut=0x200,Pt=0x200,Bt=0x200,Wt=-0x8000,Ht=-0x8000,zt=-1,Ot=-1,Gt=-1,Nt=-1,Vt=-1,Xt=-1,Qt=-1,Kt=-1,Yt=-1,Jt=-1,Zt=-1,$t=-1,ei=-1,ti=-1,ii=-1,si=-1,ri=-1,ai=-1,ni=-1,oi=-1,ci=-1,hi=-1,ui=-1,di=-1,fi=0;function pi(){li()}function li(){Mt=0;St[wt+be>>2]=0x96;St[wt+Ae>>2]=0x780;St[wt+Ve>>2]=0x4112D;St[wt+Xe>>2]=0x01;St[wt+Qe>>2]=0x00;St[wt+xe>>2]=0x100;St[wt+ve>>2]=0x00;St[wt+Re>>2]=0x00;St[wt+Fe>>2]=0x00;St[wt+Ce>>2]=0x00;St[wt+ae>>2]=0x3010;St[wt+ne>>2]=0x00;St[wt+oe>>2]=0x00;St[wt+Ze>>2]=0x0;St[wt+fe>>2]=0x40000;Lt=0x00;qt=0x00}function bi(){At=jt+(Pt-Bt)|0;return At|0}function xi(){var e=0x0;e=(St[wt+0xC84>>2]>>>0)-(Mt&0xFFFFFFFF)|0;e=e+((e|0)<0?0xFFFFFFFF:0x0)|0;return e|0}function mi(){return Mt|0}function vi(e){e=e|0;Mt=Mt+e|0}function gi(){}function ki(){}function Ri(e,t){e=e|0;t=t|0;fi=1}function yi(e,t){e=e|0;t=t|0}function Fi(e,t){e=e|0;t=t|0;var i=0;var s=0x100;i=(St[wt+be>>2]&0x06)>>1;_i();St[wt+Re>>2]=t;St[wt+Fe>>2]=e;At=s+(i<<6)|0;Ut=Pt;_t=1;ji()}function Ci(e,t){e=e|0;t=t|0;if((t|0)!=(H|0))At=jt+(Pt-Bt)|0;St[wt+Ce>>2]=e;switch(t|0){case 0:Fi(Q,At-4|0);break;case 1:Fi(K,At-4|0);break;case 2:Fi(N,At);break}}function Si(e,t){e=e|0;t=t|0;var i=0;i=(St[wt+be>>2]&0x06)>>1;switch(e|0){case 2:if((t|0)==(B|0))return 1;if((i|0)==(L|0)&(t|0)==(H|0))return 1;return 0;break;case 3:if(!((i|0)==(q|0)&(t|0)==(H|0)))return 1;break;case 4:if((t|0)==(B|0))return 1;return 0;break;case 5:if((t|0)!=(H|0))return 1;break;case 6:if((t|0)!=(W|0))return 1;break;case 7:return 1;break;case 11:if((i|0)==(q|0))return 1;break;case 13:if((i|0)==(q|0)&(t|0)!=(H|0))return 1;break;case 14:if((i|0)==(q|0)&(t|0)!=(W|0))return 1;break;case 15:if((i|0)==(q|0))return 1;break}s(y|0);r();return 0}function wi(e,t){e=e|0;t=t|0;var i=0;var a=0;var n=1;var o=0;var c=0;var h=0;var u=0;var d=0;var f=0;var p=0;var l=0;var b=0;var x=0;var m=0;i=St[wt+be>>2]>>17&0x1F;a=(St[wt+be>>2]&0x06)>>1;if((i|0)==0|(a|0)==(P|0))return e|0;if((i|0)!=8){s(C|0);r()}o=e&0xFFF;c=e>>>22|0;m=(St[wt+fe>>2]|0)+(c<<2)|0;h=Dt[Tt+m>>2]|0;u=h>>1&0xF;d=h&0x01;if((d|0)==0){Ci(e,t);return-1}if((u|0)>=2){if(!(Si(u,t)|0)){s(F|0);r()}return(h>>10|e>>12&0x3FF)<<12|o}o=e&0xFFF;f=(h&0xFFFFFC00)<<2;p=e>>12&0x3FF;m=(f|0)+(p<<2)|0;l=Dt[Tt+m>>2]|0;b=l>>1&0xF;x=l&0x01;n=n-1|0;if((x|0)==0){Ci(e,t);return-1}if(!(Si(b,t)|0)){Ci(e,t);return-1}return l>>10<<12|o|0}function Di(e,t){e=e|0;t=t|0;var i=0;var a=0;e=e<<2;switch(e|0){case 0xC:St[wt+e>>2]=t;break;case 0x1E40:St[wt+e>>2]=t;p(t|0);break;case 0x1E44:St[wt+e>>2]=t;l(t|0);break;case 0x1E00:St[wt+e>>2]=t;m(t|0);break;case 0xD14:a=0x90000000>>0;Et[Tt+a>>0]=t|0;if((t|0)==0xA)Et[Tt+a>>0]=0xD;break;case 0x1E04:St[wt+e>>2]=t;v(t|0);break;case 0xC00:St[wt+e>>2]=t;ji();break;case 0x3C00:break;case 0x3C04:St[wt+e>>2]=t;break;case 0x3C40:St[wt+e>>2]=t;break;case 0xC04:St[wt+e>>2]=t;break;case 0xD10:i=0x2|0x08;St[wt+e>>2]=St[wt+e>>2]&~i|t&i;break;case 0xC10:i=0x2|0x08|0x20;St[wt+e>>2]=St[wt+e>>2]&~i|t&i;break;case 0x504:case 0xD04:St[wt+e>>2]=t;break;case 0xD08:St[wt+e>>2]=t;break;case 0x3508:St[wt+e>>2]=t;break;case 0xD0C:St[wt+e>>2]=t;break;case 0x350C:St[wt+e>>2]=t;break;case 0x400:St[wt+ae>>2]=t;St[wt+be>>2]=St[wt+be>>2]&~0x1F039;St[wt+be>>2]=St[wt+be>>2]|St[wt+ae>>2]&0x01;St[wt+be>>2]=St[wt+be>>2]|St[wt+ae>>2]&0x08;St[wt+be>>2]=St[wt+be>>2]|St[wt+ae>>2]&0x10;St[wt+be>>2]=St[wt+be>>2]|St[wt+ae>>2]&0xF000;St[wt+be>>2]=St[wt+be>>2]|St[wt+ae>>2]&0x10000;break;case 0x404:St[wt+e>>2]=t;break;case 0x510:i=0x2;St[wt+Se>>2]=St[wt+Se>>2]&~i|t&i;break;case 0x410:i=0x2|0x20;St[wt+ve>>2]=St[wt+ve>>2]&~i|t&i;break;case 0xD00:St[wt+e>>2]=t;break;case 0x500:St[wt+e>>2]=t;break;case 0x2400:St[wt+e>>2]=t;break;case 0x3000:Mt=t;St[wt+e>>2]=t;break;case 0x1C04:case 0x3404:case 0x2804:St[wt+e>>2]=t;break;case 0x1D04:case 0x3604:case 0x2A04:St[wt+e>>2]=t;break;case 0x3004:case 0x2404:St[wt+e>>2]=t;break;case 0xC84:case 0x484:St[wt+Se>>2]=St[wt+Se>>2]&~32;St[wt+e>>2]=t;break;case 0xD84:case 0x600:St[wt+e>>2]=t;break;case 0x04:case 0x08:St[wt+e>>2]=t;break;default:St[wt+e>>2]=t;s(S|0);r();break}}function Ti(e){e=e|0;var t=0;t=(St[wt+be>>2]&0x06)>>1;e=e<<2|0;switch(e|0){case 0xC:return 0x0;break;case 0x1E40:return d()|0;break;case 0x1E44:return f()|0;break;case 0x1E00:return b()|0;break;case 0xD14:return 0x0;break;case 0x1E04:return x()|0;break;case 0xC00:return St[wt+e>>2]|0;break;case 0x3C00:return St[wt+e>>2]|0;break;case 0x3C04:return St[wt+e>>2]|0;break;case 0x3C40:return St[wt+e>>2]|0;break;case 0xC04:return St[wt+e>>2]|0;break;case 0xC10:return St[wt+e>>2]|0;break;case 0x504:case 0xD04:return St[wt+e>>2]|0;break;case 0xD08:return St[wt+e>>2]|0;break;case 0x3508:return St[wt+e>>2]|0;break;case 0xD0C:return St[wt+e>>2]|0;break;case 0x350C:return St[wt+e>>2]|0;break;case 0x400:St[wt+ae>>2]=0x00;St[wt+ae>>2]=St[wt+ae>>2]|St[wt+be>>2]&0x01;St[wt+ae>>2]=St[wt+ae>>2]|St[wt+be>>2]&0x08;St[wt+ae>>2]=St[wt+ae>>2]|St[wt+be>>2]&0x10;St[wt+ae>>2]=St[wt+ae>>2]|St[wt+be>>2]&0xF000;St[wt+ae>>2]=St[wt+ae>>2]|St[wt+be>>2]&0x10000;return St[wt+ae>>2]|0;break;case 0x404:return St[wt+e>>2]|0;break;case 0xD10:return St[wt+e>>2]|0;break;case 0x510:return St[wt+Se>>2]&(0x2|0x20)|0;break;case 0x410:return St[wt+ve>>2]&(0x2|0x20)|0;break;case 0xD00:return St[wt+e>>2]|0;break;case 0x500:return St[wt+e>>2]|0;break;case 0x2400:return Mt|0;break;case 0x3000:return Mt|0;break;case 0x1C04:case 0x3404:case 0x2804:return Mt|0;break;case 0x1D04:case 0x3604:case 0x2A04:return Mt>>32|0;break;case 0x3004:case 0x2404:return Mt|0;break;case 0xC84:case 0x484:return St[wt+e>>2]|0;break;case 0xD84:case 0x600:return St[wt+e>>2]|0;break;case 0x04:case 0x08:return St[wt+e>>2]|0;break;default:s(w|0);r();return St[wt+e>>2]|0;break}return 0}function Ei(e,t,i){e=e|0;t=t|0;i=i|0;var s=0,r=0;var a=0,n=0;var o=0,c=0;var h=0;var u=0;var d=0;var f=0;if(e>>>0<32767)if(t>>>0<65536){s=g(e|0,t|0)|0;r=(s|0)<0?-1:0;if((i|0)==0)return s|0;return r|0}a=e&0xFFFF;n=e>>>16;o=t&0xFFFF;c=t>>>16;h=g(a|0,o|0)|0;u=(h>>>16)+(g(n|0,o|0)|0)|0;d=u>>>16;u=(u&0xFFFF)+(g(a|0,c|0)|0)|0;d=d+(u>>>16)|0;f=d>>>16;d=(d&0xFFFF)+(g(n|0,c|0)|0)|0;f=f+(d>>>16)|0;s=(u&0xFFFF)<<16|h&0xFFFF;r=(f&0xFFFF)<<16|d&0xFFFF;if((i|0)==0)return s|0;return r|0}function Ii(e,t,i){e=e|0;t=t|0;i=i|0;var s=0,r=0;var a=0;if((e|0)==0)return 0;if((t|0)==0)return 0;if((e|0)>=-32768)if((e|0)<=32767)if((t|0)>=-32768)if((t|0)<=32767){s=g(e|0,t|0)|0;r=(s|0)<0?-1:0;if((i|0)==0)return s|0;return r|0}a=(e|0)<0^(t|0)<0;e=k(e|0)|0;t=k(t|0)|0;s=Ei(e,t,0)|0;r=Ei(e,t,1)|0;if(a){s=~s;r=~r;s=s+1|0;if((s|0)==0)r=r+1|0}if((i|0)==0)return s|0;return r|0}function Ai(e,t,i){e=e|0;t=t|0;i=i|0;var s=0,r=0;var a=0;if((e|0)==0)return 0;if((t|0)==0)return 0;if((e|0)>=-32768)if((e|0)<=32767)if(t>>>0<65536){s=g(e|0,t|0)|0;r=(s|0)<0?-1:0;if((i|0)==0)return s|0;return r|0}a=(e|0)<0;e=k(e|0)|0;s=Ei(e,t,0)|0;r=Ei(e,t,1)|0;if(a){s=~s;r=~r;s=s+1|0;if((s|0)==0)r=r+1|0}if((i|0)==0)return s|0;return r|0}function ji(){Wt=0xFFFF0000;Ht=-1;zt=0xFFFF0000;Ot=-1;Gt=0xFFFF0000;Nt=-1;Vt=0xFFFF0000;Xt=-1;Qt=0xFFFF0000;Kt=-1;Yt=0xFFFF0000;Jt=-1;Zt=0xFFFF0000;$t=-1;ei=0xFFFF0000;ti=-1;ii=0xFFFF0000;si=-1;ri=0xFFFF0000;ai=-1;ni=0xFFFF0000;oi=-1;ci=0xFFFF0000;hi=-1;ui=0xFFFF0000;di=-1}function _i(){var e=0,t=0,i=0;e=St[wt+be>>2]|0;t=e&0xFFF;i=(t<<2|P)<<1&0xFFF;St[wt+be>>2]=(e>>12<<12)+i&0xFFFEFFFF}function Mi(){var e=0,t=0,i=0;e=St[wt+be>>2]|0;t=e&0xFFF;i=t>>>3|(L<<1|0x1)<<9;St[wt+be>>2]=(e>>12<<12)+i;ji()}function Li(e,t){e=e|0;t=t|0;var i=0x00;var a=0x00;var n=0x00;var o=0x00;var c=0x00;var h=0x00;var u=0x0;var d=0x0;var f=0.0;var p=0.0;var l=0.0;var b=0;var x=0;var m=0;var v=0;var y=0;var F=0;var C=0;var S=64;for(;;){if((Ut|0)!=(Pt|0)){C=Dt[Pt>>2]|0;Pt=Pt+4|0;switch(C&0x7F){case 0x03:x=(mt[(C>>13&0x7C)>>2]|0)+(C>>20)|0;switch(C>>12&0x7){case 0x00:if((zt^x)&0xFFFFF000){m=wi(x|0,B)|0;if((m|0)==-1)continue;zt=x|0;Ot=(m^x)&0xFFFFF000}m=Ot^x;mt[(C>>5&0x7C)>>2]=Et[Tt+m>>0]<<24>>24;continue;case 0x01:if((Vt^x)&0xFFFFF000){m=wi(x|0,B)|0;if((m|0)==-1)continue;Vt=x|0;Xt=(m^x)&0xFFFFF000}m=Xt^x;mt[(C>>5&0x7C)>>2]=It[Tt+m>>1]<<16>>16;continue;case 0x02:if(x&3){s(D|0);r()}if((Yt^x)&0xFFFFF000){m=wi(x|0,B)|0;if((m|0)==-1)continue;Yt=x|0;Jt=(m^x)&0xFFFFF000}m=Jt^x;mt[(C>>5&0x7C)>>2]=Dt[Tt+m>>2]|0;continue;case 0x04:if((Gt^x)&0xFFFFF000){m=wi(x|0,B)|0;if((m|0)==-1)continue;Gt=x|0;Nt=(m^x)&0xFFFFF000}m=Nt^x;mt[(C>>5&0x7C)>>2]=Et[Tt+m>>0]&0xFF;continue;case 0x05:if((Qt^x)&0xFFFFF000){m=wi(x|0,B)|0;if((m|0)==-1)continue;Qt=x|0;Kt=(m^x)&0xFFFFF000}m=Kt^x;mt[(C>>5&0x7C)>>2]=It[Tt+m>>1]&0xFFFF;continue;default:s(E|0);r();break}continue;case 0x23:x=(mt[(C>>13&0x7C)>>2]|0)+(C>>25<<5|C>>7&0x1F)|0;switch(C>>12&0x7){case 0x00:if((Zt^x)&0xFFFFF000){m=wi(x|0,W)|0;if((m|0)==-1)continue;Zt=x|0;$t=(m^x)&0xFFFFF000}m=$t^x;Et[Tt+m>>0]=mt[(C>>18&0x7C)>>2]&0xFF;continue;case 0x01:if((ei^x)&0xFFFFF000){m=wi(x|0,W)|0;if((m|0)==-1)continue;ei=x|0;ti=(m^x)&0xFFFFF000}m=ti^x;It[Tt+m>>1]=mt[(C>>18&0x7C)>>2]&0xFFFF;continue;case 0x02:if(x&3){s(T|0);r()}if((ii^x)&0xFFFFF000){m=wi(x|0,W)|0;if((m|0)==-1)continue;ii=x|0;si=(m^x)&0xFFFFF000}m=si^x;Dt[Tt+m>>2]=mt[(C>>18&0x7C)>>2]|0;continue;default:s(E|0);r();break}continue;case 0x13:u=mt[(C>>13&0x7C)>>2]|0;switch(C>>12&0x7){case 0x00:mt[(C>>5&0x7C)>>2]=u+(C>>20)|0;continue;case 0x02:if((u|0)<C>>20)mt[(C>>5&0x7C)>>2]=0x01;else mt[(C>>5&0x7C)>>2]=0x00;continue;case 0x03:if(u>>>0<C>>20>>>0)mt[(C>>5&0x7C)>>2]=0x01;else mt[(C>>5&0x7C)>>2]=0x00;continue;case 0x04:mt[(C>>5&0x7C)>>2]=u^C>>20;continue;case 0x06:mt[(C>>5&0x7C)>>2]=u|C>>20;continue;case 0x07:mt[(C>>5&0x7C)>>2]=u&C>>20;continue;case 0x01:mt[(C>>5&0x7C)>>2]=u<<(C>>20&0x1F);continue;case 0x05:if((C>>25&0x7F)==0x00){mt[(C>>5&0x7C)>>2]=u>>>(C>>20&0x1F)}else if((C>>25&0x7F)==0x20){mt[(C>>5&0x7C)>>2]=u>>(C>>20&0x1F)}continue;default:s(E|0);r();break}continue;case 0x33:switch(C>>25&0x7F){case 0x00:u=mt[(C>>13&0x7C)>>2]|0;d=mt[(C>>18&0x7C)>>2]|0;switch(C>>12&0x7){case 0x00:mt[(C>>5&0x7C)>>2]=u+d;continue;case 0x02:if((u|0)<(d|0))mt[(C>>5&0x7C)>>2]=0x01;else mt[(C>>5&0x7C)>>2]=0x00;continue;case 0x03:if(u>>>0<d>>>0)mt[(C>>5&0x7C)>>2]=0x01;else mt[(C>>5&0x7C)>>2]=0x00;continue;case 0x07:mt[(C>>5&0x7C)>>2]=u&d;continue;case 0x06:mt[(C>>5&0x7C)>>2]=u|d;continue;case 0x04:mt[(C>>5&0x7C)>>2]=u^d;continue;case 0x01:mt[(C>>5&0x7C)>>2]=u<<(d&0x1F);continue;case 0x05:mt[(C>>5&0x7C)>>2]=u>>>(d&0x1F);continue}continue;case 0x20:u=mt[(C>>13&0x7C)>>2]|0;d=mt[(C>>18&0x7C)>>2]|0;switch(C>>12&0x7){case 0x00:mt[(C>>5&0x7C)>>2]=u-d;continue;case 0x05:mt[(C>>5&0x7C)>>2]=u>>(d&0x1F);continue}continue;case 0x01:u=mt[(C>>13&0x7C)>>2]|0;d=mt[(C>>18&0x7C)>>2]|0;switch(C>>12&0x7){case 0x00:h=g(u|0,d|0)|0;mt[(C>>5&0x7C)>>2]=h;continue;case 0x01:h=Ii(u,d,1)|0;mt[(C>>5&0x7C)>>2]=h;continue;case 0x02:h=Ai(u,d>>>0,1)|0;mt[(C>>5&0x7C)>>2]=h;continue;case 0x03:h=Ei(u>>>0,d>>>0,1)|0;mt[(C>>5&0x7C)>>2]=h;continue;case 0x04:if((d|0)==0)o=-1;else o=(u|0)/(d|0)|0;mt[(C>>5&0x7C)>>2]=o;continue;case 0x05:if((d|0)==0)o=0xFFFFFFFF;else o=(u>>>0)/(d>>>0)|0;mt[(C>>5&0x7C)>>2]=o;continue;case 0x06:if((d|0)==0)c=u;else c=(u|0)%(d|0)|0;mt[(C>>5&0x7C)>>2]=c;continue;case 0x07:if((d|0)==0)c=u>>>0;else c=(u>>>0)%(d>>>0)|0;mt[(C>>5&0x7C)>>2]=c;continue}continue;default:s(E|0);r();break}continue;case 0x37:mt[(C>>5&0x7C)>>2]=C&0xFFFFF000;continue;case 0x17:At=jt+(Pt-Bt)|0;mt[(C>>5&0x7C)>>2]=At+(C&0xFFFFF000)-4|0;continue;case 0x6F:At=jt+(Pt-Bt)|0;mt[(C>>5&0x7C)>>2]=At;i=(C>>21&0x3FF|(C>>20&0x1)<<10|(C>>12&0xFF)<<11|C>>31<<19)<<1;At=At+i-4|0;Ut=Pt;_t=1;mt[0]=0;continue;case 0x67:At=jt+(Pt-Bt)|0;u=mt[(C>>13&0x7C)>>2]|0;mt[(C>>5&0x7C)>>2]=At;At=u+(C>>20)&0xFFFFFFFE|0;Ut=Pt;_t=1;mt[0]=0;continue;case 0x63:u=mt[(C>>13&0x7C)>>2]|0;d=mt[(C>>18&0x7C)>>2]|0;switch(C>>12&0x7){case 0x00:if((u|0)!=(d|0))continue;Ut=Pt;_t=1;i=(C>>31<<11|(C>>25&0x3F)<<4|C>>8&0x0F|(C>>7&0x01)<<10)<<1;At=jt+(Pt-Bt)|0;At=At+i-4|0;continue;case 0x01:if((u|0)==(d|0))continue;Ut=Pt;_t=1;i=(C>>31<<11|(C>>25&0x3F)<<4|C>>8&0x0F|(C>>7&0x01)<<10)<<1;At=jt+(Pt-Bt)|0;At=At+i-4|0;continue;case 0x04:if((u|0)>=(d|0))continue;Ut=Pt;_t=1;i=(C>>31<<11|(C>>25&0x3F)<<4|C>>8&0x0F|(C>>7&0x01)<<10)<<1;At=jt+(Pt-Bt)|0;At=At+i-4|0;continue;case 0x05:if((u|0)<(d|0))continue;Ut=Pt;_t=1;i=(C>>31<<11|(C>>25&0x3F)<<4|C>>8&0x0F|(C>>7&0x01)<<10)<<1;At=jt+(Pt-Bt)|0;At=At+i-4|0;continue;case 0x06:if(u>>>0>=d>>>0)continue;Ut=Pt;_t=1;i=(C>>31<<11|(C>>25&0x3F)<<4|C>>8&0x0F|(C>>7&0x01)<<10)<<1;At=jt+(Pt-Bt)|0;At=At+i-4|0;continue;case 0x07:if(u>>>0<d>>>0)continue;Ut=Pt;_t=1;i=(C>>31<<11|(C>>25&0x3F)<<4|C>>8&0x0F|(C>>7&0x01)<<10)<<1;At=jt+(Pt-Bt)|0;At=At+i-4|0;continue;default:s(E|0);r();break}continue;case 0x73:i=C>>>20;u=mt[(C>>13&0x7C)>>2]|0;switch(C>>12&0x7){case 0x01:mt[(C>>5&0x7C)>>2]=Ti(i)|0;Di(i,u);mt[0]=0;continue;case 0x02:mt[(C>>5&0x7C)>>2]=Ti(i)|0;Di(i,Ti(i)|0|u);mt[0]=0;continue;case 0x03:mt[(C>>5&0x7C)>>2]=Ti(i)|0;Di(i,(Ti(i)|0)&~u);mt[0]=0;continue;case 0x05:mt[(C>>5&0x7C)>>2]=Ti(i)|0;a=C>>15&0x1F;if((a|0)!=0)Di(i,a>>0);mt[0]=0;continue;case 0x06:mt[(C>>5&0x7C)>>2]=Ti(i)|0;a=C>>15&0x1F;if((a|0)!=0)Di(i,Ti(i)|0|a>>0);mt[0]=0;continue;case 0x07:mt[(C>>5&0x7C)>>2]=Ti(i)|0;a=C>>15&0x1F;if((a|0)!=0)Di(i,(Ti(i)|0)&~(a>>0));mt[0]=0;continue;case 0x00:v=(St[wt+be>>2]&0x06)>>1;Ut=Pt;switch(C>>20&0xFFF){case 0x00:At=jt+(Pt-Bt)|0;switch(v|0){case 0x00:Fi(Y,At-4|0);break;case 0x01:Fi(J,At-4|0);break;case 0x02:Fi(Z,At-4|0);r();break;case 0x03:Fi($,At-4|0);break;default:s(I|0);r();break}continue;case 0x001:At=jt+(Pt-Bt)|0;Fi(X,At-4|0);continue;case 0x100:v=(St[wt+be>>2]&0x06)>>1;At=jt+(Pt-Bt)|0;if((v|0)<(q|0)){s(j|0);r();break}Mi();switch(v|0){case 0x01:At=St[wt+ue>>2]|0;break;case 0x02:At=St[wt+le>>2]|0;r();break;case 0x03:At=St[wt+Re>>2]|0;break;default:s(A|0);r();break}_t=1;ji();continue;case 0x102:y=St[wt+ve>>2]&St[wt+Se>>2];continue;case 0x305:At=jt+(Pt-Bt)|0;if((v|0)!=(P|0)){s(_|0);r();break}St[wt+be>>2]=St[wt+be>>2]&~0x6|0x02;St[wt+Ne>>2]=St[wt+Ce>>2];St[wt+Ge>>2]=St[wt+Fe>>2];St[wt+ue>>2]=St[wt+Re>>2];At=St[wt+ne>>2]|0;ji();_t=1;continue;case 0x101:ji();continue;default:s(E|0);r();break}continue;default:s(E|0);r();break}continue;case 0x07:x=(mt[(C>>13&0x7C)>>2]|0)+(C>>20)|0;switch(C>>12&0x7){case 0x02:if((ri^x)&0xFFFFF000){m=wi(x|0,B)|0;if((m|0)==-1)break;ri=x|0;ai=(m^x)&0xFFFFF000}m=ai^x;mt[0]=Dt[Tt+m>>2]|0;gt[kt+((C>>7&0x1F)<<3)>>3]=+Ft[0];mt[0]=0;continue;case 0x03:if((ni^x)&0xFFFFF000){m=wi(x|0,B)|0;if((m|0)==-1)continue;ni=x|0;oi=(m^x)&0xFFFFF000}m=oi^x;Rt[yt+((C>>7&0x1F)<<3)+0>>2]=Dt[Tt+m+0>>2]|0;Rt[yt+((C>>7&0x1F)<<3)+4>>2]=Dt[Tt+m+4>>2]|0;continue;default:s(E|0);s(C|0);r();break}continue;case 0x27:x=(mt[(C>>13&0x7C)>>2]|0)+(C>>25<<5|C>>7&0x1F)|0;switch(C>>12&0x7){case 0x02:Ft[0]=+gt[kt+((C>>20&0x1F)<<3)>>3];if((ci^x)&0xFFFFF000){m=wi(x|0,B)|0;if((m|0)==-1)continue;ci=x|0;hi=(m^x)&0xFFFFF000}m=hi^x;Dt[Tt+m>>2]=mt[0]|0;mt[0]=0;continue;case 0x03:if((ui^x)&0xFFFFF000){m=wi(x|0,B)|0;if((m|0)==-1)continue;ui=x|0;di=(m^x)&0xFFFFF000}m=di^x;Dt[Tt+m+0>>2]=Rt[yt+((C>>20&0x1F)<<3)+0>>2]|0;Dt[Tt+m+4>>2]=Rt[yt+((C>>20&0x1F)<<3)+4>>2]|0;continue;default:s(E|0);s(C|0);r();break}continue;case 0x53:switch(C>>25&0x7F){case 0x00:case 0x01:f=+gt[kt+((C>>15&0x1F)<<3)>>3];p=+gt[kt+((C>>20&0x1F)<<3)>>3];gt[kt+((C>>7&0x1F)<<3)>>3]=+f+ +p;continue;case 0x04:case 0x05:f=+gt[kt+((C>>15&0x1F)<<3)>>3];p=+gt[kt+((C>>20&0x1F)<<3)>>3];gt[kt+((C>>7&0x1F)<<3)>>3]=+f-+p;continue;case 0x50:case 0x51:f=+gt[kt+((C>>15&0x1F)<<3)>>3];p=+gt[kt+((C>>20&0x1F)<<3)>>3];switch(C>>12&0x7){case 0x0:if(+f<=+p)mt[(C>>5&0x7C)>>2]=1;else mt[(C>>5&0x7C)>>2]=0;continue;case 0x1:if(+f<+p)mt[(C>>5&0x7C)>>2]=1;else mt[(C>>5&0x7C)>>2]=0;continue;case 0x2:if(+f==+p)mt[(C>>5&0x7C)>>2]=1;else mt[(C>>5&0x7C)>>2]=0;continue;default:s(E|0);s(C|0);r();break}continue;case 0x20:case 0x21:gt[kt+((C>>7&0x1F)<<3)>>3]=+gt[kt+((C>>15&0x1F)<<3)>>3];continue;case 0x60:mt[(C>>5&0x7C)>>2]=~~R(+gt[kt+((C>>15&0x1F)<<3)>>3]);continue;case 0x68:case 0x69:gt[kt+((C>>7&0x1F)<<3)>>3]=+(mt[(C>>13&0x7C)>>2]|0);continue;case 0x08:case 0x09:f=+gt[kt+((C>>15&0x1F)<<3)>>3];p=+gt[kt+((C>>20&0x1F)<<3)>>3];gt[kt+((C>>7&0x1F)<<3)>>3]=+ +f*+p;continue;case 0x10:case 0x11:f=+gt[kt+((C>>15&0x1F)<<3)>>3];p=+gt[kt+((C>>20&0x1F)<<3)>>3];switch(C>>12&7){case 0:gt[kt+((C>>7&0x1F)<<3)>>3]=+p<+0?-+k(+f):+k(+f);continue;case 1:gt[kt+((C>>7&0x1F)<<3)>>3]=+p<+0?+k(+f):-+k(+f);continue;case 2:if(+f*+p<+0){gt[kt+((C>>7&0x1F)<<3)>>3]=-+k(+f)}else{gt[kt+((C>>7&0x1F)<<3)>>3]=+ +k(+f)}continue;default:s(E|0);s(C|0);r()}continue;case 0x61:mt[(C>>5&0x7C)>>2]=~~+gt[kt+((C>>15&0x1F)<<3)>>3];continue;case 0x78:u=mt[(C>>13&0x7C)>>2]|0;mt[0]=u;gt[kt+((C>>7&0x1F)<<3)>>3]=+Ft[0];mt[0]=0;continue;default:s(E|0);s(C|0);r();break}continue;case 0x43:f=+gt[kt+((C>>15&0x1F)<<3)>>3];p=+gt[kt+((C>>20&0x1F)<<3)>>3];l=+gt[kt+((C>>27&0x1F)<<3)>>3];gt[kt+((C>>7&0x1F)<<3)>>3]=f*p+l;continue;case 0x47:f=+gt[kt+((C>>15&0x1F)<<3)>>3];p=+gt[kt+((C>>20&0x1F)<<3)>>3];l=+gt[kt+((C>>27&0x1F)<<3)>>3];gt[kt+((C>>7&0x1F)<<3)>>3]=f*p-l;continue;case 0x4B:f=+gt[kt+((C>>15&0x1F)<<3)>>3];p=+gt[kt+((C>>20&0x1F)<<3)>>3];l=+gt[kt+((C>>27&0x1F)<<3)>>3];gt[kt+((C>>7&0x1F)<<3)>>3]=-(f*p+l);continue;case 0x4F:f=+gt[kt+((C>>15&0x1F)<<3)>>3];p=+gt[kt+((C>>20&0x1F)<<3)>>3];l=+gt[kt+((C>>27&0x1F)<<3)>>3];gt[kt+((C>>7&0x1F)<<3)>>3]=-(f*p-l);continue;case 0x2F:u=mt[(C>>13&0x7C)>>2]|0;d=mt[(C>>18&0x7C)>>2]|0;m=wi(u|0,B)|0;if((m|0)==-1)continue;switch(C>>27&0x1F){case 0x01:mt[(C>>5&0x7C)>>2]=Dt[Tt+m>>2]|0;Dt[Tt+m>>2]=d|0;m=wi(u|0,W)|0;if((m|0)==-1)continue;mt[0]=0;continue;case 0x00:mt[(C>>5&0x7C)>>2]=Dt[Tt+m>>2]|0;m=wi(u|0,W)|0;if((m|0)==-1)continue;Dt[Tt+m>>2]=(mt[(C>>5&0x7C)>>2]|0)+(d|0)|0;mt[0]=0;continue;case 0x04:mt[(C>>5&0x7C)>>2]=Dt[Tt+m>>2]|0;m=wi(u|0,W)|0;if((m|0)==-1)continue;Dt[Tt+m>>2]=(mt[(C>>5&0x7C)>>2]|0)^(d|0)|0;mt[0]=0;continue;case 0x0C:mt[(C>>5&0x7C)>>2]=Dt[Tt+m>>2]|0;m=wi(u|0,W)|0;if((m|0)==-1)continue;Dt[Tt+m>>2]=(mt[(C>>5&0x7C)>>2]|0)&(d|0)|0;mt[0]=0;continue;case 0x08:mt[(C>>5&0x7C)>>2]=Dt[Tt+m>>2]|0;m=wi(u|0,W)|0;if((m|0)==-1)continue;Dt[Tt+m>>2]=mt[(C>>5&0x7C)>>2]|0|(d|0)|0;mt[0]=0;continue;case 0x10:mt[(C>>5&0x7C)>>2]=Dt[Tt+m>>2]|0;if(d>>0>mt[(C>>5&0x7C)>>2]>>0)mt[0]=mt[(C>>5&0x7C)>>2];else mt[0]=d;m=wi(u|0,W)|0;if((m|0)==-1)continue;Dt[Tt+m>>2]=mt[0]|0;mt[0]=0;continue;case 0x14:mt[(C>>5&0x7C)>>2]=Dt[Tt+m>>2]|0;if(d>>0<mt[(C>>5&0x7C)>>2]>>0)mt[0]=mt[(C>>5&0x7C)>>2];else mt[0]=d;m=wi(u|0,W)|0;if((m|0)==-1)continue;Dt[Tt+m>>2]=mt[0]|0;mt[0]=0;continue;case 0x18:mt[(C>>5&0x7C)>>2]=Dt[Tt+m>>2]|0;if(d>>>0>mt[(C>>5&0x7C)>>2]>>>0)mt[0]=mt[(C>>5&0x7C)>>2];else mt[0]=d;m=wi(u|0,W)|0;if((m|0)==-1)continue;Dt[Tt+m>>2]=mt[0]|0;mt[0]=0;continue;case 0x1C:mt[(C>>5&0x7C)>>2]=Dt[Tt+m>>2]|0;if(d>>>0<mt[(C>>5&0x7C)>>2]>>>0)mt[0]=mt[(C>>5&0x7C)>>2];else mt[0]=d;m=wi(u|0,W)|0;if((m|0)==-1)continue;Dt[Tt+m>>2]=mt[0]|0;mt[0]=0;continue;case 0x02:mt[(C>>5&0x7C)>>2]=Dt[Tt+m>>2]|0;Lt=u;qt=mt[(C>>5&0x7C)>>2]|0;mt[0]=0;continue;case 0x03:if((u|0)!=(Lt|0)){mt[(C>>5&0x7C)>>2]=0x01;continue}if((Dt[Tt+m>>2]|0)!=(qt|0)){mt[(C>>5&0x7C)>>2]=0x01;continue}mt[(C>>5&0x7C)>>2]=0x00;m=wi(u,W)|0;if((m|0)==-1)continue;Dt[Tt+m>>2]=d|0;mt[0]=0;continue;default:s(M|0);r();break}continue;case 0x0F:continue;case 0x0:default:s(E|0);s(C|0);r();break}}else{if(!(_t|0))At=jt+(Pt-Bt)|0;S=S-(Pt-Bt>>2)|0;if((S|0)<0){S=S+64|0;e=e-64|0;if((e|0)<0)return 0;b=(St[wt+ge>>2]|0)-Mt|0;b=b+((b|0)<0?0xFFFFFFFF:0x0)|0;Mt=Mt+t|0;if((b|0)<(t|0)){St[wt+Se>>2]=St[wt+Se>>2]|0x20}v=(St[wt+be>>2]&0x06)>>1;y=St[wt+ve>>2]&St[wt+Se>>2];F=St[wt+be>>2]&0x01;if((v|0)<3|(v|0)==3&(F|0)){if((y|0)&0x8){Fi(G,At);continue}else if(fi|0){Fi(O,At);fi=0;continue}}if((v|0)<1|(v|0)==1&(F|0)){if((y|0)&0x2){Fi(G,At);continue}else if((y|0)&0x20){Fi(z,At);continue}}}if((Wt^At)&0xFFFFF000){Pt=wi(At|0,H)|0;if((Pt|0)==-1){Pt=Ut;continue}Wt=At;Ht=(Pt^At)&0xFFFFF000}Pt=Tt+(Ht^At)|0;Bt=Pt;jt=At;Ut=(Pt>>12)+1<<12;_t=0}}return 0}return{Reset:li,Init:pi,InvalidateTLB:ji,Step:Li,TranslateVM:wi,GetCSR:Ti,SetCSR:Di,GetTimeToNextInterrupt:xi,ProgressTime:vi,GetTicks:mi,GetPC:bi,AnalyzeImage:gi,RaiseInterrupt:Ri,ClearInterrupt:yi}})}()}),define("cjs!jor1k/worker/riscv/index",["require","exports","module","cjs!../messagehandler","cjs!../utils","cjs!../imul","cjs!./safecpu","cjs!./fastcpu"],function(e,t,i){!function(){var t=e("cjs!../messagehandler"),s=e("cjs!../utils"),r=e("cjs!../imul"),a=e("cjs!./safecpu"),n=e("cjs!./fastcpu"),o={Int32Array:Int32Array,Int8Array:Int8Array,Int16Array:Int16Array,Float32Array:Float32Array,Float64Array:Float64Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array,Math:Math};function c(e,i,s,c,h){return this.cpu=function(e,i,s,c,h){var u=null,d={DebugMessage:t.Debug,abort:t.Abort,imul:Math.imul||r,MathAbs:Math.abs,Read32:i.Read32Little.bind(i),Write32:i.Write32Little.bind(i),Read16:i.Read16Little.bind(i),Write16:i.Write16Little.bind(i),Read8:i.Read8Little.bind(i),Write8:i.Write8Little.bind(i),ReadDEVCMDToHost:s.ReadDEVCMDToHost.bind(s),ReadDEVCMDFromHost:s.ReadDEVCMDFromHost.bind(s),WriteDEVCMDToHost:s.WriteDEVCMDToHost.bind(s),WriteDEVCMDFromHost:s.WriteDEVCMDFromHost.bind(s),ReadToHost:s.ReadToHost.bind(s),ReadFromHost:s.ReadFromHost.bind(s),WriteToHost:s.WriteToHost.bind(s),WriteFromHost:s.WriteFromHost.bind(s)};if("safe"===e)return new a(i,s);if("asm"===e)return(u=n(o,d,c)).Init(),u;throw new Error("invalid CPU name:"+e)}(e,i,s,c),this.name=e,this.ncores=h,this.ram=i,this.heap=c,this.littleendian=!0,this}c.prototype.switchImplementation=function(e){},c.prototype.toString=function(){var e=new Int32Array(this.heap,0),t=new Uint32Array(this.heap,8192),i="";i+="Current state of the machine\n",void 0!==this.cpu.pc?i+="PC: "+s.ToHex(this.cpu.pc)+"\n":i+="PC: "+s.ToHex(this.cpu.GetPC())+"\n";for(var r=0;r<32;r+=4)i+="   r"+(r+0)+": "+s.ToHex(e[r+0])+"   r"+(r+1)+": "+s.ToHex(e[r+1])+"   r"+(r+2)+": "+s.ToHex(e[r+2])+"   r"+(r+3)+": "+s.ToHex(e[r+3])+"\n";return i+="mstatus: "+s.ToBin(t[768])+"\n",i+="mcause: "+s.ToHex(t[834])+" mbadaddress: "+s.ToHex(t[835])+" mepc: "+s.ToHex(t[833])+"\n"};["Reset","Step","RaiseInterrupt","Step","AnalyzeImage","GetTicks","GetTimeToNextInterrupt","ProgressTime","ClearInterrupt"].forEach(function(e){c.prototype[e]=function(){return this.cpu[e].apply(this.cpu,arguments)}}),i.exports=c}()}),define("cjs!jor1k/worker/riscv/syscalls",["require","exports","module","cjs!../messagehandler","cjs!../utils"],function(e,t,i){!function(){var t=e("cjs!../messagehandler"),s=e("cjs!../utils");function r(e){this.ram=e,this.elf8mem=[],this.file_descriptor_table=[],this.file_size=[],this.file_pointer=[],this.file_descriptor_offset=9,this.elf8mem_offset=0}r.prototype.HandleSysCall=function(e){e|=0;this.ram;var i=this.ram.Read32(e);t.Debug("syscall_id "+i);var r=["pk","a.out"];switch(i){case 56:for(var a=this.ram.Read32(e+16),n="",o=0;0!=(g=this.ram.Read8(a+o));o++)n+=String.fromCharCode(g);var c=n;s.LoadBinaryResourceII("../riscv-sys/"+c,this.OnFileLoaded.bind(this),!1,function(e){throw e}),this.ram.Write32(e,this.file_descriptor_offset);break;case 67:var h,u=this.ram.Read32(e+8),d=this.file_descriptor_table[u],f=this.ram.Read32(e+16),p=this.ram.Read32(e+24),l=this.ram.Read32(e+32),b=this.file_size[u];for(o=0;o<p&&!(o+l>=b);o++)h=this.elf8mem[d+o+l],this.ram.Write8(f+o,h);this.file_pointer[u]+=o,this.ram.Write32(e,o);break;case 57:this.ram.Write32(e,0);break;case 80:u=this.ram.Read32(e+8);var x=this.ram.Read32(e+16);this.ram.Write32(x,0),this.ram.Write32(x+4,0),this.ram.Write16(x+8,33279),this.ram.Write16(x+10,0),this.ram.Write16(x+12,0),this.ram.Write16(x+14,0),this.ram.Write32(x+16,0),this.ram.Write32(x+20,0),this.ram.Write32(x+24,this.file_size[u]),this.ram.Write16(x+28,512),this.ram.Write16(x+30,0),this.ram.Write32(x+32,0),this.ram.Write32(x+36,0),this.ram.Write32(x+40,0),this.ram.Write32(x+44,0),this.ram.Write32(x+48,0),this.ram.Write32(x+52,0),this.ram.Write32(x+56,0),this.ram.Write16(x+60,0),this.ram.Write16(x+62,0),this.ram.Write32(e,1);break;case 64:for(var m=this.ram.Read32(e+24),v=(o=0,this.ram.Read32(e+16));o<m;){var g=this.ram.Read8(v+o++);this.ram.Write8Little(50331648,g),10==g&&this.ram.Write8(50331648,13)}this.ram.Write32(e,o);break;case 93:t.Debug("Program exited with sys_exit for inst at PC "+s.ToHex(this.pc)),t.Abort();break;case 2011:var k=this.ram.Read32(e+8);m=this.ram.Read32(e+16);this.ram.Write32(k,r.length);var R=8*r.length+32;for(o=0;o<r.length;o++)this.ram.Write32(k+8+8*o,k+R),R+=r[o].length+1;R=8*r.length+32;for(o=0;o<r.length;o++){for(var y=0;y<r[o].length;y++)this.ram.Write8(k+R,r[o].charCodeAt(y)),R++;R++}this.ram.Write32(e,0);break;default:t.Debug("unkown SysCall "+s.ToHex(i)+" at PC "+s.ToHex(this.pc)),t.Abort()}},r.prototype.OnFileLoaded=function(e){var i=new Uint8Array(e),s=i.length;t.Debug("On File Loaded "+s);for(var r=0;r<s;r++)this.elf8mem[r+this.elf8mem_offset]=i[r];this.file_descriptor_table[++this.file_descriptor_offset]=this.elf8mem_offset,this.elf8mem_offset+=s,this.file_size[this.file_descriptor_offset]=s,this.file_pointer[this.file_descriptor_offset]=0},i.exports=r}()}),define("cjs!jor1k/worker/riscv/htif",["require","exports","module","cjs!../messagehandler","cjs!../utils","cjs!../bzip2","cjs!./syscalls"],function(e,t,i){!function(){var t=e("cjs!../messagehandler"),s=(e("cjs!../utils"),e("cjs!../bzip2"),e("cjs!./syscalls"));function r(e,i){this.ram=e,this.identify="bcd",this.Send=i,this.charqueue=[],this.readpresent=!0,this.Read=function(e){this.readpresent=!0,0!=this.charqueue.length&&(this.Send(1,0,this.charqueue.shift()),this.readpresent=!1)},this.Write=function(e){this.ram.Write8(50331648,e),10==e&&this.ram.Write8(50331648,13)},this.ReceiveChar=function(e){this.charqueue=this.charqueue.concat(e),this.readpresent&&(this.Send(1,0,this.charqueue.shift()),this.readpresent=!1)},t.Register("htif.term0.Transfer",this.ReceiveChar.bind(this))}function a(e,i){this.ram=e,this.Send=i,this.syscallHandler=new s(this.ram),this.identify="syscall_proxy",this.Read=function(e){e>>>0>256?this.syscallHandler.HandleSysCall(e):(this.ram.Write8(50331648,e+48),t.Debug("return value: "+e),t.Abort()),this.Send(0,0,1)}}function n(e,t){this.ram=e,this.irqdev=t,this.device=[],this.device.push(new a(this.ram,this.Send.bind(this))),this.device.push(new r(this.ram,this.Send.bind(this))),this.devid=0,this.cmd=0,this.reg_tohost=0,this.reg_devcmdfromhost=0,this.fromhostqueue=[]}n.prototype.Send=function(e,t,i){this.fromhostqueue.push({devid:e,cmd:t,data:i}),1==this.fromhostqueue.length&&(this.reg_devcmdfromhost=this.fromhostqueue[0].devid<<24|this.fromhostqueue[0].cmd<<16),this.irqdev.RaiseInterrupt(1)},n.prototype.ReadDEVCMDToHost=function(){return 0},n.prototype.ReadToHost=function(){return 0},n.prototype.WriteDEVCMDToHost=function(e){this.devid=e>>>24,this.cmd=e>>16&255},n.prototype.WriteToHost=function(e){this.reg_tohost=0|e,this.HandleRequest()},n.prototype.ReadDEVCMDFromHost=function(){return 0!=this.fromhostqueue.length?this.reg_devcmdfromhost:0},n.prototype.ReadFromHost=function(){return 0!=this.fromhostqueue.length?this.fromhostqueue[0].data:0},n.prototype.WriteDEVCMDFromHost=function(e){this.reg_devcmdfromhost=e},n.prototype.WriteFromHost=function(e){0==e&&0==this.reg_devcmdfromhost&&(this.fromhostqueue.shift(),this.fromhostqueue.length>0?(this.reg_devcmdfromhost=this.fromhostqueue[0].devid<<24|this.fromhostqueue[0].cmd<<16,this.irqdev.RaiseInterrupt(1)):this.irqdev.ClearInterrupt(1))},n.prototype.IsQueueEmpty=function(){return 0==this.fromhostqueue.length},n.prototype.HandleRequest=function(){if(255==this.cmd){var e=this.reg_tohost;return this.device[this.devid]?function(e,t,i){for(var s=0;s<e.length;s++)t.Write8(i+s,e.charCodeAt(s));t.Write8(i+e.length,0)}(this.device[this.devid].identify,this.ram,e):this.ram.Write8(e+0,0),this.Send(this.devid,255,1),void(this.reg_tohost=0)}return 0==this.cmd?(this.device[this.devid]?this.device[this.devid].Read(this.reg_tohost):(t.Debug("Error in HTIF: unknown read from device"),t.Abort()),void(this.reg_tohost=0)):1==this.cmd?(this.device[this.devid]?this.device[this.devid].Write(this.reg_tohost):(t.Debug("Error in HTIF: unknown write from device"),t.Abort()),void(this.reg_tohost=0)):(t.Debug("Error HTIF: unknown request"),void t.Abort())},i.exports=n}()}),define("cjs!jor1k/worker/dev/clint",["require","exports","module","cjs!../messagehandler","cjs!../utils"],function(e,t,i){!function(){var t=e("cjs!../messagehandler"),s=e("cjs!../utils");function r(e){this.csr=e,this.Reset()}r.prototype.Reset=function(){this.regs=new Uint32Array(12288)},r.prototype.ReadReg32=function(e){return t.Debug("CLINT: unknown ReadReg32: "+s.ToHex(e)),t.Abort(),0},r.prototype.WriteReg32=function(e,t){e|=0,this.regs[e>>2]=t,16384==e&&(this.csr[3137]=t)},i.exports=r}()}),define("cjs!jor1k/worker/dev/plic",["require","exports","module","cjs!../messagehandler","cjs!../utils"],function(e,t,i){!function(){e("cjs!../messagehandler"),e("cjs!../utils");function t(e){this.cpuirqhandler=e,this.Reset()}t.prototype.Reset=function(){this.regs=new Uint32Array(12288),this.mask=0},t.prototype.ReadReg32=function(e){var t=0;if(2097156==e)for(t=0;t<32;t++)if(this.mask&1<<t)return t;return 0},t.prototype.WriteReg32=function(e,t){},t.prototype.RaiseInterrupt=function(e){1!=(e|=0)&&(this.mask|=1<<e,this.cpuirqhandler.RaiseInterrupt(9,-1))},t.prototype.ClearInterrupt=function(e){e|=0,this.mask&=~(1<<e),0==this.mask&&this.cpuirqhandler.ClearInterrupt(9,-1)},i.exports=t}()}),define("cjs!jor1k/worker/dev/rom",["require","exports","module","cjs!../utils","cjs!../messagehandler"],function(e,t,i){!function(){e("cjs!../utils"),e("cjs!../messagehandler");function t(e){this.rom=e,this.buffer32view=new Int32Array(this.rom),this.buffer16view=new Int16Array(this.rom),this.buffer8view=new Int8Array(this.rom)}t.prototype.Reset=function(){},t.prototype.ReadReg32=function(e){return this.buffer32view[e>>2]},t.prototype.ReadReg16=function(e){return this.buffer16view[e>>1]},t.prototype.ReadReg8=function(e){return this.buffer8view[e]},i.exports=t}()}),define("cjs!jor1k/worker/init_riscv",["require","exports","module","cjs!./messagehandler","cjs!./utils","cjs!./riscv","cjs!./riscv/htif","cjs!./dev/clint","cjs!./dev/plic","cjs!./dev/rom","cjs!./dev/uart","cjs!./dev/virtio","cjs!./dev/virtio/9p","cjs!./dev/virtio/dummy","cjs!./dev/virtio/net"],function(e,t,i){!function(){var t=e("cjs!./messagehandler"),s=e("cjs!./utils"),r=e("cjs!./riscv"),a=e("cjs!./riscv/htif"),n=e("cjs!./dev/clint"),o=e("cjs!./dev/plic"),c=e("cjs!./dev/rom"),h=e("cjs!./dev/uart"),u=e("cjs!./dev/virtio"),d=(e("cjs!./dev/virtio/9p"),e("cjs!./dev/virtio/dummy")),f=e("cjs!./dev/virtio/net");i.exports=function(e,i){t.Debug("Init RISCV SoC");var p=e;e.htif=new a(e.ram,e),e.cpu=new r(i.cpu,e.ram,e.htif,e.heap,e.ncores),e.devices.push(e.cpu),e.rom=new ArrayBuffer(8192);var l=new Int32Array(e.rom),b=new Uint8Array(e.rom);l[1024]=2147480215,l[1025]=1431,l[1026]=29722003,l[1027]=4047512947,l[1028]=163943,l[1029]=0,l[1030]=0,l[1031]=0,t.Debug("Load DTB"),s.LoadBinaryResourceII(i.dtbURL,function(e){for(var t=new Uint8Array(e),i=0;i<t.length;i++)b[4128+i]=t[i]}.bind(this),!1,function(e){throw e}),e.virtionetdev=new f(e.ram),e.virtiodummydev=new d(e.ram),e.virtiodev1=new u(p,3,e.ram,e.virtio9pdev),e.virtiodev2=new u(p,4,e.ram,e.virtionetdev),e.virtiodev3=new u(p,5,e.ram,e.virtiodummydev),e.virtiodev4=new u(p,6,e.ram,e.virtiodummydev),e.virtiodev5=new u(p,7,e.ram,e.virtiodummydev),e.romdev=new c(e.rom),e.uartdev0=new h(0,p,2),e.clintdev=new n(e.csr),e.plicdev=new o(e.cpu),e.devices.push(e.romdev),e.devices.push(e.uartdev0),e.devices.push(e.clintdev),e.devices.push(e.plicdev),e.devices.push(e.virtiodev1),e.devices.push(e.virtiodev2),e.devices.push(e.virtiodev3),e.devices.push(e.virtiodev4),e.devices.push(e.virtiodev5),e.devices.push(e.virtio9pdev),e.ram.AddDevice(e.romdev,0,7),e.ram.AddDevice(e.uartdev0,50331648,8192),e.ram.AddDevice(e.clintdev,33554432,8192),e.ram.AddDevice(e.plicdev,67108864,15728640),e.ram.AddDevice(e.virtiodev1,536870912,8192),e.ram.AddDevice(e.virtiodev2,805306368,8192),e.ram.AddDevice(e.virtiodev3,1073741824,8192),e.ram.AddDevice(e.virtiodev4,1342177280,8192),e.ram.AddDevice(e.virtiodev5,1610612736,8192)}}()}),define("cjs!jor1k/worker/filesystem/tar",["require","exports","module","cjs!../messagehandler"],function(e,t,i){!function(){var t=e("cjs!../messagehandler");function s(e){this.fs=e,this.tarbuffer=new Uint8Array(512),this.tarbufferofs=0,this.tarmode=0,this.tarfileoffset=0}function r(e,t,i){for(var s="",r=0;r<i;r++){if(e[t+r]<32)return s;s+=String.fromCharCode(e[t+r])}return s}function a(e,t,i,s){for(var r=Math.min(s,e.length+1),a=0;a<r;a++)t[i+a]=e.charCodeAt(a);t[i+r-1]=0}s.prototype.Unpack=function(e){if(this.tarbuffer[this.tarbufferofs++]=e,512==this.tarbufferofs)if(this.tarbufferofs=0,1!=this.tarmode){if("ustar"==r(this.tarbuffer,257,5)){var t=String.fromCharCode(this.tarbuffer[156]),i=r(this.tarbuffer,0,100).split("/");0==i[(c=i.length)-1].length&&i.pop();c=i.length;var s=0,a=-1;for(h=0;h<c-1;h++){if(-1==(a=this.fs.Search(s,i[h])))throw"Error in untar: Could not find inode.";s=a}if(-1==(a=this.fs.Search(s,i[i.length-1]))&&!(-1!=a&&"5"!=t||-1!=a&&"5"==t)){var n=this.fs.CreateInode();n.name=i[c-1],n.parentid=s,n.mode=parseInt(r(this.tarbuffer,100,8),8),n.uid=parseInt(r(this.tarbuffer,108,8),8),n.gid=parseInt(r(this.tarbuffer,116,8),8),n.atime=parseInt(r(this.tarbuffer,136,12),8),n.ctime=this.atime,n.mtime=this.atime;var o=parseInt(r(this.tarbuffer,124,12),8);switch(t){case"5":n.mode|=16384;break;case"0":if(n.mode|=32768,n.data=new Uint8Array(o),n.size=o,0==o)break;this.tarmode=1,this.tarfileoffset=0,this.tarfilebuffer=n.data;break;case"1":n.mode|=40960,n.symlink="/"+r(this.tarbuffer,157,100);break;case"2":n.mode|=40960,n.symlink=r(this.tarbuffer,157,100)}this.fs.PushInode(n)}}}else{for(var c=Math.min(512,this.tarfilebuffer.length-this.tarfileoffset),h=0;h<c;h++)this.tarfilebuffer[this.tarfileoffset++]=this.tarbuffer[h];this.tarfileoffset>=this.tarfilebuffer.length&&(this.tarmode=0)}},s.prototype.Pack=function(e){t.Debug("tar: "+e);var i=this.fs.SearchPath(e).id;if(-1==i)return new Uint8Array(0);var s=[];this.fs.GetRecursiveList(i,s);for(var r=0,n=0;n<s.length;n++)switch(61440&this.fs.inodes[s[n]].mode){case 40960:case 16384:r+=512;break;case 32768:r+=512,511&(r+=this.fs.inodes[s[n]].size)&&(r&=-512,r+=512)}t.Debug("tar: "+this.fs.GetFullPath(i)+" size: "+r+" files: "+s.length),t.Debug(s);var o=new Uint8Array(r),c=0;for(n=0;n<s.length;n++){var h=this.fs.inodes[s[n]],u=61440&h.mode;if(40960==u||16384==u||32768==u){switch(a("ustar  ",o,c+257,8),a(this.fs.GetFullPath(s[n]),o,c+0,100),a("00000000000",o,c+124,12),a((4095&h.mode).toString(8),o,c+100,8),a(h.uid.toString(8),o,c+108,8),a(h.gid.toString(8),o,c+116,8),a(h.mtime.toString(8),o,c+136,12),o[c+148+0]=32,o[c+148+1]=32,o[c+148+2]=32,o[c+148+3]=32,o[c+148+4]=32,o[c+148+5]=32,o[c+148+6]=32,o[c+148+7]=32,u){case 40960:o[c+156]="2".charCodeAt(0),a(h.symlink,o,c+157,100);break;case 16384:o[c+156]="5".charCodeAt(0);break;case 32768:o[c+156]="0".charCodeAt(0),a(h.size.toString(8),o,c+124,12)}for(var d=0,f=0;f<512;f++)d+=o[c+f];if(a(d.toString(8),o,c+148,7),c+=512,32768==u){for(f=0;f<h.size;f++)o[c++]=h.data[f];511&c&&(c&=-512,c+=512)}}}return o},i.exports=s}()}),define("cjs!jor1k/worker/filesystem/fsloader",["require","exports","module","cjs!../messagehandler","cjs!../utils"],function(e,t,i){!function(){var t=e("cjs!../messagehandler"),s=e("cjs!../utils");function r(e){this.fs=e}r.prototype.HandleDirContents=function(e,i){for(var s in e){var r=e[s],a=this.fs.Search(i,r.name);if(-1!=a){if(!r.path&&!r.size){r.child&&this.HandleDirContents(r.child,a);continue}t.Debug("Overwriting non-directory!")}var n=this.fs.CreateInode();if(n.name=r.name,n.uid=0|r.uid,n.gid=0|r.gid,n.parentid=i,this.fs.inodes[n.parentid].nlinks++,n.mode=parseInt(r.mode,8),r.path)n.mode=41471,n.symlink=r.path,this.fs.PushInode(n);else if(void 0===r.size)n.mode|=16384,n.updatedir=!0,n.nlinks=2,this.fs.PushInode(n),r.child&&this.HandleDirContents(r.child,-1!=a?a:this.fs.inodes.length-1);else{r.lazy&&(n.lazy=r.lazy),n.mode|=32768;var o=this.fs.inodes.length;n.status=2,n.compressed=!!r.c,n.size=0|r.size,this.fs.PushInode(n);var c=this.sysrootdir+(r.src?r.src:this.fs.GetFullPath(o));n.url=c,(r.load||this.fs.CheckEarlyload(this.fs.GetFullPath(o)))&&this.fs.LoadFile(o)}}},r.prototype.OnJSONLoaded=function(e){var i=JSON.parse(e);this.sysrootdir=i.src,String(this.sysrootdir)!==this.sysrootdir&&t.Debug("No sysroot (src tag)!"),this.sysrootdir=this.fs.userinfo.path+this.sysrootdir+"/",t.Debug("systemroot "+this.sysrootdir),this.HandleDirContents(i.fs,0),t.Debug("processed "+this.fs.inodes.length+" inodes"),this.fs.Check()},r.prototype.LoadJSON=function(e){t.Debug("Load filesystem information from "+e),s.LoadTextResource(e,this.OnJSONLoaded.bind(this),function(e){throw e})},i.exports=r}()}),define("cjs!jor1k/worker/filesystem/lazyUint8Array",["require","exports","module","cjs!../messagehandler"],function(e,t,i){!function(){var t=e("cjs!../messagehandler");function s(){return this.lengthKnown||this.CacheLength(),this._length}function r(){return this.lengthKnown||this.CacheLength(),this._chunkSize}function a(e,t){this.fallbackLength=t,this.overlay=[],this.url=e,this.lengthKnown=!1,this.chunks=[],Object.defineProperty(this,"length",{get:s}),Object.defineProperty(this,"chunkSize",{get:r})}a.prototype.Set=function(e,t){e>this.length-1||e<0||(this.overlay[e]=t)},a.prototype.Get=function(e){if(!(e>this.length-1||e<0)){if(void 0!==this.overlay[e])return this.overlay[e];var t=e%this.chunkSize,i=e/this.chunkSize|0;return this.GetChunk(i)[t]}},a.prototype.DoXHR=function(e,i){e>i&&t.Error("Invalid range ("+e+", "+i+") or no bytes requested!"),i>this._length-1&&t.Error("Only "+this._length+" bytes available! programmer error!");var s=new XMLHttpRequest;if(s.open("GET",this.url,!1),this._length!==this._chunkSize&&s.setRequestHeader("Range","bytes="+e+"-"+i),s.responseType="arraybuffer",s.send(null),!(s.status>=200&&s.status<300||304===s.status))throw new Error("Couldn't load "+this.url+". Status: "+s.status);return new Uint8Array(s.response||[])},a.prototype.GetChunk=function(e){var t=e*this._chunkSize,i=(e+1)*this._chunkSize-1;return i=Math.min(i,this._length-1),void 0===this.chunks[e]&&(this.chunks[e]=this.DoXHR(t,i)),this.chunks[e]},a.prototype.CacheLength=function(){var e,i=new XMLHttpRequest;if(i.open("HEAD",this.url+"?"+(new Date).getTime(),!1),i.send(null),!(i.status>=200&&i.status<300||304===i.status))throw new Error("Couldn't load "+this.url+". Status: "+i.status);this._length=Number(i.getResponseHeader("Content-length")),0===this._length&&(t.Warning("Server doesn't return Content-length, even though we have a cache defeating URL query-string appended"),this._length=this.fallbackLength),this._chunkSize=1048576,(e=i.getResponseHeader("Accept-Ranges"))&&"bytes"===e||(this._chunkSize=this._length),this.lengthKnown=!0},i.exports=a}()}),define("cjs!jor1k/worker/filesystem/filesystem",["require","exports","module","cjs!./tar","cjs!./fsloader","cjs!../utils","cjs!../bzip2","cjs!../dev/virtio/marshall","cjs!../../lib/utf8","cjs!../messagehandler","cjs!./lazyUint8Array"],function(e,t,i){!function(){var t=e("cjs!./tar"),s=e("cjs!./fsloader"),r=e("cjs!../utils"),a=e("cjs!../bzip2"),n=e("cjs!../dev/virtio/marshall"),o=e("cjs!../../lib/utf8"),c=e("cjs!../messagehandler"),h=e("cjs!./lazyUint8Array"),u=61440,d=16384;function f(){this.inodes=[],this.events=[],this.qidnumber=0,this.filesinloadingqueue=0,this.OnLoaded=function(){},this.tar=new t(this),this.fsloader=new s(this),this.userinfo=[],this.watchFiles={},this.watchDirectories={},c.Register("LoadFilesystem",this.LoadFilesystem.bind(this)),c.Register("MergeFile",this.MergeFile.bind(this)),c.Register("DeleteNode",this.DeleteNode.bind(this)),c.Register("DeleteDirContents",this.RecursiveDelete.bind(this)),c.Register("CreateDirectory",function(e){var t=this.SearchPath(e);-1==t.id&&-1!=t.parentid&&this.CreateDirectory(t.name,t.parentid)}.bind(this)),c.Register("Rename",function(e){var t=this.SearchPath(e.oldPath),i=this.SearchPath(e.newPath);if(-1!=t.id&&-1!=i.parentid)if(-1==i.id){if((this.inodes[i.parentid].mode&u)!=d)return;this.Rename(this.inodes[t.id].parentid,this.inodes[t.id].name,i.parentid,i.name)}else this.Rename(this.inodes[t.id].parentid,this.inodes[t.id].name,this.inodes[i.id].parentid,this.inodes[i.id].name)}.bind(this)),c.Register("WatchFile",function(e){this.watchFiles[e.name]=!0}.bind(this)),c.Register("WatchDirectory",function(e){this.watchDirectories[e.name]=!0}.bind(this)),c.Register("ReadFile",function(e){c.Send("ReadFile",this.ReadFile.bind(this)(e))}.bind(this)),c.Register("tar",function(e){c.Send("tar",this.tar.Pack(e))}.bind(this)),c.Register("sync",function(e){c.Send("sync",this.tar.Pack(e))}.bind(this)),this.CreateDirectory("",-1)}f.prototype.LoadFilesystem=function(e){this.userinfo=e,this.fsloader.LoadJSON(this.userinfo.basefsURL),this.OnLoaded=function(){this.userinfo.extendedfsURL&&this.fsloader.LoadJSON(this.userinfo.extendedfsURL);for(var e=0;e<this.userinfo.lazyloadimages.length;e++)this.LoadImage(this.userinfo.lazyloadimages[e])}.bind(this)},f.prototype.AddEvent=function(e,t){0!=this.GetInode(e).status?this.events.push({id:e,OnEvent:t}):t()},f.prototype.HandleEvent=function(e){0==this.filesinloadingqueue&&(this.OnLoaded(),this.OnLoaded=function(){});for(var t=[],i=0;i<this.events.length;i++)this.events[i].id==e?this.events[i].OnEvent():t.push(this.events[i]);this.events=t},f.prototype.LoadImage=function(e){e&&r.LoadBinaryResource(e,function(e){var t=new Uint8Array(e);0!=e.byteLength&&a.simple(t,this.tar.Unpack.bind(this.tar))}.bind(this),function(t){c.Debug("Error: Could not load "+e+". Skipping.")}.bind(this))},f.prototype.CheckEarlyload=function(e){for(var t=0;t<this.userinfo.earlyload.length;t++)if(this.userinfo.earlyload[t]==e)return!0;return!1},f.prototype.AppendDateHack=function(e){if("home/user/.profile"==this.GetFullPath(e)){var t=this.inodes[e],i=new Date,s='\ndate -s "'+i.getUTCFullYear()+"-"+(i.getUTCMonth()+1)+"-"+i.getUTCDate()+" "+i.getUTCHours()+":"+i.getUTCMinutes()+":"+i.getUTCSeconds()+'" &>/dev/null\n',r=t.size;this.ChangeSize(e,r+s.length);for(var a=0;a<s.length;a++)t.data[a+r]=s.charCodeAt(a)}},f.prototype.LoadFile=function(e){var t=this.inodes[e];if(2==t.status)if(t.status=3,this.filesinloadingqueue++,c.Debug("inode url "+t.url),t.compressed){t.data=new Uint8Array(t.size);var i=function(e){return function(t){var i=this.GetInode(e),s=new Uint8Array(t),r=0;a.simple(s,function(e){i.data[r++]=e}.bind(this)),i.status=0,this.filesinloadingqueue--,this.HandleEvent(e)}.bind(this)}.bind(this)(e);r.LoadBinaryResource(t.url+".bz2",i,function(e){throw e})}else{if(t.lazy){c.Debug("Using lazy file for "+t.url),t.data=new h(t.url,t.size);var s=t.size;return t.size=t.data.length,s!=t.size&&c.Warning("Size wrong for lazy loaded file: "+t.name),t.status=0,this.filesinloadingqueue--,void this.HandleEvent(e)}i=function(e){return function(t){var i=this.GetInode(e);i.data=new Uint8Array(t),i.size!=i.data.length&&c.Warning("Size wrong for uncompressed non-lazily loaded file: "+i.name),i.size=i.data.length,i.status=0,this.filesinloadingqueue--,this.HandleEvent(e)}.bind(this)}.bind(this)(e);r.LoadBinaryResource(t.url,i,function(e){throw e})}},f.prototype.PushInode=function(e){if(-1!=e.parentid)return this.inodes.push(e),this.inodes[e.parentid].updatedir=!0,e.nextid=this.inodes[e.parentid].firstid,void(this.inodes[e.parentid].firstid=this.inodes.length-1);0!=this.inodes.length?(c.Debug("Error in Filesystem: Pushed inode with name = "+e.name+" has no parent"),c.Abort()):this.inodes.push(e)},f.prototype.CreateInode=function(){return this.qidnumber++,{updatedir:!1,parentid:-1,firstid:-1,nextid:-1,status:0,name:"",size:0,uid:0,gid:0,ctime:Math.floor((new Date).getTime()/1e3),atime:Math.floor((new Date).getTime()/1e3),mtime:Math.floor((new Date).getTime()/1e3),major:0,minor:0,data:new Uint8Array(0),symlink:"",nlinks:1,mode:493,qid:{type:0,version:0,path:this.qidnumber},url:"",compressed:!1}},f.prototype.CreateDirectory=function(e,t){var i=this.CreateInode();return i.name=e,i.parentid=t,i.mode=511|d,i.updatedir=!0,i.nlinks=2,t>=0&&(i.uid=this.inodes[t].uid,i.gid=this.inodes[t].gid,i.mode=511&this.inodes[t].mode|d,this.inodes[t].nlinks++),i.qid.type=d>>8,this.PushInode(i),this.NotifyListeners(this.inodes.length-1,"newdir"),this.inodes.length-1},f.prototype.CreateFile=function(e,t){var i=this.CreateInode();return i.name=e,i.parentid=t,i.uid=this.inodes[t].uid,i.gid=this.inodes[t].gid,this.inodes[t].nlinks++,i.qid.type=128,i.mode=438&this.inodes[t].mode|32768,this.PushInode(i),this.NotifyListeners(this.inodes.length-1,"newfile"),this.inodes.length-1},f.prototype.CreateNode=function(e,t,i,s){var r=this.CreateInode();return r.name=e,r.parentid=t,r.major=i,r.minor=s,r.uid=this.inodes[t].uid,r.gid=this.inodes[t].gid,this.inodes[t].nlinks++,r.qid.type=192,r.mode=438&this.inodes[t].mode,this.PushInode(r),this.inodes.length-1},f.prototype.CreateSymlink=function(e,t,i){var s=this.CreateInode();return s.name=e,s.parentid=t,s.uid=this.inodes[t].uid,s.gid=this.inodes[t].gid,this.inodes[t].nlinks++,s.qid.type=160,s.symlink=i,s.mode=40960,this.PushInode(s),this.inodes.length-1},f.prototype.CreateTextFile=function(e,t,i){var s=this.CreateFile(e,t),r=this.inodes[s];for(var a in r.data=new Uint8Array(i.length),r.size=i.length,i)r.data[a]=i.charCodeAt(a);return s},f.prototype.OpenInode=function(e,t){var i=this.GetInode(e);return(i.mode&u)==d&&this.FillDirectory(e),2==i.status?(this.LoadFile(e),!1):(".profile"==i.name&&this.AppendDateHack(e),!0)},f.prototype.CloseInode=function(e){var t=this.GetInode(e);4==t.status&&(t.status=-1,t.data=new Uint8Array(0),t.size=0)},f.prototype.Rename=function(e,t,i,s){if(e==i&&t==s)return!0;var r=this.Search(e,t),a=this.GetFullPath(r);if(-1==r)return!1;var n=this.Search(i,s);-1!=n&&this.Unlink(n);var o=r,h=this.inodes[o];if(this.inodes[h.parentid].firstid==o)this.inodes[h.parentid].firstid=h.nextid;else{var u=this.FindPreviousID(o);-1==u&&(c.Debug("Error in Filesystem: Cannot find previous id of inode"),c.Abort()),this.inodes[u].nextid=h.nextid}return h.parentid=i,h.name=s,h.qid.version++,h.nextid=this.inodes[h.parentid].firstid,this.inodes[h.parentid].firstid=o,this.inodes[e].updatedir=!0,this.inodes[i].updatedir=!0,this.inodes[e].nlinks--,this.inodes[i].nlinks++,this.NotifyListeners(o,"rename",{oldpath:a}),!0},f.prototype.Write=function(e,t,i,s){this.NotifyListeners(e,"write");var r=this.inodes[e];if(r.data.length<t+i?(this.ChangeSize(e,Math.floor(3*(t+i)/2)),r.size=t+i):r.size<t+i&&(r.size=t+i),r.data instanceof Uint8Array)for(var a=0;a<i;a++)r.data[t+a]=s();else for(a=0;a<i;a++)r.data.Set(t+a,s())},f.prototype.Search=function(e,t){for(var i=this.inodes[e].firstid;-1!=i;){if(this.inodes[i].parentid!=e&&c.Debug("Error in Filesystem: Found inode with wrong parent id"),this.inodes[i].name==t)return i;i=this.inodes[i].nextid}return-1},f.prototype.GetTotalSize=function(){for(var e=0,t=0;t<this.inodes.length;t++)e+=this.inodes[t].data.length;return e},f.prototype.GetFullPath=function(e){for(var t="";0!=e;)t="/"+this.inodes[e].name+t,e=this.inodes[e].parentid;return t.substring(1)},f.prototype.FindPreviousID=function(e){for(var t=this.GetInode(e),i=this.inodes[t.parentid].firstid;-1!=i;){if(this.inodes[i].nextid==e)return i;i=this.inodes[i].nextid}return i},f.prototype.Unlink=function(e){if(this.NotifyListeners(e,"delete"),0==e)return!1;var t=this.GetInode(e);if((t.mode&u)==d&&-1!=t.firstid)return!1;if(this.inodes[t.parentid].firstid==e)this.inodes[t.parentid].firstid=t.nextid;else{var i=this.FindPreviousID(e);-1==i&&(c.Debug("Error in Filesystem: Cannot find previous id of inode"),c.Abort()),this.inodes[i].nextid=t.nextid}return this.inodes[t.parentid].updatedir=!0,this.inodes[t.parentid].nlinks--,t.status=4,t.nextid=-1,t.firstid=-1,t.parentid=-1,t.nlinks--,!0},f.prototype.GetInode=function(e){return isNaN(e)?(c.Debug("Error in filesystem: id is not a number "),0):e<0||e>this.inodes.length?(c.Debug("Error in filesystem: Attempt to get inode with id "+e),0):this.inodes[e]},f.prototype.ChangeSize=function(e,t){var i=this.GetInode(e);if(t!=i.size){var s=new Uint8Array(t);i.size=t;for(var r=Math.min(i.data.length,i.size),a=0;a<r;a++)s[a]=this.ReadByte(i,a);i.data=s}},f.prototype.ReadByte=function(e,t){return e.data instanceof Uint8Array?e.data[t]:e.data.Get(t)},f.prototype.SearchPath=function(e){var t=(e=e.replace("//","/")).split("/");0==t[(i=t.length)-1].length&&t.pop(),0==t[0].length&&t.shift();for(var i=t.length,s=0,r=-1,a=0;a<i;a++){if(-1==(r=this.Search(s,t[a])))return a<i-1?{id:-1,parentid:-1,name:t[a]}:{id:-1,parentid:s,name:t[a]};s=r}return{id:r,parentid:s,name:t[a]}},f.prototype.GetRecursiveList=function(e,t){for(var i=this.inodes[e].firstid;-1!=i;)t.push(i),(this.inodes[i].mode&u)==d&&this.GetRecursiveList(i,t),i=this.inodes[i].nextid},f.prototype.ReadFile=function(e){var t=this.SearchPath(e.name);if(-1!=t.parentid)return-1==t.id?null:(e.data=this.inodes[t.id].data,e.size=this.inodes[t.id].size,e)},f.prototype.MergeFile=function(e){c.Debug("Merge path:"+e.name);var t=this.SearchPath(e.name);-1!=t.parentid&&(-1==t.id&&(t.id=this.CreateFile(t.name,t.parentid)),this.inodes[t.id].data=e.data,this.inodes[t.id].size=e.data.length,this.inodes[t.id].mtime=Math.floor((new Date).getTime()/1e3),this.inodes[t.id].atime=this.inodes[t.id].mtime,this.inodes[t.id].ctime=this.inodes[t.id].mtime)},f.prototype.RecursiveDelete=function(e){var t=[],i=this.SearchPath(e);if(-1!=i.parentid&&-1!=i.id){this.GetRecursiveList(i.id,t);for(var s=t.length-1;s>=0;s--)this.Unlink(t[s])}},f.prototype.DeleteNode=function(e){var t=this.SearchPath(e);if(-1!=t.parentid&&-1!=t.id)if(32768!=(this.inodes[t.id].mode&u))if((this.inodes[t.id].mode&u)!=d);else{var i=[];this.GetRecursiveList(t.id,i);for(var s=i.length-1;s>=0;s--)this.Unlink(i[s]);this.Unlink(t.id)}else this.Unlink(t.id)},f.prototype.NotifyListeners=function(e,t,i){null==i&&(i={});var s=this.GetFullPath(e);for(var r in 1==this.watchFiles[s]&&"write"==t&&c.Send("WatchFileEvent",s),this.watchDirectories)if(this.watchDirectories.hasOwnProperty(r)){var a=s.indexOf(r);0!=a&&1!=a||c.Send("WatchDirectoryEvent",{path:s,event:t,info:i})}},f.prototype.Check=function(){for(var e=1;e<this.inodes.length;e++)if(-1!=this.inodes[e].status){this.inodes[e].nextid==e&&(c.Debug("Error in filesystem: file points to itself"),c.Abort());var t=this.GetInode(e);t.parentid<0&&c.Debug("Error in filesystem: negative parent id "+e);var i=t.name.length;for(var s in 0==i&&c.Debug("Error in filesystem: inode with no name and id "+e),t.name){t.name.charCodeAt(s)<32&&c.Debug("Error in filesystem: Unallowed char in filename")}}},f.prototype.FillDirectory=function(e){var t=this.GetInode(e);if(t.updatedir){var i=t.parentid;-1==i&&(i=0);for(var s=0,r=this.inodes[e].firstid;-1!=r;)s+=24+o.UTF8Length(this.inodes[r].name),r=this.inodes[r].nextid;s+=25,s+=26,t.data=new Uint8Array(s),t.size=s;var a=0;a+=n.Marshall(["Q","d","b","s"],[this.inodes[e].qid,a+13+8+1+2+1,this.inodes[e].mode>>12,"."],t.data,a),a+=n.Marshall(["Q","d","b","s"],[this.inodes[i].qid,a+13+8+1+2+2,this.inodes[i].mode>>12,".."],t.data,a);for(r=this.inodes[e].firstid;-1!=r;)a+=n.Marshall(["Q","d","b","s"],[this.inodes[r].qid,a+13+8+1+2+o.UTF8Length(this.inodes[r].name),this.inodes[r].mode>>12,this.inodes[r].name],t.data,a),r=this.inodes[r].nextid;t.updatedir=!1}},f.prototype.PrepareCAPs=function(e){var t=this.GetInode(e);return t.caps?t.caps.length:(t.caps=new Uint8Array(12),t.caps[0]=0,t.caps[1]=0,t.caps[2]=0,t.caps[3]=1,t.caps[4]=255,t.caps[5]=255,t.caps[6]=255,t.caps[7]=255,t.caps[8]=255,t.caps[9]=255,t.caps[10]=255,t.caps[11]=255,t.caps.length)},i.exports=f}()}),define("cjs!jor1k/worker/system",["require","exports","module","cjs!./messagehandler","cjs!./utils","cjs!./ram","cjs!./bzip2","cjs!./elf","cjs!./timer","cjs!./init_openrisc","cjs!./init_riscv","cjs!./filesystem/filesystem","cjs!./dev/uart","cjs!./dev/irq","cjs!./dev/timer","cjs!./dev/framebuffer","cjs!./dev/ethmac","cjs!./dev/ata","cjs!./dev/rtc","cjs!./dev/clint","cjs!./dev/plic","cjs!./dev/rom","cjs!./dev/touchscreen","cjs!./dev/keyboard","cjs!./dev/sound","cjs!./dev/virtio","cjs!./dev/virtio/9p","cjs!./dev/virtio/dummy","cjs!./dev/virtio/input","cjs!./dev/virtio/net","cjs!./dev/virtio/block","cjs!./dev/virtio/gpu","cjs!./dev/virtio/console"],function(e,t,i){!function(){var t=e("cjs!./messagehandler"),s=e("cjs!./utils"),r=e("cjs!./ram"),a=e("cjs!./bzip2"),n=e("cjs!./elf"),o=e("cjs!./timer"),c=e("cjs!./init_openrisc"),h=e("cjs!./init_riscv"),u=e("cjs!./filesystem/filesystem"),d=(e("cjs!./dev/uart"),e("cjs!./dev/irq"),e("cjs!./dev/timer"),e("cjs!./dev/framebuffer"),e("cjs!./dev/ethmac"),e("cjs!./dev/ata"),e("cjs!./dev/rtc"),e("cjs!./dev/clint"),e("cjs!./dev/plic"),e("cjs!./dev/rom"),e("cjs!./dev/touchscreen"),e("cjs!./dev/keyboard"),e("cjs!./dev/sound"),e("cjs!./dev/virtio"),e("cjs!./dev/virtio/9p"));e("cjs!./dev/virtio/dummy"),e("cjs!./dev/virtio/input"),e("cjs!./dev/virtio/net"),e("cjs!./dev/virtio/block"),e("cjs!./dev/virtio/gpu"),e("cjs!./dev/virtio/console");function f(){t.Register("LoadAndStart",this.LoadImageAndStart.bind(this)),t.Register("execute",this.MainLoop.bind(this)),t.Register("Init",this.Init.bind(this)),t.Register("Reset",this.Reset.bind(this)),t.Register("PrintOnAbort",this.PrintState.bind(this)),t.Register("GetIPS",function(e){t.Send("GetIPS",this.ips),this.ips=0}.bind(this))}f.prototype.Reset=function(){this.status=2;for(var e=0;e<this.devices.length;e++)this.devices[e].Reset();this.ips=0},f.prototype.Init=function(e){t.Debug("Init with following JSON structure: "),t.Debug(e),this.status=2,this.arch=e.arch,this.memorysize=e.memorysize,this.ncores=e.ncores,e.ncores||(e.ncores=1),this.ips=0,this.idletime=0,this.idlemaxwait=0,this.ticksperms=2e4,this.loopspersecond=100,this.timer=new o(this.ticksperms,this.loopspersecond),t.Debug("Allocate "+this.memorysize+" MB"),"or1k"==e.arch&&"dynamic"==e.cpu&&"undefined"!=typeof WebAssembly?(t.Debug("Use webassembly memory"),this.memory=new WebAssembly.Memory({initial:16*this.memorysize,maximum:16*this.memorysize}),this.heap=this.memory.buffer):this.heap=new ArrayBuffer(1048576*this.memorysize);this.memorysize--,this.ram=new r(this.heap,1048576),this.memory&&(this.ram.memory=this.memory),this.csr=new Int32Array(this.heap,8192,4096),this.devices=[],this.filesystem=new u,this.virtio9pdev=new d(this.ram,this.filesystem);try{if("or1k"==e.arch)c(this,e);else{if("riscv"!=e.arch)throw"Architecture "+e.arch+" not supported";h(this,e)}}catch(e){t.Debug("Error: failed to create SoC: "+e),t.Abort()}},f.prototype.RaiseInterrupt=function(e){if("riscv"==this.arch?this.plicdev.RaiseInterrupt(e):this.cpu.RaiseInterrupt(e,-1),3==this.status){this.status=1,clearTimeout(this.idletimeouthandle);var t=(s.GetMilliseconds()-this.idletime)*this.ticksperms;t>this.idlemaxwait&&(t=this.idlemaxwait),this.cpu.ProgressTime(t),this.MainLoop()}},f.prototype.ClearInterrupt=function(e){"riscv"==this.arch?this.plicdev.ClearInterrupt(e):this.cpu.ClearInterrupt(e,-1)},f.prototype.RaiseSoftInterrupt=function(e,t){this.cpu.RaiseInterrupt(e,t)},f.prototype.ClearSoftInterrupt=function(e,t){this.cpu.ClearInterrupt(e,t)},f.prototype.PrintState=function(){this.uartdev0&&this.uartdev0.Step(),this.uartdev1&&this.uartdev1.Step(),t.Debug(this.cpu.toString())},f.prototype.SendStringToTerminal=function(e){for(var i=[],s=0;s<e.length;s++)i.push(e.charCodeAt(s));t.Send("tty0",i)},f.prototype.LoadImageAndStart=function(e){this.SendStringToTerminal("\r================================================================================"),"string"==typeof e?(this.SendStringToTerminal("\r\nLoading kernel and hard and basic file system from web server. Please wait ...\r\n"),s.LoadBinaryResource(e,this.OnKernelLoaded.bind(this),function(e){throw e})):this.OnKernelLoaded(e)},f.prototype.PatchKernel=function(e){for(var t=this.ram.uint8mem,i=0;i<e;i++)109===t[i+0]&&101===t[i+1]&&109===t[i+2]&&111===t[i+3]&&114===t[i+4]&&121===t[i+5]&&0===t[i+6]&&1===t[i+24]&&240===t[i+25]&&0===t[i+26]&&0===t[i+27]&&(t[i+24]=1048576*this.memorysize>>24,t[i+25]=1048576*this.memorysize>>16,t[i+26]=0,t[i+27]=0)},f.prototype.OnKernelLoaded=function(e){this.SendStringToTerminal("Decompressing kernel...\r\n");var i=new Uint8Array(e),s=e.byteLength;if(n.IsELF(i))n.Extract(i,this.ram);else if(a.IsBZIP2(i)){if(s=0,a.simple(i,function(e){this.ram.uint8mem[s++]=e}.bind(this)),n.IsELF(this.ram.uint8mem)){for(var r=new Uint8Array(s),o=0;o<s;o++)r[o]=this.ram.uint8mem[o];n.Extract(r,this.ram)}}else for(o=0;o<s;o++)this.ram.uint8mem[o]=i[o];0==this.cpu.littleendian&&(this.PatchKernel(s),this.ram.Little2Big(s)),t.Debug("Kernel loaded: "+s+" bytes"),this.SendStringToTerminal("Booting\r\n"),this.SendStringToTerminal("================================================================================"),this.cpu.Reset(),this.cpu.AnalyzeImage(),t.Debug("Starting emulation"),this.status=1,t.Send("execute",0)},f.prototype.HandleHalt=function(){var e=this.cpu.GetTimeToNextInterrupt();if(-1!=e){this.idlemaxwait=e;var i=Math.floor(e/this.ticksperms/this.timer.correction+.5);i<=1||(i>1e3&&t.Debug("Warning: idle for "+i+"ms"),this.idletime=s.GetMilliseconds(),this.status=3,this.idletimeouthandle=setTimeout(function(){3==this.status&&(this.status=1,this.cpu.ProgressTime(e),this.MainLoop())}.bind(this),i))}},f.prototype.MainLoop=function(){if(1==this.status){t.Send("execute",0);var e=this.cpu.Step(this.timer.instructionsperloop,this.timer.timercyclesperinstruction),i=this.timer.instructionsperloop-e;i++,this.ips+=i,this.uartdev0&&this.uartdev0.Step(),this.uartdev1&&this.uartdev1.Step();var s=!!e;this.timer.Update(i,this.cpu.GetTicks(),s),s&&this.HandleHalt()}},i.exports=f}()}),define("cjs!jor1k/worker/worker",["require","exports","module","cjs!./messagehandler","cjs!./system"],function(e,t,i){var s;s=e("cjs!./messagehandler"),new(e("cjs!./system")),s.Send("WorkerReady",0)}),require.config({baseUrl:".",paths:{text:"bower_modules/requirejs-text/text",cjs:"bower_modules/cjs/cjs","amd-loader":"bower_modules/amd-loader/amd-loader",bootstrap:"bower_modules/bootstrap-sass/assets/javascripts/bootstrap.min",modernizr:"bower_modules/modernizr/modernizr",crossroads:"bower_modules/crossroads/dist/crossroads.min",hasher:"bower_modules/hasher/dist/js/hasher.min",jquery:"bower_modules/jquery/dist/jquery",knockout:"bower_modules/knockout/dist/knockout","knockout-projections":"bower_modules/knockout-projections/dist/knockout-projections",signals:"bower_modules/js-signals/dist/signals.min",marked:"bower_modules/marked/marked.min",videojs:"bower_modules/videojs/dist/video.min","jquery-ui":"bower_modules/jquery-ui/jquery-ui.min","jquery-ui-layout":"bower_modules/jquery-ui-layout/source/stable/jquery.layout_and_plugins.min","jquery-fullscreen":"bower_modules/jquery-fullscreen/jquery.fullscreen-min","jquery-notific8":"bower_modules/jquery-notific8/dist/jquery.notific8.min",ace:"bower_modules/ace/lib/ace","typeahead-jquery":"bower_modules/typeahead.js/dist/typeahead.jquery.min",bloodhound:"bower_modules/typeahead.js/dist/bloodhound.min",FileSaver:"bower_modules/FileSaver/dist/FileSaver.min",Blob:"bower_modules/Blob/Blob","bootstrap-contextmenu":"bower_modules/bootstrap-contextmenu/bootstrap-contextmenu",bootbox:"bower_modules/bootbox.js/bootbox","github-api":"bower_modules/github-api/github",jszip:"bower_modules/jszip/dist/jszip.min","app/config":"app/config/config.dev","js-base64":"app/github-int/github-base64",xmlhttprequest:"app/github-int/github-xmlhttpreq"},shim:{"github-api":{},bootstrap:{deps:["jquery"]},"jquery-ui":{deps:["jquery"]},"jquery-ui-layout":{deps:["jquery","jquery-ui"]},"jquery-fullscreen":{deps:["jquery"]},"typeahead-jquery":{deps:["jquery"]},bootbox:{deps:["jquery"]},"bootstrap-contextmenu":{deps:["bootstrap"]}},packages:[{name:"jor1k",location:"bower_modules/jor1k/js"}],map:{"jor1k/worker/init_openrisc":{"jor1k/worker/or1k":"jor1k/worker/or1k/index","jor1k/worker/or1k/index":"jor1k/worker/or1k/index"},"jor1k/worker/init_riscv":{"jor1k/worker/riscv":"jor1k/worker/riscv/index","jor1k/worker/riscv/index":"jor1k/worker/riscv/index","jor1k/worker/riscv/htif":"jor1k/worker/riscv/htif"}}}),define("app/require.config",function(){}),require(["cjs!jor1k/worker/worker"]),require.config({bundles:{}});